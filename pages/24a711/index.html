<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>iptables | 故事</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/assets/img/favicon.ico">
    <meta name="description" content="storyxc技术博客">
    <meta name="author" content="故事">
    <meta name="keywords" content="Java,Python,Vue,VuePress,后端开发">
    
    <link rel="preload" href="/assets/css/0.styles.7305967a.css" as="style"><link rel="preload" href="/assets/js/app.c47fcfce.js" as="script"><link rel="preload" href="/assets/js/2.cc49f402.js" as="script"><link rel="preload" href="/assets/js/93.e3df7add.js" as="script"><link rel="prefetch" href="/assets/js/10.45a973be.js"><link rel="prefetch" href="/assets/js/100.3a195718.js"><link rel="prefetch" href="/assets/js/101.f58dd906.js"><link rel="prefetch" href="/assets/js/102.79333e95.js"><link rel="prefetch" href="/assets/js/103.0f62b4ab.js"><link rel="prefetch" href="/assets/js/104.6e8d37bd.js"><link rel="prefetch" href="/assets/js/105.a1e8b81b.js"><link rel="prefetch" href="/assets/js/106.bcd2f7e6.js"><link rel="prefetch" href="/assets/js/107.237d6b81.js"><link rel="prefetch" href="/assets/js/108.50074a33.js"><link rel="prefetch" href="/assets/js/109.b2175bfd.js"><link rel="prefetch" href="/assets/js/11.c466625e.js"><link rel="prefetch" href="/assets/js/110.1102d96f.js"><link rel="prefetch" href="/assets/js/111.b09a52f9.js"><link rel="prefetch" href="/assets/js/112.fc34b364.js"><link rel="prefetch" href="/assets/js/113.8a404940.js"><link rel="prefetch" href="/assets/js/114.8e22beb8.js"><link rel="prefetch" href="/assets/js/115.2ec6e666.js"><link rel="prefetch" href="/assets/js/116.ee67c3e8.js"><link rel="prefetch" href="/assets/js/117.5dca24c1.js"><link rel="prefetch" href="/assets/js/118.5eaa5141.js"><link rel="prefetch" href="/assets/js/119.e4898219.js"><link rel="prefetch" href="/assets/js/12.fdf3dfd3.js"><link rel="prefetch" href="/assets/js/120.effaa00f.js"><link rel="prefetch" href="/assets/js/121.e7cde224.js"><link rel="prefetch" href="/assets/js/122.fe9cf914.js"><link rel="prefetch" href="/assets/js/123.c1bf0b20.js"><link rel="prefetch" href="/assets/js/124.2f78298d.js"><link rel="prefetch" href="/assets/js/125.48438044.js"><link rel="prefetch" href="/assets/js/126.37c76b41.js"><link rel="prefetch" href="/assets/js/127.00640afe.js"><link rel="prefetch" href="/assets/js/128.3087338f.js"><link rel="prefetch" href="/assets/js/129.c2f52775.js"><link rel="prefetch" href="/assets/js/13.e2eb4cfb.js"><link rel="prefetch" href="/assets/js/130.66c62e3d.js"><link rel="prefetch" href="/assets/js/131.93664c3c.js"><link rel="prefetch" href="/assets/js/132.03cd8ce8.js"><link rel="prefetch" href="/assets/js/133.83027971.js"><link rel="prefetch" href="/assets/js/134.de834ec3.js"><link rel="prefetch" href="/assets/js/135.7c7ed304.js"><link rel="prefetch" href="/assets/js/136.f8d91b21.js"><link rel="prefetch" href="/assets/js/137.ad4a02c2.js"><link rel="prefetch" href="/assets/js/138.66140915.js"><link rel="prefetch" href="/assets/js/139.8c2c907b.js"><link rel="prefetch" href="/assets/js/14.e4b9a9a5.js"><link rel="prefetch" href="/assets/js/140.8d953da8.js"><link rel="prefetch" href="/assets/js/141.0c966ee8.js"><link rel="prefetch" href="/assets/js/142.0b35b751.js"><link rel="prefetch" href="/assets/js/143.0adc53c7.js"><link rel="prefetch" href="/assets/js/144.1bce0137.js"><link rel="prefetch" href="/assets/js/145.86ae31d7.js"><link rel="prefetch" href="/assets/js/146.ec78d6e3.js"><link rel="prefetch" href="/assets/js/147.d25532f0.js"><link rel="prefetch" href="/assets/js/148.2bb24424.js"><link rel="prefetch" href="/assets/js/149.aad6ae94.js"><link rel="prefetch" href="/assets/js/15.c3affd84.js"><link rel="prefetch" href="/assets/js/150.8ea69e87.js"><link rel="prefetch" href="/assets/js/151.d8e6b7f9.js"><link rel="prefetch" href="/assets/js/152.3e8c91c7.js"><link rel="prefetch" href="/assets/js/153.13ac29d2.js"><link rel="prefetch" href="/assets/js/154.d0eae672.js"><link rel="prefetch" href="/assets/js/16.11e85a96.js"><link rel="prefetch" href="/assets/js/17.d45d76bb.js"><link rel="prefetch" href="/assets/js/18.55ea0a65.js"><link rel="prefetch" href="/assets/js/19.598a5e5b.js"><link rel="prefetch" href="/assets/js/20.450edde7.js"><link rel="prefetch" href="/assets/js/21.093f7e5a.js"><link rel="prefetch" href="/assets/js/22.0350d53c.js"><link rel="prefetch" href="/assets/js/23.f3ec4f98.js"><link rel="prefetch" href="/assets/js/24.25a34052.js"><link rel="prefetch" href="/assets/js/25.2d8bcf3d.js"><link rel="prefetch" href="/assets/js/26.5ba3187a.js"><link rel="prefetch" href="/assets/js/27.121a9bc2.js"><link rel="prefetch" href="/assets/js/28.4b3c98e0.js"><link rel="prefetch" href="/assets/js/29.4368ea43.js"><link rel="prefetch" href="/assets/js/3.a9535587.js"><link rel="prefetch" href="/assets/js/30.0dcb7545.js"><link rel="prefetch" href="/assets/js/31.f7dc84a8.js"><link rel="prefetch" href="/assets/js/32.b304bd99.js"><link rel="prefetch" href="/assets/js/33.51d7547c.js"><link rel="prefetch" href="/assets/js/34.a5310e98.js"><link rel="prefetch" href="/assets/js/35.3c8bb0c5.js"><link rel="prefetch" href="/assets/js/36.d524eeac.js"><link rel="prefetch" href="/assets/js/37.23d20766.js"><link rel="prefetch" href="/assets/js/38.d5554c60.js"><link rel="prefetch" href="/assets/js/39.df587475.js"><link rel="prefetch" href="/assets/js/4.e5ac8b52.js"><link rel="prefetch" href="/assets/js/40.69a76110.js"><link rel="prefetch" href="/assets/js/41.78c3e1f0.js"><link rel="prefetch" href="/assets/js/42.3d5ca0af.js"><link rel="prefetch" href="/assets/js/43.ae4acf08.js"><link rel="prefetch" href="/assets/js/44.e0457a69.js"><link rel="prefetch" href="/assets/js/45.552c5065.js"><link rel="prefetch" href="/assets/js/46.c08b63e5.js"><link rel="prefetch" href="/assets/js/47.ff56dcef.js"><link rel="prefetch" href="/assets/js/48.a993687d.js"><link rel="prefetch" href="/assets/js/49.5e4603e5.js"><link rel="prefetch" href="/assets/js/5.76817ced.js"><link rel="prefetch" href="/assets/js/50.fb5468a2.js"><link rel="prefetch" href="/assets/js/51.8393e93e.js"><link rel="prefetch" href="/assets/js/52.f96bab63.js"><link rel="prefetch" href="/assets/js/53.536b0a31.js"><link rel="prefetch" href="/assets/js/54.9dab9c2b.js"><link rel="prefetch" href="/assets/js/55.656381c8.js"><link rel="prefetch" href="/assets/js/56.71bf4ace.js"><link rel="prefetch" href="/assets/js/57.dea925cb.js"><link rel="prefetch" href="/assets/js/58.25f305bb.js"><link rel="prefetch" href="/assets/js/59.d23d39c5.js"><link rel="prefetch" href="/assets/js/6.68a33249.js"><link rel="prefetch" href="/assets/js/60.606d9a9e.js"><link rel="prefetch" href="/assets/js/61.e42023eb.js"><link rel="prefetch" href="/assets/js/62.bf67e79d.js"><link rel="prefetch" href="/assets/js/63.2285e732.js"><link rel="prefetch" href="/assets/js/64.eb7c7b88.js"><link rel="prefetch" href="/assets/js/65.8ca97324.js"><link rel="prefetch" href="/assets/js/66.44fbb9b7.js"><link rel="prefetch" href="/assets/js/67.a9d2b5ca.js"><link rel="prefetch" href="/assets/js/68.7478cb55.js"><link rel="prefetch" href="/assets/js/69.8d5168c0.js"><link rel="prefetch" href="/assets/js/7.a1461507.js"><link rel="prefetch" href="/assets/js/70.296512da.js"><link rel="prefetch" href="/assets/js/71.aee400cd.js"><link rel="prefetch" href="/assets/js/72.d9ddac0a.js"><link rel="prefetch" href="/assets/js/73.542c0eef.js"><link rel="prefetch" href="/assets/js/74.5951603b.js"><link rel="prefetch" href="/assets/js/75.9df9ad9f.js"><link rel="prefetch" href="/assets/js/76.0248e153.js"><link rel="prefetch" href="/assets/js/77.df49a6ad.js"><link rel="prefetch" href="/assets/js/78.3608b4ee.js"><link rel="prefetch" href="/assets/js/79.607ee415.js"><link rel="prefetch" href="/assets/js/8.1004039c.js"><link rel="prefetch" href="/assets/js/80.57cd5bae.js"><link rel="prefetch" href="/assets/js/81.b219913a.js"><link rel="prefetch" href="/assets/js/82.3286a21d.js"><link rel="prefetch" href="/assets/js/83.a214cd0b.js"><link rel="prefetch" href="/assets/js/84.5620398a.js"><link rel="prefetch" href="/assets/js/85.e1fe7c6a.js"><link rel="prefetch" href="/assets/js/86.50bda24b.js"><link rel="prefetch" href="/assets/js/87.219ce2c8.js"><link rel="prefetch" href="/assets/js/88.de289d56.js"><link rel="prefetch" href="/assets/js/89.7f54b04b.js"><link rel="prefetch" href="/assets/js/9.19f21bef.js"><link rel="prefetch" href="/assets/js/90.ac7dea3d.js"><link rel="prefetch" href="/assets/js/91.966ef8a0.js"><link rel="prefetch" href="/assets/js/92.8e7e0320.js"><link rel="prefetch" href="/assets/js/94.23529696.js"><link rel="prefetch" href="/assets/js/95.ab425a02.js"><link rel="prefetch" href="/assets/js/96.34c4f085.js"><link rel="prefetch" href="/assets/js/97.6202ba1b.js"><link rel="prefetch" href="/assets/js/98.0bf0a2a2.js"><link rel="prefetch" href="/assets/js/99.d6c6b560.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7305967a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">故事</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/8c2319/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="模块" class="dropdown-title"><!----> <span class="title" style="display:;">模块</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/bf6a41/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/ecb94e/" class="nav-link">Python</a></li><li class="dropdown-item"><!----> <a href="/pages/c851b2/" class="nav-link">Golang</a></li><li class="dropdown-item"><!----> <a href="/pages/eeefb8/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/pages/416f59/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/5111ec/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/20fb9d/" class="nav-link">实践</a></li><li class="dropdown-item"><!----> <a href="/pages/de595b/" class="nav-link">折腾</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="归档" class="dropdown-title"><!----> <span class="title" style="display:;">归档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/storyxc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/8c2319/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="模块" class="dropdown-title"><!----> <span class="title" style="display:;">模块</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/bf6a41/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/ecb94e/" class="nav-link">Python</a></li><li class="dropdown-item"><!----> <a href="/pages/c851b2/" class="nav-link">Golang</a></li><li class="dropdown-item"><!----> <a href="/pages/eeefb8/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/pages/416f59/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/5111ec/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/20fb9d/" class="nav-link">实践</a></li><li class="dropdown-item"><!----> <a href="/pages/de595b/" class="nav-link">折腾</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="归档" class="dropdown-title"><!----> <span class="title" style="display:;">归档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/storyxc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>服务器环境</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bb66f7/" class="sidebar-link">Centos7安装Python3环境</a></li><li><a href="/pages/63edcf/" class="sidebar-link">从零搭建Linux虚拟机环境</a></li><li><a href="/pages/28ca93/" class="sidebar-link">bash常用的快捷键</a></li><li><a href="/pages/614bb2/" class="sidebar-link">阿里云服务器挂载阿里云盘</a></li><li><a href="/pages/171f94/" class="sidebar-link">centos7防火墙命令</a></li><li><a href="/pages/974867/" class="sidebar-link">阿里云服务器启用密钥登录并禁用密码登录</a></li><li><a href="/pages/ac0219/" class="sidebar-link">Linux服务器文件目录共享映射配置</a></li><li><a href="/pages/ce3161/" class="sidebar-link">腾讯云服务器存在对外攻击行为的处理</a></li><li><a href="/pages/55b76f/" class="sidebar-link">Linux设置swap空间</a></li><li><a href="/pages/ac7e1e/" class="sidebar-link">链接和别名（ln、alias)</a></li><li><a href="/pages/8ac264/" class="sidebar-link">nginx配置</a></li><li><a href="/pages/8ff8c2/" class="sidebar-link">Linux访问权限控制之ACL</a></li><li><a href="/pages/0717f2/" class="sidebar-link">Linux私钥登陆提示server refused our key</a></li><li><a href="/pages/09244f/" class="sidebar-link">Ubuntu-server</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>应用相关</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/0750d6/" class="sidebar-link">canal部署</a></li><li><a href="/pages/5ca7f1/" class="sidebar-link">Linux中使用selenium</a></li><li><a href="/pages/6e83fa/" class="sidebar-link">screen的进阶用法</a></li><li><a href="/pages/24a711/" aria-current="page" class="active sidebar-link">iptables</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/24a711/#表和链" class="sidebar-link">表和链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/24a711/#raw" class="sidebar-link">Raw</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#mangle" class="sidebar-link">Mangle</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#nat" class="sidebar-link">NAT</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#filter" class="sidebar-link">Filter</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#security" class="sidebar-link">Security</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/24a711/#iptables数据包处理流程图" class="sidebar-link">iptables数据包处理流程图</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#iptables语法" class="sidebar-link">iptables语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/24a711/#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#常见的命令选项" class="sidebar-link">常见的命令选项</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#常见策略-target" class="sidebar-link">常见策略（target）</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#添加规则" class="sidebar-link">添加规则</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#查看规则" class="sidebar-link">查看规则</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#删除规则" class="sidebar-link">删除规则</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#给指定的链设置默认策略" class="sidebar-link">给指定的链设置默认策略</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#通用匹配" class="sidebar-link">通用匹配</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#隐含匹配" class="sidebar-link">隐含匹配</a></li><li class="sidebar-sub-header"><a href="/pages/24a711/#显式匹配" class="sidebar-link">显式匹配</a></li></ul></li></ul></li><li><a href="/pages/36f5b6/" class="sidebar-link">FFmpeg相关</a></li><li><a href="/pages/23c8f3/" class="sidebar-link">Grafana</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>硬件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/b668e1/" class="sidebar-link">linux磁盘操作相关</a></li></ul></section></li><li><a href="/pages/eeefb8/" class="sidebar-link">简介</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/categories/?category=linux" title="分类" data-v-1cd794fe>linux</a></li> <li data-v-1cd794fe><a href="/categories/?category=%E5%BA%94%E7%94%A8%E7%9B%B8%E5%85%B3" title="分类" data-v-1cd794fe>应用相关</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/storyxc" target="_blank" title="作者" class="beLink" data-v-1cd794fe>storyxc</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2023-02-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          iptables
        </h1>  <div class="theme-vdoing-content content__default"><h1 id="iptables"><a href="#iptables" class="header-anchor">#</a> iptables</h1> <p>iptables是一个用户级程序，用于操作内核级的网络模块<code>netfilter</code></p> <h2 id="表和链"><a href="#表和链" class="header-anchor">#</a> 表和链</h2> <p>iptables的功能由表的形式呈现，每张表由若干个链组成，每个链可以分配一组规则</p> <p>iptables有五张内建表，按照优先级高到底分别是：Raw、Mangle、NAT、Filter、Security</p> <h3 id="raw"><a href="#raw" class="header-anchor">#</a> Raw</h3> <p>此表负责数据包标记，决定数据包是否被状态跟踪机制处理，Raw表有2个内建链</p> <ul><li>PREROUTING：用于通过任何网络接口到达的数据包</li> <li>OUTPUT：针对本地进程产生的数据包</li></ul> <h3 id="mangle"><a href="#mangle" class="header-anchor">#</a> Mangle</h3> <p>此表负责更改数据包内容,Mangle表有5个内建链</p> <ul><li>PREROUTING</li> <li>OUTPUT</li> <li>FORWARD</li> <li>INPUT</li> <li>POSTROUTING</li></ul> <h3 id="nat"><a href="#nat" class="header-anchor">#</a> NAT</h3> <p>此表负责数据包的ip地址转换，NAT表有3种内建链</p> <ul><li>PREROUTING：处理刚到达本机并在路由转发前的数据包。它会转换数据包中的目标IP地址（destination ip address），通常用于DNAT(destination NAT)。</li> <li>POSTROUTING：处理即将离开本机的数据包。它会转换数据包中的源IP地址（source ip address），通常用于SNAT（source NAT）。</li> <li>OUTPUT：处理本机产生的数据包。</li></ul> <h3 id="filter"><a href="#filter" class="header-anchor">#</a> Filter</h3> <p>此表负责过滤数据包，iptables的默认表，具有3种内建链</p> <ul><li>INPUT：处理来自外部的数据。</li> <li>OUTPUT：处理向外发送的数据。</li> <li>FORWARD：将数据转发到本机的其他网卡设备上。</li></ul> <h3 id="security"><a href="#security" class="header-anchor">#</a> Security</h3> <p>新加入的特性，用于强制访问控制（MAC）网络规则，有3种内建链</p> <ul><li>INPUT</li> <li>OUTPUT</li> <li>FORWARD</li></ul> <h2 id="iptables数据包处理流程图"><a href="#iptables数据包处理流程图" class="header-anchor">#</a> iptables数据包处理流程图</h2> <p><img src="https://storyxc.com/images/blog/v2-6c9358844d8f440486551d925dfe36b5_1440w.jpg" alt="v2-6c9358844d8f440486551d925dfe36b5_1440w"></p> <h2 id="iptables语法"><a href="#iptables语法" class="header-anchor">#</a> iptables语法</h2> <h3 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h3> <p><code>iptables [-t 表名] 命令选项 [链名] [匹配条件] [-j 策略]</code></p> <p>iptables命令包含五个部分</p> <ul><li><p>表名：要操作的表，不指定时默认操作Filter表</p></li> <li><p>链名：要操作的链，不指定链时默认表内所有链</p></li> <li><p>命令选项：要进行的操作</p></li> <li><p>匹配条件：定义规则适用哪些数据包（匹配哪些数据包）</p></li> <li><p>策略：匹配数据的目标执行的操作，说白了就是packet匹配上规则后该干嘛</p></li></ul> <h3 id="常见的命令选项"><a href="#常见的命令选项" class="header-anchor">#</a> 常见的命令选项</h3> <ul><li>-A 在指定链的末尾添加（append）一条新的规则</li> <li>-D 删除（delete）指定链中的某一条规则，可以按规则序号和内容删除</li> <li>-I 在指定链中插入（insert）一条新的规则，默认在第一行添加</li> <li>-R 修改、替换（replace）指定链中的某一条规则，可以按规则序号和内容替换</li> <li>-L 列出（list）指定链中所有的规则进行查看</li> <li>-E 重命名用户定义的链，不改变链本身</li> <li>-F 清空（flush）</li> <li>-N 新建（new-chain）一条用户自己定义的规则链</li> <li>-X 删除指定表中用户自定义的规则链（delete-chain）</li> <li>-P 设置指定链的默认策略（policy）</li> <li>-Z 将所有表的所有链的字节和数据包计数器清零</li> <li>-n 使用数字形式（numeric）显示输出结果</li> <li>-v 查看规则表详细信息（verbose）的信息</li> <li>-V 查看版本(version)</li> <li>-h 获取帮助（help）</li></ul> <h3 id="常见策略-target"><a href="#常见策略-target" class="header-anchor">#</a> 常见策略（target）</h3> <ul><li><p>ACCEPT：允许数据包通过。</p></li> <li><p>DROP：直接丢弃数据包，不给任何回应信息，这时候客户端会感觉自己的请求泥牛入海了，过了超时时间才会有反应。</p></li> <li><p>REJECT：拒绝数据包通过，必要时会给数据发送端一个响应的信息，客户端刚请求就会收到拒绝的信息。</p></li> <li><p>SNAT：源地址转换，解决内网用户用同一个公网地址上网的问题。</p></li> <li><p>MASQUERADE：是SNAT的一种特殊形式，适用于动态的、临时会变的ip上。</p></li> <li><p>DNAT：目标地址转换。</p></li> <li><p>REDIRECT：在本机做端口映射。</p></li></ul> <h3 id="添加规则"><a href="#添加规则" class="header-anchor">#</a> 添加规则</h3> <ul><li>-A：在链的末尾追加一条规则，例如<code>iptables -A INPUT -s 127.0.0.1 -p tcp --dport 3306 -j ACCEPT</code></li> <li>-I：在链的开头（或指定序号）插入一条规则，例如<code>iptables -I INPUT -p tcp -j ACCEPT</code>或<code>iptables -I INPUT 2 -p tcp -j ACCEPT</code></li></ul> <h3 id="查看规则"><a href="#查看规则" class="header-anchor">#</a> 查看规则</h3> <ul><li><p>-L：列出所有规则</p></li> <li><p>-n：以数字形式显示地址、端口等信息</p></li> <li><p>-v：显示更详细规则信息</p></li> <li><p>--line-numbers：显示规则序号</p></li></ul> <h3 id="删除规则"><a href="#删除规则" class="header-anchor">#</a> 删除规则</h3> <ul><li><p>删除nat表INPUT链的第三条规则：<code>iptables -t nat -D INPUT 3</code></p></li> <li><p>清空nat表所有规则：<code>iptables -t nat -F</code></p></li></ul> <h3 id="给指定的链设置默认策略"><a href="#给指定的链设置默认策略" class="header-anchor">#</a> 给指定的链设置默认策略</h3> <ul><li><code>iptables -t filter -P FORWARD DROP</code></li></ul> <h3 id="通用匹配"><a href="#通用匹配" class="header-anchor">#</a> 通用匹配</h3> <h4 id="协议匹配-p-protocol"><a href="#协议匹配-p-protocol" class="header-anchor">#</a> 协议匹配 -p（protocol）</h4> <ul><li>指定规则的协议，如tcp, udp, icmp等，可以使用<strong>all</strong>来指定所有协议。</li> <li>如果不指定**-p<strong>参数，则默认是</strong>all**值。这并不明智，请总是明确指定协议名称。</li> <li>可以使用协议名(如tcp)，或者是协议值（比如6代表tcp）来指定协议。映射关系请查看/etc/protocols</li> <li>还可以使用**–protocol<strong>参数代替</strong>-p**参数</li></ul> <h4 id="地址匹配-s-d"><a href="#地址匹配-s-d" class="header-anchor">#</a> 地址匹配 -s -d：</h4> <h5 id="s-源地址"><a href="#s-源地址" class="header-anchor">#</a> -s 源地址</h5> <ul><li>指定数据包的源地址</li> <li>参数可以使IP地址、网络地址、主机名</li> <li>例如：-s 192.168.1.101指定IP地址</li> <li>例如：-s 192.168.1.10/24指定网络地址</li> <li>如果不指定-s参数，就代表所有地址</li> <li>还可以使用**–src<strong>或者</strong>–source**</li></ul> <h5 id="d-目标地址"><a href="#d-目标地址" class="header-anchor">#</a> -d 目标地址</h5> <ul><li>指定目的地址</li> <li>参数和**-s**相同</li> <li>还可以使用**–dst<strong>或者</strong>–destination**</li></ul> <h4 id="接口匹配-i-o"><a href="#接口匹配-i-o" class="header-anchor">#</a> 接口匹配 -i -o</h4> <h5 id="i-输入接口-input-interface"><a href="#i-输入接口-input-interface" class="header-anchor">#</a> -i 输入接口（input interface）</h5> <ul><li><strong>-i</strong>代表输入接口(input interface)</li> <li><strong>-i</strong>指定了要处理来自哪个接口的数据包</li> <li>这些数据包即将进入INPUT, FORWARD, PREROUTE链</li> <li>例如：<strong>-i eth0</strong>指定了要处理经由eth0进入的数据包</li> <li>如果不指定**-i**参数，那么将处理进入所有接口的数据包</li> <li>如果出现**!** -i eth0，那么将处理所有经由<strong>eth0以外的接口</strong>进入的数据包</li> <li>如果出现-i eth**+<strong>，那么将处理所有经由</strong>eth开头的接口**进入的数据包</li> <li>还可以使用**–in-interface**参数</li></ul> <h5 id="o-输出-out-interface"><a href="#o-输出-out-interface" class="header-anchor">#</a> -o 输出（out interface）</h5> <ul><li><strong>-o</strong>代表”output interface”</li> <li><strong>-o</strong>指定了数据包由哪个接口输出</li> <li>这些数据包即将进入FORWARD, OUTPUT, POSTROUTING链</li> <li>如果不指定**-o**选项，那么系统上的所有接口都可以作为输出接口</li> <li>如果出现**!** -o eth0，那么将从<strong>eth0以外的接口</strong>输出</li> <li>如果出现-i eth**+<strong>，那么将仅从</strong>eth开头的接口**输出</li> <li>还可以使用**–out-interface**参数</li></ul> <h3 id="隐含匹配"><a href="#隐含匹配" class="header-anchor">#</a> 隐含匹配</h3> <h4 id="端口匹配"><a href="#端口匹配" class="header-anchor">#</a> 端口匹配</h4> <h5 id="sport-源端口-source-port-针对-p-tcp-或者-p-udp"><a href="#sport-源端口-source-port-针对-p-tcp-或者-p-udp" class="header-anchor">#</a> -–sport 源端口（source port） 针对-p tcp 或者 -p udp</h5> <ul><li>缺省情况下，将匹配所有端口</li> <li>可以指定端口号或者端口名称，例如”–sport 22″与”–sport ssh”。</li> <li>/etc/services文件描述了上述映射关系。</li> <li>从性能上讲，使用端口号更好</li> <li>使用冒号可以匹配端口范围，如”–sport 22:100″</li> <li>还可以使用”–source-port”</li></ul> <h5 id="dport-目的端口-destination-port-针对-p-tcp-或者-p-udp"><a href="#dport-目的端口-destination-port-针对-p-tcp-或者-p-udp" class="header-anchor">#</a> –-dport 目的端口（destination port） 针对-p tcp 或者 -p udp</h5> <ul><li>参数和–sport类似</li> <li>还可以使用”–destination-port”</li></ul> <h5 id="tcp-flags-tcp标志-针对-p-tcp"><a href="#tcp-flags-tcp标志-针对-p-tcp" class="header-anchor">#</a> -–tcp-flags TCP标志 针对-p tcp</h5> <ul><li>可以指定由逗号分隔的多个参数</li> <li>有效值可以是：SYN, ACK, FIN, RST, URG, PSH</li> <li>可以使用<strong>ALL</strong>或者<strong>NONE</strong></li></ul> <h5 id="icmp-type-icmp类型-针对-p-icmp"><a href="#icmp-type-icmp类型-针对-p-icmp" class="header-anchor">#</a> -–icmp-type ICMP类型 针对-p icmp</h5> <ul><li>–icmp-type 0 表示Echo Reply</li> <li>–icmp-type 8 表示Echo</li></ul> <h3 id="显式匹配"><a href="#显式匹配" class="header-anchor">#</a> 显式匹配</h3> <p>多端口匹配 -m multiport --sport 源端口列表 -m multiport --dport 目的端口列表
IP范围匹配 -m iprange --src-range IP范围
MAC地址匹配 -m mac –mac1-source MAC地址
状态匹配 -m state --state 连接状态</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>iptables -A INPUT -p tcp -m multiport --dport <span class="token number">25,80</span>,110,143 -j ACCEPT
iptables -A FORWARD -p tcp -m iprange --src-range <span class="token number">192.168</span>.4.21-192.168.4.28 -j ACCEPT
iptables -A INPUT -m mac --mac-source 00:0c:29:c0:55:3f -j DROP
iptables -P INPUT DROP
iptables -I INPUT -p tcp -m multiport --dport <span class="token number">80</span>-82,85 -j ACCEPT
iptables -I INPUT -p tcp -m state --state NEW,ESTABLISHED,RELATED -j ACCEPT
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/storyxc/edit/main/docs/05.linux/02.应用相关/04.iptables.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=linux" title="标签">#linux</a><a href="/tags/?tag=iptables" title="标签">#iptables</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/07/08, 17:20:28</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/6e83fa/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">screen的进阶用法</div></a> <a href="/pages/36f5b6/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">FFmpeg相关</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/6e83fa/" class="prev">screen的进阶用法</a></span> <span class="next"><a href="/pages/36f5b6/">FFmpeg相关</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://github.com/storyxc" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:storyxc@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span><a href="https://storyxc.com" target="_blank" style="font-weight:bold">story</a> | <a href="http://beian.miit.gov.cn/" target=_blank>豫ICP备19046036号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c47fcfce.js" defer></script><script src="/assets/js/2.cc49f402.js" defer></script><script src="/assets/js/93.e3df7add.js" defer></script>
  </body>
</html>
