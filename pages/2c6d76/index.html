<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>golang基础语法 | 故事</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/assets/img/favicon.ico">
    <meta name="description" content="storyxc技术博客">
    <meta name="author" content="故事">
    <meta name="keywords" content="Java,Python,Vue,VuePress,后端开发">
    
    <link rel="preload" href="/assets/css/0.styles.7305967a.css" as="style"><link rel="preload" href="/assets/js/app.c47fcfce.js" as="script"><link rel="preload" href="/assets/js/2.cc49f402.js" as="script"><link rel="preload" href="/assets/js/71.aee400cd.js" as="script"><link rel="prefetch" href="/assets/js/10.45a973be.js"><link rel="prefetch" href="/assets/js/100.3a195718.js"><link rel="prefetch" href="/assets/js/101.f58dd906.js"><link rel="prefetch" href="/assets/js/102.79333e95.js"><link rel="prefetch" href="/assets/js/103.0f62b4ab.js"><link rel="prefetch" href="/assets/js/104.6e8d37bd.js"><link rel="prefetch" href="/assets/js/105.a1e8b81b.js"><link rel="prefetch" href="/assets/js/106.bcd2f7e6.js"><link rel="prefetch" href="/assets/js/107.237d6b81.js"><link rel="prefetch" href="/assets/js/108.50074a33.js"><link rel="prefetch" href="/assets/js/109.b2175bfd.js"><link rel="prefetch" href="/assets/js/11.c466625e.js"><link rel="prefetch" href="/assets/js/110.1102d96f.js"><link rel="prefetch" href="/assets/js/111.b09a52f9.js"><link rel="prefetch" href="/assets/js/112.fc34b364.js"><link rel="prefetch" href="/assets/js/113.8a404940.js"><link rel="prefetch" href="/assets/js/114.8e22beb8.js"><link rel="prefetch" href="/assets/js/115.2ec6e666.js"><link rel="prefetch" href="/assets/js/116.ee67c3e8.js"><link rel="prefetch" href="/assets/js/117.5dca24c1.js"><link rel="prefetch" href="/assets/js/118.5eaa5141.js"><link rel="prefetch" href="/assets/js/119.e4898219.js"><link rel="prefetch" href="/assets/js/12.fdf3dfd3.js"><link rel="prefetch" href="/assets/js/120.effaa00f.js"><link rel="prefetch" href="/assets/js/121.e7cde224.js"><link rel="prefetch" href="/assets/js/122.fe9cf914.js"><link rel="prefetch" href="/assets/js/123.c1bf0b20.js"><link rel="prefetch" href="/assets/js/124.2f78298d.js"><link rel="prefetch" href="/assets/js/125.48438044.js"><link rel="prefetch" href="/assets/js/126.37c76b41.js"><link rel="prefetch" href="/assets/js/127.00640afe.js"><link rel="prefetch" href="/assets/js/128.3087338f.js"><link rel="prefetch" href="/assets/js/129.c2f52775.js"><link rel="prefetch" href="/assets/js/13.e2eb4cfb.js"><link rel="prefetch" href="/assets/js/130.66c62e3d.js"><link rel="prefetch" href="/assets/js/131.93664c3c.js"><link rel="prefetch" href="/assets/js/132.03cd8ce8.js"><link rel="prefetch" href="/assets/js/133.83027971.js"><link rel="prefetch" href="/assets/js/134.de834ec3.js"><link rel="prefetch" href="/assets/js/135.7c7ed304.js"><link rel="prefetch" href="/assets/js/136.f8d91b21.js"><link rel="prefetch" href="/assets/js/137.ad4a02c2.js"><link rel="prefetch" href="/assets/js/138.66140915.js"><link rel="prefetch" href="/assets/js/139.8c2c907b.js"><link rel="prefetch" href="/assets/js/14.e4b9a9a5.js"><link rel="prefetch" href="/assets/js/140.8d953da8.js"><link rel="prefetch" href="/assets/js/141.0c966ee8.js"><link rel="prefetch" href="/assets/js/142.0b35b751.js"><link rel="prefetch" href="/assets/js/143.0adc53c7.js"><link rel="prefetch" href="/assets/js/144.1bce0137.js"><link rel="prefetch" href="/assets/js/145.86ae31d7.js"><link rel="prefetch" href="/assets/js/146.ec78d6e3.js"><link rel="prefetch" href="/assets/js/147.d25532f0.js"><link rel="prefetch" href="/assets/js/148.2bb24424.js"><link rel="prefetch" href="/assets/js/149.aad6ae94.js"><link rel="prefetch" href="/assets/js/15.c3affd84.js"><link rel="prefetch" href="/assets/js/150.8ea69e87.js"><link rel="prefetch" href="/assets/js/151.d8e6b7f9.js"><link rel="prefetch" href="/assets/js/152.3e8c91c7.js"><link rel="prefetch" href="/assets/js/153.13ac29d2.js"><link rel="prefetch" href="/assets/js/154.d0eae672.js"><link rel="prefetch" href="/assets/js/16.11e85a96.js"><link rel="prefetch" href="/assets/js/17.d45d76bb.js"><link rel="prefetch" href="/assets/js/18.55ea0a65.js"><link rel="prefetch" href="/assets/js/19.598a5e5b.js"><link rel="prefetch" href="/assets/js/20.450edde7.js"><link rel="prefetch" href="/assets/js/21.093f7e5a.js"><link rel="prefetch" href="/assets/js/22.0350d53c.js"><link rel="prefetch" href="/assets/js/23.f3ec4f98.js"><link rel="prefetch" href="/assets/js/24.25a34052.js"><link rel="prefetch" href="/assets/js/25.2d8bcf3d.js"><link rel="prefetch" href="/assets/js/26.5ba3187a.js"><link rel="prefetch" href="/assets/js/27.121a9bc2.js"><link rel="prefetch" href="/assets/js/28.4b3c98e0.js"><link rel="prefetch" href="/assets/js/29.4368ea43.js"><link rel="prefetch" href="/assets/js/3.a9535587.js"><link rel="prefetch" href="/assets/js/30.0dcb7545.js"><link rel="prefetch" href="/assets/js/31.f7dc84a8.js"><link rel="prefetch" href="/assets/js/32.b304bd99.js"><link rel="prefetch" href="/assets/js/33.51d7547c.js"><link rel="prefetch" href="/assets/js/34.a5310e98.js"><link rel="prefetch" href="/assets/js/35.3c8bb0c5.js"><link rel="prefetch" href="/assets/js/36.d524eeac.js"><link rel="prefetch" href="/assets/js/37.23d20766.js"><link rel="prefetch" href="/assets/js/38.d5554c60.js"><link rel="prefetch" href="/assets/js/39.df587475.js"><link rel="prefetch" href="/assets/js/4.e5ac8b52.js"><link rel="prefetch" href="/assets/js/40.69a76110.js"><link rel="prefetch" href="/assets/js/41.78c3e1f0.js"><link rel="prefetch" href="/assets/js/42.3d5ca0af.js"><link rel="prefetch" href="/assets/js/43.ae4acf08.js"><link rel="prefetch" href="/assets/js/44.e0457a69.js"><link rel="prefetch" href="/assets/js/45.552c5065.js"><link rel="prefetch" href="/assets/js/46.c08b63e5.js"><link rel="prefetch" href="/assets/js/47.ff56dcef.js"><link rel="prefetch" href="/assets/js/48.a993687d.js"><link rel="prefetch" href="/assets/js/49.5e4603e5.js"><link rel="prefetch" href="/assets/js/5.76817ced.js"><link rel="prefetch" href="/assets/js/50.fb5468a2.js"><link rel="prefetch" href="/assets/js/51.8393e93e.js"><link rel="prefetch" href="/assets/js/52.f96bab63.js"><link rel="prefetch" href="/assets/js/53.536b0a31.js"><link rel="prefetch" href="/assets/js/54.9dab9c2b.js"><link rel="prefetch" href="/assets/js/55.656381c8.js"><link rel="prefetch" href="/assets/js/56.71bf4ace.js"><link rel="prefetch" href="/assets/js/57.dea925cb.js"><link rel="prefetch" href="/assets/js/58.25f305bb.js"><link rel="prefetch" href="/assets/js/59.d23d39c5.js"><link rel="prefetch" href="/assets/js/6.68a33249.js"><link rel="prefetch" href="/assets/js/60.606d9a9e.js"><link rel="prefetch" href="/assets/js/61.e42023eb.js"><link rel="prefetch" href="/assets/js/62.bf67e79d.js"><link rel="prefetch" href="/assets/js/63.2285e732.js"><link rel="prefetch" href="/assets/js/64.eb7c7b88.js"><link rel="prefetch" href="/assets/js/65.8ca97324.js"><link rel="prefetch" href="/assets/js/66.44fbb9b7.js"><link rel="prefetch" href="/assets/js/67.a9d2b5ca.js"><link rel="prefetch" href="/assets/js/68.7478cb55.js"><link rel="prefetch" href="/assets/js/69.8d5168c0.js"><link rel="prefetch" href="/assets/js/7.a1461507.js"><link rel="prefetch" href="/assets/js/70.296512da.js"><link rel="prefetch" href="/assets/js/72.d9ddac0a.js"><link rel="prefetch" href="/assets/js/73.542c0eef.js"><link rel="prefetch" href="/assets/js/74.5951603b.js"><link rel="prefetch" href="/assets/js/75.9df9ad9f.js"><link rel="prefetch" href="/assets/js/76.0248e153.js"><link rel="prefetch" href="/assets/js/77.df49a6ad.js"><link rel="prefetch" href="/assets/js/78.3608b4ee.js"><link rel="prefetch" href="/assets/js/79.607ee415.js"><link rel="prefetch" href="/assets/js/8.1004039c.js"><link rel="prefetch" href="/assets/js/80.57cd5bae.js"><link rel="prefetch" href="/assets/js/81.b219913a.js"><link rel="prefetch" href="/assets/js/82.3286a21d.js"><link rel="prefetch" href="/assets/js/83.a214cd0b.js"><link rel="prefetch" href="/assets/js/84.5620398a.js"><link rel="prefetch" href="/assets/js/85.e1fe7c6a.js"><link rel="prefetch" href="/assets/js/86.50bda24b.js"><link rel="prefetch" href="/assets/js/87.219ce2c8.js"><link rel="prefetch" href="/assets/js/88.de289d56.js"><link rel="prefetch" href="/assets/js/89.7f54b04b.js"><link rel="prefetch" href="/assets/js/9.19f21bef.js"><link rel="prefetch" href="/assets/js/90.ac7dea3d.js"><link rel="prefetch" href="/assets/js/91.966ef8a0.js"><link rel="prefetch" href="/assets/js/92.8e7e0320.js"><link rel="prefetch" href="/assets/js/93.e3df7add.js"><link rel="prefetch" href="/assets/js/94.23529696.js"><link rel="prefetch" href="/assets/js/95.ab425a02.js"><link rel="prefetch" href="/assets/js/96.34c4f085.js"><link rel="prefetch" href="/assets/js/97.6202ba1b.js"><link rel="prefetch" href="/assets/js/98.0bf0a2a2.js"><link rel="prefetch" href="/assets/js/99.d6c6b560.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7305967a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">故事</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/8c2319/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="模块" class="dropdown-title"><!----> <span class="title" style="display:;">模块</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/bf6a41/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/ecb94e/" class="nav-link">Python</a></li><li class="dropdown-item"><!----> <a href="/pages/c851b2/" class="nav-link">Golang</a></li><li class="dropdown-item"><!----> <a href="/pages/eeefb8/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/pages/416f59/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/5111ec/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/20fb9d/" class="nav-link">实践</a></li><li class="dropdown-item"><!----> <a href="/pages/de595b/" class="nav-link">折腾</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="归档" class="dropdown-title"><!----> <span class="title" style="display:;">归档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/storyxc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/8c2319/" class="nav-link">指南</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="模块" class="dropdown-title"><!----> <span class="title" style="display:;">模块</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/bf6a41/" class="nav-link">Java</a></li><li class="dropdown-item"><!----> <a href="/pages/ecb94e/" class="nav-link">Python</a></li><li class="dropdown-item"><!----> <a href="/pages/c851b2/" class="nav-link">Golang</a></li><li class="dropdown-item"><!----> <a href="/pages/eeefb8/" class="nav-link">Linux</a></li><li class="dropdown-item"><!----> <a href="/pages/416f59/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/pages/5111ec/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/pages/20fb9d/" class="nav-link">实践</a></li><li class="dropdown-item"><!----> <a href="/pages/de595b/" class="nav-link">折腾</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="归档" class="dropdown-title"><!----> <span class="title" style="display:;">归档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/storyxc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Go基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/2c6d76/" aria-current="page" class="active sidebar-link">golang基础语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#第一个go程序" class="sidebar-link">第一个Go程序</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#关键字" class="sidebar-link">关键字</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#变量与常量" class="sidebar-link">变量与常量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#变量" class="sidebar-link">变量</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#常量" class="sidebar-link">常量</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#基本数据类型" class="sidebar-link">基本数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#整型" class="sidebar-link">整型</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#浮点型" class="sidebar-link">浮点型</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#字符" class="sidebar-link">字符</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#字符串" class="sidebar-link">字符串</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#布尔" class="sidebar-link">布尔</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#复数" class="sidebar-link">复数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#fmt格式化输出" class="sidebar-link">fmt格式化输出</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#运算符" class="sidebar-link">运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#算数运算符" class="sidebar-link">算数运算符</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#关系运算符" class="sidebar-link">关系运算符</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#逻辑运算符" class="sidebar-link">逻辑运算符</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#位运算符" class="sidebar-link">位运算符</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#容器类型" class="sidebar-link">容器类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#数组" class="sidebar-link">数组</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#切片slice" class="sidebar-link">切片Slice</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#map" class="sidebar-link">Map</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#流程控制语句" class="sidebar-link">流程控制语句</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#条件语句" class="sidebar-link">条件语句</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#switch-case" class="sidebar-link">switch case</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#循环语句" class="sidebar-link">循环语句</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#defer延迟调用" class="sidebar-link">defer延迟调用</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#go-中-defer-和-return-执行的先后顺序" class="sidebar-link">Go 中 defer 和 return 执行的先后顺序</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#goto无条件跳转" class="sidebar-link">goto无条件跳转</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#指针" class="sidebar-link">指针</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#操作符" class="sidebar-link">操作符</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#如何使用指针" class="sidebar-link">如何使用指针</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#空指针" class="sidebar-link">空指针</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#函数传递指针函数" class="sidebar-link">函数传递指针函数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#指针与切片" class="sidebar-link">指针与切片</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#结构体" class="sidebar-link">结构体</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#声明-2" class="sidebar-link">声明</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#创建命名结构体" class="sidebar-link">创建命名结构体</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#结构体标签" class="sidebar-link">结构体标签</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#创建匿名结构体" class="sidebar-link">创建匿名结构体</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#结构体的零值-zero-value" class="sidebar-link">结构体的零值(Zero Value)</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#访问结构体字段" class="sidebar-link">访问结构体字段</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#指向结构体的指针" class="sidebar-link">指向结构体的指针</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#匿名字段" class="sidebar-link">匿名字段</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#嵌套结构体" class="sidebar-link">嵌套结构体</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#提升字段" class="sidebar-link">提升字段</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#结构体比较" class="sidebar-link">结构体比较</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#给结构体定义方法" class="sidebar-link">给结构体定义方法</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#方法的参数传递方式" class="sidebar-link">方法的参数传递方式</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#函数" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#声明-3" class="sidebar-link">声明</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#可变参数" class="sidebar-link">可变参数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#解序列" class="sidebar-link">解序列</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#函数的返回值" class="sidebar-link">函数的返回值</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#匿名函数" class="sidebar-link">匿名函数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#内部方法与外部方法" class="sidebar-link">内部方法与外部方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#方法" class="sidebar-link">方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#实例绑定" class="sidebar-link">实例绑定</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#指针接收器与值接收器" class="sidebar-link">指针接收器与值接收器</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#在方法中使用值接收器-与-在函数中使用值参数" class="sidebar-link">在方法中使用值接收器 与 在函数中使用值参数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#在非结构体上的方法" class="sidebar-link">在非结构体上的方法</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#接口" class="sidebar-link">接口</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#定义" class="sidebar-link">定义</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#接口实现" class="sidebar-link">接口实现</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#接口实现多态" class="sidebar-link">接口实现多态</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#接口的内部表示" class="sidebar-link">接口的内部表示</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#空接口" class="sidebar-link">空接口</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#类型断言" class="sidebar-link">类型断言</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#类型选择" class="sidebar-link">类型选择</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#实现多个接口" class="sidebar-link">实现多个接口</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#接口的嵌套" class="sidebar-link">接口的嵌套</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#包" class="sidebar-link">包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#创建包" class="sidebar-link">创建包</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#导入包" class="sidebar-link">导入包</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#使用别名" class="sidebar-link">使用别名</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#使用点操作" class="sidebar-link">使用点操作</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#包的初始化" class="sidebar-link">包的初始化</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#包的匿名导入" class="sidebar-link">包的匿名导入</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#协程" class="sidebar-link">协程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#启动一个-go-协程" class="sidebar-link">启动一个 go 协程</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#启动多个-go-协程" class="sidebar-link">启动多个 Go 协程</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#通道" class="sidebar-link">通道</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#通道的声明" class="sidebar-link">通道的声明</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#通道的初始化" class="sidebar-link">通道的初始化</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#使用通道发送和接收数据" class="sidebar-link">使用通道发送和接收数据</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#通道的关闭" class="sidebar-link">通道的关闭</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#通道的容量与长度" class="sidebar-link">通道的容量与长度</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#缓冲通道与无缓冲通道" class="sidebar-link">缓冲通道与无缓冲通道</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#双向通道" class="sidebar-link">双向通道</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#单向通道" class="sidebar-link">单向通道</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#遍历通道" class="sidebar-link">遍历通道</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#用通道做锁" class="sidebar-link">用通道做锁</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#死锁" class="sidebar-link">死锁</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#waitgroup" class="sidebar-link">WaitGroup</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#select" class="sidebar-link">Select</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#select-的应用" class="sidebar-link">select 的应用</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#造成死锁" class="sidebar-link">造成死锁</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#select超时处理" class="sidebar-link">select超时处理</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#读取-写入数据" class="sidebar-link">读取/写入数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#线程同步" class="sidebar-link">线程同步</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#临界区" class="sidebar-link">临界区</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#互斥锁-mutex" class="sidebar-link">互斥锁 Mutex</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#读写锁-rwmutex" class="sidebar-link">读写锁 RWMutex</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#条件变量-sync-cond" class="sidebar-link">条件变量 sync.Cond</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#错误与异常" class="sidebar-link">错误与异常</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#错误" class="sidebar-link">错误</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#异常" class="sidebar-link">异常</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#panic" class="sidebar-link">panic</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#make-和-new" class="sidebar-link">make 和 new</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#new函数" class="sidebar-link">new函数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#make函数" class="sidebar-link">make函数</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#new-和-make-的区别" class="sidebar-link">new 和 make 的区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#反射" class="sidebar-link">反射</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/2c6d76/#reflect-包" class="sidebar-link">reflect 包</a></li><li class="sidebar-sub-header"><a href="/pages/2c6d76/#反射的三大定律" class="sidebar-link">反射的三大定律</a></li></ul></li></ul></li><li><a href="/pages/bd697a/" class="sidebar-link">GoTemplate</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GoWeb</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/561fa8/" class="sidebar-link">Gin</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Cli工具</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/055c41/" class="sidebar-link">Cobra</a></li></ul></section></li><li><a href="/pages/c851b2/" class="sidebar-link">简介</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1cd794fe><div class="articleInfo" data-v-1cd794fe><ul class="breadcrumbs" data-v-1cd794fe><li data-v-1cd794fe><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1cd794fe></a></li> <li data-v-1cd794fe><a href="/categories/?category=go" title="分类" data-v-1cd794fe>go</a></li> <li data-v-1cd794fe><a href="/categories/?category=Go%E5%9F%BA%E7%A1%80" title="分类" data-v-1cd794fe>Go基础</a></li> <!----></ul> <div class="info" data-v-1cd794fe><div title="作者" class="author iconfont icon-touxiang" data-v-1cd794fe><a href="https://github.com/storyxc" target="_blank" title="作者" class="beLink" data-v-1cd794fe>storyxc</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1cd794fe><a href="javascript:;" data-v-1cd794fe>2023-06-25</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">
          golang基础语法
        </h1>  <div class="theme-vdoing-content content__default"><h1 id="golang基础语法"><a href="#golang基础语法" class="header-anchor">#</a> Golang基础语法</h1> <h2 id="第一个go程序"><a href="#第一个go程序" class="header-anchor">#</a> 第一个Go程序</h2> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="关键字"><a href="#关键字" class="header-anchor">#</a> 关键字</h2> <ul><li><code>package</code>：定义当前源码文件所属的包。</li> <li><code>import</code>：导入其他包。</li> <li><code>func</code>：定义函数。</li> <li><code>var</code>：声明变量。</li> <li><code>const</code>：声明常量。</li> <li><code>type</code>：定义类型。</li> <li><code>struct</code>：定义结构体。</li> <li><code>interface</code>：定义接口。</li> <li><code>map</code>：定义映射类型。</li> <li><code>range</code>：用于循环迭代。</li> <li><code>select</code>：用于通道操作。</li> <li><code>defer</code>：延迟执行。</li> <li><code>go</code>：启动一个新的 goroutine。</li> <li><code>chan</code>：定义通道类型。</li> <li><code>default</code>：select 语句中的默认情况。</li> <li><code>fallthrough</code>：在 switch 语句中贯穿到下一个 case。</li> <li><code>if</code>：条件语句。</li> <li><code>else</code>：if 语句中的默认情况。</li> <li><code>switch</code>：多分支条件语句。</li> <li><code>case</code>：switch 语句中的分支情况。</li> <li><code>for</code>：循环语句。</li> <li><code>break</code>：跳出循环或 switch 语句。</li> <li><code>continue</code>：结束当前循环，开始下一次循环。</li> <li><code>return</code>：返回函数结果。</li> <li><code>panic</code>：抛出异常。</li></ul> <h2 id="变量与常量"><a href="#变量与常量" class="header-anchor">#</a> 变量与常量</h2> <h3 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h3> <h4 id="声明变量不赋值"><a href="#声明变量不赋值" class="header-anchor">#</a> 声明变量不赋值</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token builtin">int</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a的类型是%T\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// a = 0</span>
<span class="token comment">// a的类型是int</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>整型、浮点型变量的默认值为0和0.0</li> <li>字符串变量的默认值为空字符串</li> <li>布尔类型变量默认为false</li> <li>切片、函数、指针变量的默认为nil</li></ul> <h4 id="声明变量并初始化"><a href="#声明变量并初始化" class="header-anchor">#</a> 声明变量并初始化</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a =&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a的类型是%T\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>

	<span class="token keyword">var</span> b <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;b =&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;b的类型是%T\n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// a = 10</span>
<span class="token comment">// a的类型是int</span>
<span class="token comment">// b = hello</span>
<span class="token comment">// b的类型是string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="声明变量省略类型"><a href="#声明变量省略类型" class="header-anchor">#</a> 声明变量省略类型</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a =&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a的类型是%T\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>

	<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;b =&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;b的类型是%T\n&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// a = 10</span>
<span class="token comment">// a的类型是int</span>
<span class="token comment">// b = hello</span>
<span class="token comment">// b的类型是string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h4 id="短声明-只能在函数内"><a href="#短声明-只能在函数内" class="header-anchor">#</a> 短声明（只能在函数内）</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	c <span class="token operator">:=</span> <span class="token string">&quot;1&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;c = %s, c的类型是%T\n&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// c = 1, c的类型是string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="多变量声明"><a href="#多变量声明" class="header-anchor">#</a> 多变量声明</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> xx<span class="token punctuation">,</span> yy <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span>
    <span class="token keyword">var</span> kk<span class="token punctuation">,</span> wx <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">,</span> &quot;<span class="token number">666</span>
    <span class="token keyword">var</span> <span class="token punctuation">(</span>
        nn <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">100</span>
        mm <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="匿名变量"><a href="#匿名变量" class="header-anchor">#</a> 匿名变量</h4> <p>匿名变量：下划线<code>_</code>，本身就是一个特殊的标识符。可以像其他标识符那样用于变量的声明，任何类型都可以赋值给它，<strong>但任何赋值给这个标识符的值都将被抛弃</strong>，因此这些值不能在后续的代码中使用。</p> <h4 id="变量交换"><a href="#变量交换" class="header-anchor">#</a> 变量交换</h4> <blockquote><p>和其他静态类型语言不同，可以直接交换变量（python也有这个语法）</p></blockquote> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> <span class="token punctuation">(</span>
		a <span class="token operator">=</span> <span class="token number">100</span>
		b <span class="token operator">=</span> <span class="token number">200</span>
	<span class="token punctuation">)</span>

	a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 200 100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="常量"><a href="#常量" class="header-anchor">#</a> 常量</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 常量(只读属性)</span>
    <span class="token keyword">const</span> length <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token comment">// length = 100  // 常量是不允许被修改的</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;length = &quot;</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="使用常量定义枚举类型"><a href="#使用常量定义枚举类型" class="header-anchor">#</a> 使用常量定义枚举类型</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// const来定义枚举类型</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
    BEIJING <span class="token operator">=</span> <span class="token number">0</span>
    SHANGHAI <span class="token operator">=</span> <span class="token number">1</span>
    SHENZHEN <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;BEIJING = &quot;</span><span class="token punctuation">,</span> BEIJING<span class="token punctuation">)</span>      <span class="token comment">// 0</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;SHANGHAI = &quot;</span><span class="token punctuation">,</span> SHANGHAI<span class="token punctuation">)</span>    <span class="token comment">// 1</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;SHENZHEN = &quot;</span><span class="token punctuation">,</span> SHENZHEN<span class="token punctuation">)</span>    <span class="token comment">// 2</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="iota常量计数器"><a href="#iota常量计数器" class="header-anchor">#</a> iota常量计数器</h4> <p><code>iota</code> 是一个常量生成器，用于生成一组相关的枚举值。<code>iota</code> 可以与 <code>const</code> 关键字一起使用，在定义一组枚举时，用来生成连续的值。const 中每新增一行常量声明将使 iota 计数一次(iota 可理解为 const 语句块中的行索引)</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// iota 初始值为 0，每当出现一个新的常量声明时，它的值就会自动加 1，因此 Monday 的值为 1，Tuesday 的值为 2，以此类推。</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
    Sunday <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">// 0</span>
    Monday        <span class="token comment">// 1</span>
    Tuesday       <span class="token comment">// 2</span>
    Wednesday     <span class="token comment">// 3</span>
    Thursday      <span class="token comment">// 4</span>
    Friday        <span class="token comment">// 5</span>
    Saturday      <span class="token comment">// 6</span>
<span class="token punctuation">)</span>

<span class="token comment">// 在下面的例子中，B 被显式赋值为 3.14，因此接下来的 C 的值为 iota + 1，即 2，而 D 的值也是 iota + 1，所以它的值为 3。</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
    A <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">// 0</span>
    B <span class="token operator">=</span> <span class="token number">3.14</span> <span class="token comment">// 3.14</span>
    C <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token comment">// 2</span>
    D        <span class="token comment">// 3</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// 定义递增的步长</span>
<span class="token keyword">const</span> <span class="token punctuation">(</span>
    BEIJING <span class="token operator">=</span> <span class="token boolean">iota</span> <span class="token operator">*</span> <span class="token number">10</span>
    SHANGHAI
    SHENZHEN
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;BEIJING = &quot;</span><span class="token punctuation">,</span> BEIJING<span class="token punctuation">)</span>      <span class="token comment">// 0</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;SHANGHAI = &quot;</span><span class="token punctuation">,</span> SHANGHAI<span class="token punctuation">)</span>    <span class="token comment">// 10</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;SHENZHEN = &quot;</span><span class="token punctuation">,</span> SHENZHEN<span class="token punctuation">)</span>    <span class="token comment">// 20</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="基本数据类型"><a href="#基本数据类型" class="header-anchor">#</a> 基本数据类型</h2> <h3 id="整型"><a href="#整型" class="header-anchor">#</a> 整型</h3> <ul><li>int8：有符号 8 位整数类型，取值范围为 -128 到 127。</li> <li>uint8（或 byte）：无符号 8 位整数类型，取值范围为 0 到 255。</li> <li>int16：有符号 16 位整数类型，取值范围为 -32768 到 32767。</li> <li>uint16：无符号 16 位整数类型，取值范围为 0 到 65535。</li> <li>int32（或 rune）：有符号 32 位整数类型，取值范围为 -2147483648 到 2147483647。</li> <li>uint32：无符号 32 位整数类型，取值范围为 0 到 4294967295。</li> <li>int64：有符号 64 位整数类型，取值范围为 -9223372036854775808 到 9223372036854775807。</li> <li>uint64：无符号 64 位整数类型，取值范围为 0 到 18446744073709551615。</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;math&quot;</span>
	<span class="token string">&quot;unsafe&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 有符号整型</span>
<span class="token keyword">func</span> <span class="token function">Integer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> num8 <span class="token builtin">int8</span> <span class="token operator">=</span> <span class="token number">127</span>
	<span class="token keyword">var</span> num16 <span class="token builtin">int16</span> <span class="token operator">=</span> <span class="token number">32767</span>
	<span class="token keyword">var</span> num32 <span class="token builtin">int32</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxInt32
	<span class="token keyword">var</span> num64 <span class="token builtin">int64</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxInt64
	<span class="token keyword">var</span> num <span class="token builtin">int</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxInt
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num8的类型是 %T, num8的大小 %d, num8是 %d\n&quot;</span><span class="token punctuation">,</span>
		num8<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num8<span class="token punctuation">)</span><span class="token punctuation">,</span> num8<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num16的类型是 %T, num16的大小 %d, num16是 %d\n&quot;</span><span class="token punctuation">,</span>
		num16<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num16<span class="token punctuation">)</span><span class="token punctuation">,</span> num16<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num32的类型是 %T, num32的大小 %d, num32是 %d\n&quot;</span><span class="token punctuation">,</span>
		num32<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num32<span class="token punctuation">)</span><span class="token punctuation">,</span> num32<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num64的类型是 %T, num64的大小 %d, num64是 %d\n&quot;</span><span class="token punctuation">,</span>
		num64<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num64<span class="token punctuation">)</span><span class="token punctuation">,</span> num64<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num的类型是 %T, num的大小 %d, num是 %d\n&quot;</span><span class="token punctuation">,</span>
		num<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 无符号整型</span>
<span class="token keyword">func</span> <span class="token function">unsignedInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> num8 <span class="token builtin">uint8</span> <span class="token operator">=</span> <span class="token number">128</span>
	<span class="token keyword">var</span> num16 <span class="token builtin">uint16</span> <span class="token operator">=</span> <span class="token number">32768</span>
	<span class="token keyword">var</span> num32 <span class="token builtin">uint32</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxUint32
	<span class="token keyword">var</span> num64 <span class="token builtin">uint64</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxUint64
	<span class="token keyword">var</span> num <span class="token builtin">uint</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxUint
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num8的类型是 %T, num8的大小 %d, num8是 %d\n&quot;</span><span class="token punctuation">,</span>
		num8<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num8<span class="token punctuation">)</span><span class="token punctuation">,</span> num8<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num16的类型是 %T, num16的大小 %d, num16是 %d\n&quot;</span><span class="token punctuation">,</span>
		num16<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num16<span class="token punctuation">)</span><span class="token punctuation">,</span> num16<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num32的类型是 %T, num32的大小 %d, num32是 %d\n&quot;</span><span class="token punctuation">,</span>
		num32<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num32<span class="token punctuation">)</span><span class="token punctuation">,</span> num32<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num64的类型是 %T, num64的大小 %d, num64是 %d\n&quot;</span><span class="token punctuation">,</span>
		num64<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num64<span class="token punctuation">)</span><span class="token punctuation">,</span> num64<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num的类型是 %T, num的大小 %d, num是 %d\n&quot;</span><span class="token punctuation">,</span>
		num<span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">Integer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;---------------------------------------&quot;</span><span class="token punctuation">)</span>
	<span class="token function">unsignedInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <ul><li>除非对整型的大小有特定的需求，否则你通常应该使用 <code>int</code> 表示整型宽度，在 <code>32</code> 位系统下是 <code>32</code> 位，而在 <code>64</code> 位系统下是 <code>64</code> 位。表示范围：在 <code>32</code> 位系统下是 <code>-2147483648</code> ~ <code>2147483647</code> ，而在 <code>64</code> 位系统是 <code>-9223372036854775808</code> ~ <code>9223372036854775807</code> 。</li> <li>对于 <code>int8</code> ， <code>int16</code> 等这些类型后面有跟一个数值的类型来说，它们能表示的数值个数是固定的。所以，在有的时候：例如在二进制传输、读写文件的结构描述(为了保持文件的结构不会受到不同编译目标平台字节长度的影响)等情况下，使用更加精确的 <code>int32</code> 和 <code>int64</code> 是更好的。</li></ul></div> <h3 id="浮点型"><a href="#浮点型" class="header-anchor">#</a> 浮点型</h3> <ul><li><p><code>float32</code> 类型的变量占用 4 个字节的内存，可以表示的数值范围为±1.401298464324817e-45 到±3.4028234663852886e+38，精度约为 7 个十进制位。</p></li> <li><p><code>float64</code> 类型的变量占用 8 个字节的内存， 可以表示的数值范围为±4.9406564584124654e-324 到±1.7976931348623157e+308，精度约为 15 个十进制位。</p></li></ul> <p>Go 语言中的浮点数默认为 <code>float64</code> 类型，如果需要使用 <code>float32</code> 类型，需要显式声明。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;math&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">showFloat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> num1 <span class="token builtin">float32</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxFloat32
	<span class="token keyword">var</span> num2 <span class="token builtin">float64</span> <span class="token operator">=</span> math<span class="token punctuation">.</span>MaxFloat64
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num1的类型是%T,num1是%g\n&quot;</span><span class="token punctuation">,</span> num1<span class="token punctuation">,</span> num1<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;num2的类型是%T,num1是%g\n&quot;</span><span class="token punctuation">,</span> num2<span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">showFloat</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//num1的类型是float32,num1是3.4028235e+38</span>
<span class="token comment">//num2的类型是float64,num1是1.7976931348623157e+308</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="字符"><a href="#字符" class="header-anchor">#</a> 字符</h3> <p>字符串中的每一个元素叫作“字符”，定义字符时使用单引号。Go 语言的字符有两种。</p> <ul><li><code>byte</code>类型，占用1个字节，表示 UTF-8 字符串的单个字节的值，表示的是 ASCII 码表中的一个字符，uint8 的别名类型</li> <li><code>rune</code>类型，占用4个字节，表示单个 unicode 字符，int32 的别名类型</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;unsafe&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">showChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token builtin">byte</span> <span class="token operator">=</span> <span class="token number">65</span>
	<span class="token keyword">var</span> y <span class="token builtin">uint8</span> <span class="token operator">=</span> <span class="token number">65</span>
	z <span class="token operator">:=</span> <span class="token string">'A'</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;x = %c\n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span> <span class="token comment">// x = A</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;y = %c\n&quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment">// y = A</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;z = %c\n&quot;</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token comment">// z = A</span>

<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">sizeOfChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> x <span class="token builtin">byte</span> <span class="token operator">=</span> <span class="token number">65</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;x = %c\n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;x 占用 %d 个字节\n&quot;</span><span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

	<span class="token keyword">var</span> y <span class="token builtin">rune</span> <span class="token operator">=</span> <span class="token string">'A'</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;y = %c\n&quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;y 占用 %d 个字节\n&quot;</span><span class="token punctuation">,</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">showChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token function">sizeOfChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h3> <p>字符串在Go语言中是基本数据类型。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> study <span class="token builtin">string</span>  	 		<span class="token comment">// 定义名为str的字符串类型变量</span>
study <span class="token operator">=</span> <span class="token string">&quot;《123》&quot;</span>		<span class="token comment">// 将变量赋值</span>
study2 <span class="token operator">:=</span> <span class="token string">&quot;《789》&quot;</span>		<span class="token comment">// 以自动推断方式初始化</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>定义多行字符串的方法如下。</p> <ul><li>双引号书写字符串被称为字符串字面量（string literal），这种字面量不能跨行。</li> <li>多行字符串需要使用反引号“`”，多用于内嵌源码和内嵌数据。</li> <li>在反引号中的所有代码不会被编译器识别，而只是作为字符串的一部分。</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> s1 <span class="token builtin">string</span>
	s1 <span class="token operator">=</span> <span class="token string">`
    		study := 'Go语言'
    		fmt.Println(study)
			`</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="布尔"><a href="#布尔" class="header-anchor">#</a> 布尔</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">showBool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	a <span class="token operator">:=</span> <span class="token boolean">true</span>
	b <span class="token operator">:=</span> <span class="token boolean">false</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;a=&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;b=&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;true &amp;&amp; false = &quot;</span><span class="token punctuation">,</span> a <span class="token operator">&amp;&amp;</span> b<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;true || false = &quot;</span><span class="token punctuation">,</span> a <span class="token operator">||</span> b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">showBool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="复数"><a href="#复数" class="header-anchor">#</a> 复数</h3> <table><thead><tr><th>类 型</th> <th>字 节 数</th> <th>说 明</th></tr></thead> <tbody><tr><td>complex64</td> <td>8</td> <td>64 位的复数型，由 float32 类型的实部和虚部联合表示</td></tr> <tr><td>complex128</td> <td>16</td> <td>128 位的复数型，由 float64 类型的实部和虚部联合表示</td></tr></tbody></table> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">showComplex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 内置的 complex 函数用于构建复数</span>
	<span class="token keyword">var</span> x <span class="token builtin">complex64</span> <span class="token operator">=</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> y <span class="token builtin">complex128</span> <span class="token operator">=</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> z <span class="token builtin">complex128</span> <span class="token operator">=</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;x = &quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;y = &quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;z = &quot;</span><span class="token punctuation">,</span> z<span class="token punctuation">)</span>

	<span class="token comment">// 内建的 real 和 imag 函数分别返回复数的实部和虚部</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;real(x) = &quot;</span><span class="token punctuation">,</span> <span class="token function">real</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;imag(x) = &quot;</span><span class="token punctuation">,</span> <span class="token function">imag</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;y * z = &quot;</span><span class="token punctuation">,</span> y<span class="token operator">*</span>z<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">showComplex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>同样可以用自然方式表示复数</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>x <span class="token operator">:=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2i</span>
y <span class="token operator">:=</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">4i</span>
z <span class="token operator">:=</span> <span class="token number">5</span> <span class="token operator">+</span> <span class="token number">6i</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <h3 id="fmt格式化输出"><a href="#fmt格式化输出" class="header-anchor">#</a> fmt格式化输出</h3> <table><thead><tr><th><strong>格式</strong></th> <th><strong>含义</strong></th></tr></thead> <tbody><tr><td>%%</td> <td>一个%字面量</td></tr> <tr><td>%b</td> <td>一个二进制整数值(基数为 2)，或者是一个(高级的)用科学计数法表示的指数为 2 的浮点数</td></tr> <tr><td>%c</td> <td>字符型。可以把输入的数字按照 ASCII 码相应转换为对应的字符</td></tr> <tr><td>%d</td> <td>一个十进制数值(基数为 10)</td></tr> <tr><td>%f</td> <td>以标准记数法表示的浮点数或者复数值</td></tr> <tr><td>%o</td> <td>一个以八进制表示的数字(基数为 8)</td></tr> <tr><td>%p</td> <td>以十六进制(基数为 16)表示的一个值的地址，前缀为 0x,字母使用小写的 a-f 表示</td></tr> <tr><td>%q</td> <td>使用 Go 语法以及必须时使用转义，以双引号括起来的字符串或者字节切片[]byte，或者是以单引号括起来的数字</td></tr> <tr><td>%s</td> <td>字符串。输出字符串中的字符直至字符串中的空字符（字符串以’\0‘结尾，这个’\0’即空字符）</td></tr> <tr><td>%t</td> <td>以 true 或者 false 输出的布尔值</td></tr> <tr><td>%T</td> <td>使用 Go 语法输出的值的类型</td></tr> <tr><td>%x</td> <td>以十六进制表示的整型值(基数为十六)，数字 a-f 使用小写表示</td></tr> <tr><td>%X</td> <td>以十六进制表示的整型值(基数为十六)，数字 A-F 使用小写表示</td></tr></tbody></table> <p>`&gt;</p> <h2 id="运算符"><a href="#运算符" class="header-anchor">#</a> 运算符</h2> <h3 id="算数运算符"><a href="#算数运算符" class="header-anchor">#</a> 算数运算符</h3> <p><code>+</code>、<code>-</code>、<code>*</code>、<code>/</code>、<code>%</code>、<code>++</code>、<code>--</code></p> <h3 id="关系运算符"><a href="#关系运算符" class="header-anchor">#</a> 关系运算符</h3> <p><code>==</code>、<code>!=</code>、<code>&gt;</code>、<code>&lt;</code>、<code>&gt;=</code>、<code>&lt;=</code></p> <h3 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">#</a> 逻辑运算符</h3> <p><code>&amp;&amp;</code>、<code>||</code>、<code>!</code></p> <h3 id="位运算符"><a href="#位运算符" class="header-anchor">#</a> 位运算符</h3> <p><code>&amp;</code>、<code>|</code>、<code>^</code>、<code>&lt;&lt;</code>、<code>&gt;&gt;</code></p> <h2 id="容器类型"><a href="#容器类型" class="header-anchor">#</a> 容器类型</h2> <h3 id="数组"><a href="#数组" class="header-anchor">#</a> 数组</h3> <p>Go 中的数组是值类型而不是引用类型。当数组赋值给一个新的变量时，该变量会得到一个原始数组的一个副本。如果对新变量进行更改，不会影响原始数组。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">arrByValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">}</span>
	<span class="token builtin">copy</span> <span class="token operator">:=</span> arr
	<span class="token builtin">copy</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Golang&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token builtin">copy</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="声明"><a href="#声明" class="header-anchor">#</a> 声明</h4> <p><code>var variable_name [SIZE]variable_type</code></p> <h4 id="初始化"><a href="#初始化" class="header-anchor">#</a> 初始化</h4> <ul><li><code>var balance = [5]float32{1000.0, 2.0, 3.4, 7.0, 50.0}</code></li> <li><code>balance := [5]float32{1000.0, 2.0, 3.4, 7.0, 50.0}</code></li></ul> <p>如果数组长度不确定，可以使用 <strong>...</strong> 代替数组的长度，编译器会根据元素个数自行推断数组的长度：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> balance <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">float32</span><span class="token punctuation">{</span><span class="token number">1000.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">,</span> <span class="token number">7.0</span><span class="token punctuation">,</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
或
balance <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">float32</span><span class="token punctuation">{</span><span class="token number">1000.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">,</span> <span class="token number">7.0</span><span class="token punctuation">,</span> <span class="token number">50.0</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果设置了数组的长度，我们还可以通过指定下标来初始化元素：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//  将索引为 1 和 3 的元素初始化</span>
balance <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">float32</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2.0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">7.0</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>初始化数组中 <strong>{}</strong> 中的元素个数不能大于 <strong>[]</strong> 中的数字。</p> <p>如果忽略 <strong>[]</strong> 中的数字不设置数组大小，Go 语言会根据元素的个数来设置数组的大小：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code> balance<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">50.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="访问"><a href="#访问" class="header-anchor">#</a> 访问</h4> <p>数组元素可以通过索引（位置）来读取。格式为数组名后加中括号，中括号中为索引的值。例如：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> salary <span class="token builtin">float32</span> <span class="token operator">=</span> balance<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="数组长度"><a href="#数组长度" class="header-anchor">#</a> 数组长度</h4> <p><code>len(arr)</code></p> <h4 id="数组遍历"><a href="#数组遍历" class="header-anchor">#</a> 数组遍历</h4> <p>使用<code>for range循环</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">showArr</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> arr <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;arr[%d]=%s\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> arr <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;value=%s\n&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="切片slice"><a href="#切片slice" class="header-anchor">#</a> 切片Slice</h3> <p>Go 语言切片是对数组的抽象。</p> <p>Go 数组的长度不可改变，在特定场景中这样的集合就不太适用，Go 中提供了一种灵活，功能强悍的内置类型切片(&quot;动态数组&quot;)，与数组相比切片的长度是不固定的，可以追加元素，在追加时可能使切片的容量增大。</p> <h4 id="定义切片"><a href="#定义切片" class="header-anchor">#</a> 定义切片</h4> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> identifier <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">type</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>切片不需要说明长度。</p> <p>或使用 <strong>make()</strong> 函数来创建切片:</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> slice1 <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">type</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">)</span>

也可以简写为

slice1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">type</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>也可以指定容量，其中 <strong>capacity</strong> 为可选参数。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>T<span class="token punctuation">,</span> length<span class="token punctuation">,</span> capacity<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里 len 是数组的长度并且也是切片的初始长度。</p> <h4 id="切片初始化"><a href="#切片初始化" class="header-anchor">#</a> 切片初始化</h4> <p>直接初始化切片，<strong>[]</strong> 表示是切片类型，<strong>{1,2,3}</strong> 初始化值依次是 <strong>1,2,3</strong>，其 <strong>cap=len=3</strong>。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token builtin">int</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>初始化切片 <strong>s</strong>，是数组 arr 的引用。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span> arr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将 arr 中从下标 startIndex 到 endIndex-1 下的元素创建为一个新的切片。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span> arr<span class="token punctuation">[</span>startIndex<span class="token punctuation">:</span>endIndex<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>默认 endIndex 时将表示一直到arr的最后一个元素。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span> arr<span class="token punctuation">[</span>startIndex<span class="token punctuation">:</span><span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>默认 startIndex 时将表示从 arr 的第一个元素开始。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span> arr<span class="token punctuation">[</span><span class="token punctuation">:</span>endIndex<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过切片 s 初始化切片 s1。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s1 <span class="token operator">:=</span> s<span class="token punctuation">[</span>startIndex<span class="token punctuation">:</span>endIndex<span class="token punctuation">]</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过内置函数 <strong>make()</strong> 初始化切片<strong>s</strong>，<strong>[]int</strong> 标识为其元素类型为 int 的切片。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">,</span><span class="token builtin">cap</span><span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p><code>make([]T, length, capacity)</code> 用于创建一个指定类型 <code>T</code>、长度为 <code>length</code>、容量为 <code>capacity</code> 的切片。其中，<code>length</code> 表示切片的实际长度，而 <code>capacity</code> 则表示切片底层数组的容量。</p> <p>切片的容量可以理解为底层数组能够容纳的元素数量。当切片的容量不足以容纳新添加的元素时，Go 会自动将底层数组扩展一倍，并将原有的元素复制到新的数组中。因此，在预先分配足够容量的情况下，可以避免频繁的内存分配和数据复制操作，提高代码的性能。</p> <p>需要注意的是，<code>capacity</code> 参数不能小于 <code>length</code> 参数。如果 <code>capacity</code> 小于 <code>length</code>，则会抛出一个运行时异常。</p></blockquote> <ul><li>由于 slice 是引用类型，所以你不对它进行赋值的话，它的默认值是 <code>nil</code></li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> numList <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>numList <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>切片之间不能比较，因此我们不能使用 <code>==</code> 操作符来判断两个 slice 是否含有全部相等元素。特别注意，如果你需要测试一个 slice 是否是空的，使用 <code>len(s) == 0</code> 来判断，而不应该用 <code>s == nil</code> 来判断。</li></ul> <h4 id="切片的长度和容量"><a href="#切片的长度和容量" class="header-anchor">#</a> 切片的长度和容量</h4> <p>一个 slice 由三个部分构成：<strong>指针</strong> 、 <strong>长度</strong> 和 <strong>容量</strong> 。指针指向第一个 slice 元素对应的底层数组元素的地址，要注意的是 slice 的第一个元素并不一定就是数组的第一个元素。长度对应 slice 中元素的数目；长度不能超过容量，容量一般是从 slice 的开始位置到底层数据的结尾位置。简单的讲，容量就是从创建切片索引开始的底层数组中的元素个数，而长度是切片中的元素个数。</p> <p>内置的 <code>len</code> 和 <code>cap</code> 函数分别返回 slice 的长度和容量。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 3</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="切片元素修改"><a href="#切片元素修改" class="header-anchor">#</a> 切片元素修改</h4> <p>切片自己不拥有任何数据。它只是底层数组的一种表示。对切片所做的任何修改都会反映在底层数组中。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">modifySlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">}</span>
	s <span class="token operator">:=</span> arr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">//[0:len(arr)]</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> 
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

	s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Go语言&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> 
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> 
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这里的 <code>arr[:]</code> 没有填入起始值和结束值，默认就是 <code>0</code> 和 <code>len(arr)</code> 。</p> <h4 id="追加切片元素"><a href="#追加切片元素" class="header-anchor">#</a> 追加切片元素</h4> <p>使用 <code>append</code> 可以将新元素追加到切片上。<code>append</code> 函数的定义是 <code>func append(slice []Type, elems ...Type) []Type</code> 。其中 <code>elems ...Type</code> 在函数定义中表示该函数接受参数 <code>elems</code> 的个数是可变的。这些类型的函数被称为可变参数。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">appendSliceData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	s <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>

	s <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&quot;567&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>

	s <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>

	s <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">}</span><span class="token operator">...</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">cap</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>当新的元素被添加到切片时，如果容量不足，会创建一个新的数组。现有数组的元素被复制到这个新数组中，并返回新的引用。现在新切片的容量是旧切片的两倍。</p> <h4 id="多维切片"><a href="#多维切片" class="header-anchor">#</a> 多维切片</h4> <p>类似于数组，切片也可以有多个维度。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">mSlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	numList <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token punctuation">{</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token punctuation">{</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>numList<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="map"><a href="#map" class="header-anchor">#</a> Map</h3> <p>在 Go 语言中，map 是散列表(哈希表)的引用。它是一个拥有键值对元素的<strong>无序集合</strong>，在这个集合中，键是唯一的，可以通过键来获取、更新或移除操作。无论这个散列表有多大，这些操作基本上是通过常量时间完成的。所有可比较的类型，如 <code>整型</code> ，<code>字符串</code> 等，都可以作为 <code>key</code> 。</p> <h4 id="创建map"><a href="#创建map" class="header-anchor">#</a> 创建Map</h4> <p>使用 <code>make</code> 函数传入键和值的类型，可以创建 map 。具体语法为 <code>make(map[KeyType]ValueType)</code> 。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 创建一个键类型为 string 值类型为 int 名为 scores 的 map</span>
scores <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
steps <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>字面量创建：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> steps2 <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;第一步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;第二步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;第三步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>steps2<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code>steps3 <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;第一步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;第二步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;第三步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>steps3<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="map操作"><a href="#map操作" class="header-anchor">#</a> Map操作</h4> <ul><li><p>添加元素</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 可以使用 `map[key] = value` 向 map 添加元素。</span>
steps3<span class="token punctuation">[</span><span class="token string">&quot;第四步&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;总监&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>更新元素</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 若 key 已存在，使用 map[key] = value 可以直接更新对应 key 的 value 值。</span>
steps3<span class="token punctuation">[</span><span class="token string">&quot;第四步&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;CTO&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>获取元素</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 直接使用 map[key] 即可获取对应 key 的 value 值,如果 key不存在,会返回其 value 类型的零值。</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>steps3<span class="token punctuation">[</span><span class="token string">&quot;第四步&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>删除元素</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">//使用 delete(map, key)可以删除 map 中的对应 key 键值对,如果 key 不存在,delete 函数会静默处理，不会报错。</span>
<span class="token function">delete</span><span class="token punctuation">(</span>steps3<span class="token punctuation">,</span> <span class="token string">&quot;第四步&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>判断 key 是否存在</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 如果我们想知道 map 中的某个 key 是否存在，可以使用下面的语法：value, ok := map[key]</span>
v3<span class="token punctuation">,</span> ok <span class="token operator">:=</span> steps3<span class="token punctuation">[</span><span class="token string">&quot;第三步&quot;</span><span class="token punctuation">]</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>ok<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v3<span class="token punctuation">)</span>

v4<span class="token punctuation">,</span> ok <span class="token operator">:=</span> steps3<span class="token punctuation">[</span><span class="token string">&quot;第四步&quot;</span><span class="token punctuation">]</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>ok<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v4<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这个语句说明 <code>map</code> 的下标读取可以返回两个值，第一个值为当前 <code>key</code> 的 <code>value</code> 值，第二个值表示对应的 <code>key</code> 是否存在，若存在 <code>ok</code> 为 <code>true</code> ，若不存在，则 <code>ok</code> 为 <code>false</code> 。</p></li> <li><p>遍历 map</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 遍历 map 中所有的元素需要用 for range 循环。</span>
<span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> steps3 <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;key: %s, value: %s\n&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>获取 map 长度</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 使用 len 函数可以获取 map 长度</span>
<span class="token keyword">func</span> <span class="token function">createMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token comment">//...</span>
     fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>steps3<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment">// 4</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul> <h4 id="map是引用类型"><a href="#map是引用类型" class="header-anchor">#</a> map是引用类型</h4> <p>当 <code>map</code> 被赋值为一个新变量的时候，它们指向同一个内部数据结构。因此，改变其中一个变量，就会影响到另一变量。</p> <div class="language-GO line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">mapByReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		steps4 <span class="token operator">:=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
		<span class="token string">&quot;第一步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;第二步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">,</span>
		<span class="token string">&quot;第三步&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;steps4: &quot;</span><span class="token punctuation">,</span> steps4<span class="token punctuation">)</span>
	<span class="token comment">// steps4:  map[第一步:123 第三步:789 第二步:456]</span>
	newSteps4 <span class="token operator">:=</span> steps4
	newSteps4<span class="token punctuation">[</span><span class="token string">&quot;第一步&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;123-222&quot;</span>
	newSteps4<span class="token punctuation">[</span><span class="token string">&quot;第二步&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;456-222&quot;</span>
	newSteps4<span class="token punctuation">[</span><span class="token string">&quot;第三步&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;789-222&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;steps4: &quot;</span><span class="token punctuation">,</span> steps4<span class="token punctuation">)</span>
  <span class="token comment">// steps4:  map[第一步:123-222 第三步:789-222 第二步:456-222]</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;newSteps4: &quot;</span><span class="token punctuation">,</span> newSteps4<span class="token punctuation">)</span>
  <span class="token comment">// newSteps4:  map[第一步:123-222 第三步:789-222 第二步:456-222]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>当 <code>map</code> 作为函数参数传递时也会发生同样的情况。</p> <h2 id="流程控制语句"><a href="#流程控制语句" class="header-anchor">#</a> 流程控制语句</h2> <h3 id="条件语句"><a href="#条件语句" class="header-anchor">#</a> 条件语句</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">if</span> 条件<span class="token number">1</span> <span class="token punctuation">{</span>
  逻辑代码<span class="token number">1</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span>  条件<span class="token number">2</span> <span class="token punctuation">{</span>
  逻辑代码<span class="token number">2</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> 条件 <span class="token operator">...</span> <span class="token punctuation">{</span>
  逻辑代码 <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  逻辑代码 <span class="token keyword">else</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code>score <span class="token operator">:=</span> <span class="token number">88</span>
<span class="token keyword">if</span> score <span class="token operator">&gt;=</span> <span class="token number">90</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩等级为A&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩等级为B&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> score <span class="token operator">&gt;=</span> <span class="token number">70</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩等级为C&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩等级为D&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩等级为E 成绩不及格&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>if</code> 还有另外一种写法，它包含一个 <code>statement</code> 可选语句部分，该可选语句在条件判断之前运行。它的语法是：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">if</span> statement<span class="token punctuation">;</span> condition <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> score <span class="token operator">:=</span> <span class="token number">88</span><span class="token punctuation">;</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;成绩及格&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="switch-case"><a href="#switch-case" class="header-anchor">#</a> switch case</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">switch</span> 表达式 <span class="token punctuation">{</span>
    <span class="token keyword">case</span> 表达式值<span class="token number">1</span><span class="token punctuation">:</span>
        业务逻辑代码<span class="token number">1</span>
    <span class="token keyword">case</span> 表达式值<span class="token number">2</span><span class="token punctuation">:</span>
        业务逻辑代码<span class="token number">2</span>
    <span class="token keyword">case</span> 表达式值<span class="token number">3</span><span class="token punctuation">:</span>
        业务逻辑代码<span class="token number">3</span>
    <span class="token keyword">case</span> 表达式值 <span class="token operator">...</span><span class="token punctuation">:</span>
        业务逻辑代码 <span class="token operator">...</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
        业务逻辑代码
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code>grade <span class="token operator">:=</span> <span class="token string">&quot;B&quot;</span>
<span class="token keyword">switch</span> grade <span class="token punctuation">{</span>
<span class="token keyword">case</span> <span class="token string">&quot;A&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Your score is between 90 and 100.&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token string">&quot;B&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Your score is between 80 and 90.&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Your score is between 70 and 80.&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Your score is between 60 and 70.&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">default</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Your score is below 60.&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>一个 case 多个条件</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>month <span class="token operator">:=</span> <span class="token number">5</span>
<span class="token keyword">switch</span> month <span class="token punctuation">{</span>
<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;该月份有 31 天&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;该月份有 30 天&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;该月份闰年为 29 天，非闰年为 28 天&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">default</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;输入有误！&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>switch</code> 还有另外一种写法，它包含一个 <code>statement</code> 可选语句部分，该可选语句在表达式之前运行。它的语法是：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">switch</span> statement<span class="token punctuation">;</span> expression <span class="token punctuation">{</span>
<span class="token punctuation">}</span>


<span class="token keyword">switch</span> month <span class="token operator">:=</span> <span class="token number">5</span><span class="token punctuation">;</span> month <span class="token punctuation">{</span>
<span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;该月份有 31 天&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;该月份有 30 天&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;该月份闰年为 29 天，非闰年为 28 天&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">default</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;输入有误！&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这里 <code>month</code> 变量的作用域就仅限于这个 <code>switch</code> 内。</p> <p><strong>switch 后可接函数</strong></p> <p><code>switch</code> 后面可以接一个函数，只要保证 <code>case</code> 后的值类型与函数的返回值一致即可。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">getResult</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
 <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> args <span class="token punctuation">{</span>
  <span class="token keyword">if</span> v <span class="token operator">&lt;</span> <span class="token number">60</span> <span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 chinese <span class="token operator">:=</span> <span class="token number">88</span>
 math <span class="token operator">:=</span> <span class="token number">90</span>
 english <span class="token operator">:=</span> <span class="token number">95</span>

 <span class="token keyword">switch</span> <span class="token function">getResult</span><span class="token punctuation">(</span>chinese<span class="token punctuation">,</span> math<span class="token punctuation">,</span> english<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">case</span> <span class="token boolean">true</span><span class="token punctuation">:</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;考试通过&quot;</span><span class="token punctuation">)</span>
 <span class="token keyword">case</span> <span class="token boolean">false</span><span class="token punctuation">:</span>
  fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;考试未通过&quot;</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p><strong>无表达式的 switch</strong></p> <p><code>switch</code> 后面的表达式是可选的。如果省略该表达式，则表示这个 <code>switch</code> 语句等同于 <code>switch true</code> ，并且每个 <code>case</code> 表达式都被认定为有效，相应的代码块也会被执行。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>score <span class="token operator">:=</span> <span class="token number">88</span>
<span class="token keyword">switch</span> <span class="token punctuation">{</span>
<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">90</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;grade A&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">80</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;</span> <span class="token number">90</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;grade B&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">70</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;</span> <span class="token number">80</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;grade C&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> score <span class="token operator">&gt;=</span> <span class="token number">60</span> <span class="token operator">&amp;&amp;</span> score <span class="token operator">&lt;</span> <span class="token number">70</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;grade D&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> score <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;grade E&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>该 <code>switch-case</code> 语句相当于 <code>if-elseif-else</code> 语句。</p> <p><strong>fallthrough 语句</strong></p> <p>正常情况下 <code>switch-case</code> 语句在执行时只要有一个 <code>case</code> 满足条件，就会直接退出 <code>switch-case</code> ，如果一个都没有满足，才会执行 <code>default</code> 的代码块。不同于其他语言需要在每个 <code>case</code> 中添加 <code>break</code> 语句才能退出。使用 <code>fallthrough</code> 语句可以在已经执行完成的 <code>case</code> 之后，把控制权转移到下一个 <code>case</code> 的执行代码中。<code>fallthrough</code> 只能穿透一层，不管你有没有匹配上，都要退出了。<code>fallthrough</code> 语句是 <code>case</code> 子句的最后一个语句。如果它出现在了 <code>case</code> 语句的中间，编译会不通过。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>s <span class="token operator">:=</span> <span class="token string">&quot;123&quot;</span>
<span class="token keyword">switch</span> <span class="token punctuation">{</span>
<span class="token keyword">case</span> s <span class="token operator">==</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">fallthrough</span>
<span class="token keyword">case</span> s <span class="token operator">==</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;456&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">case</span> s <span class="token operator">!=</span> <span class="token string">&quot;789&quot;</span><span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;789&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="循环语句"><a href="#循环语句" class="header-anchor">#</a> 循环语句</h3> <p><strong>循环语句</strong> 可以用来重复执行某一段代码。在 C 语言中，循环语句有 <code>for</code> 、 <code>while</code> 和 <code>do while</code> 三种循环。但在 Go 中只有 <code>for</code> 一种循环语句。下面是 <code>for</code> 循环语句的四种基本模型：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// for 接三个表达式</span>
<span class="token keyword">for</span> initialisation<span class="token punctuation">;</span> condition<span class="token punctuation">;</span> post <span class="token punctuation">{</span>
   code
<span class="token punctuation">}</span>

<span class="token comment">// for 接一个条件表达式</span>
<span class="token keyword">for</span> condition <span class="token punctuation">{</span>
   code
<span class="token punctuation">}</span>

<span class="token comment">// for 接一个 range 表达式</span>
<span class="token keyword">for</span> range_expression <span class="token punctuation">{</span>
   code
<span class="token punctuation">}</span>

<span class="token comment">// for 不接表达式</span>
<span class="token keyword">for</span> <span class="token punctuation">{</span>
   code
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li><p><strong>接一个条件表达式</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>num <span class="token operator">:=</span> <span class="token number">0</span>
<span class="token keyword">for</span> num <span class="token operator">&lt;</span> <span class="token number">4</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    num<span class="token operator">++</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p><strong>接三个表达式</strong></p> <p><code>for</code> 后面接的这三个表达式，各有各的用途：</p> <ul><li>第一个表达式(<code>initialisation</code>)：初始化控制变量，在整个循环生命周期内，只执行一次；</li> <li>第二个表达式(<code>condition</code>)：设置循环控制条件，该表达式值为 <code>true</code> 时循环，值为 <code>false</code> 时结束循环；</li> <li>第三个表达式(<code>post</code>)：每次循环完都会执行此表达式，可以利用其让控制变量增量或减量。</li></ul> <p>这三个表达式，使用 <code>;</code> 分隔。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">for</span> num <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> num <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> num<span class="token operator">++</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p><strong>接一个 range 表达式</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>str <span class="token operator">:=</span> <span class="token string">&quot;Golang&quot;</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> str<span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;index %d, value %c\n&quot;</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p><strong>不接表达式</strong></p> <p><code>for</code> 后面不接表达式就相当于无限循环，当然，可以使用 <code>break</code> 语句退出循环</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 第一种写法</span>
<span class="token keyword">for</span> <span class="token punctuation">{</span>
    code
<span class="token punctuation">}</span>
<span class="token comment">// 第二种写法</span>
<span class="token keyword">for</span> <span class="token punctuation">;</span><span class="token punctuation">;</span> <span class="token punctuation">{</span>
    code
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p><strong>break 语句</strong></p> <p><code>break</code> 语句用于终止 <code>for</code> 循环，之后程序将执行在 <code>for</code> 循环后的代码。上面的例子已经演示了 <code>break</code> 语句的使用。</p></li> <li><p><strong>continue 语句</strong></p> <p><code>continue</code> 语句用来跳出 <code>for</code> 循环中的当前循环。在 <code>continue</code> 语句后的所有的 <code>for</code> 循环语句都不会在本次循环中执行，执行完 <code>continue</code> 语句后将会继续执行一下次循环。下面的程序会打印出 <code>10</code> 以内的奇数。</p></li></ul> <h3 id="defer延迟调用"><a href="#defer延迟调用" class="header-anchor">#</a> defer延迟调用</h3> <p>含有 <code>defer</code> 语句的函数，会在该函数将要返回之前，调用另一个函数。简单点说就是 <code>defer</code> 语句后面跟着的函数会延迟到当前函数执行完后再执行。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">bookPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> <span class="token function">bookPrint</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main函数...&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>首先，执行 <code>main</code> 函数，因为 <code>bookPrint()</code> 函数前有 <code>defer</code> 关键字，所以会在执行完 <code>main</code> 函数后再执行 <code>bookPrint()</code> 函数，所以先打印出 <code>main函数...</code> ，再执行 <code>bookPrint()</code> 函数打印 <code>123</code> 。</p> <p><strong>即时求值的变量快照</strong></p> <p>使用 <code>defer</code> 只是延时调用函数，传递给函数里的变量，不应该受到后续程序的影响。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>str <span class="token operator">:=</span> <span class="token string">&quot;123&quot;</span>
<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
str <span class="token operator">=</span> <span class="token string">&quot;456&quot;</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
<span class="token comment">// 456</span>
<span class="token comment">// 123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>延迟方法</strong></p> <p><code>defer</code> 不仅能够延迟函数的执行，也能延迟方法的执行。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	bookName<span class="token punctuation">,</span> authorName <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b Book<span class="token punctuation">)</span> <span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s %s&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>bookName<span class="token punctuation">,</span> b<span class="token punctuation">.</span>authorName<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	book <span class="token operator">:=</span> Book<span class="token punctuation">{</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;456&quot;</span><span class="token punctuation">}</span>
	<span class="token keyword">defer</span> book<span class="token punctuation">.</span><span class="token function">printName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;main... &quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// main... 123 456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>defer 栈</strong></p> <p>当一个函数内多次调用 <code>defer</code> 时，Go 会把 <code>defer</code> 调用放入到一个栈中，随后按照 <strong>后进先出</strong> 的顺序执行。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;456&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;789&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;main...&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//main...789456123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>defer 在 return 后调用</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">var</span> s <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span>

<span class="token keyword">func</span> <span class="token function">showLesson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        s <span class="token operator">=</span> <span class="token string">&quot;456&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;showLesson: s =&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
    <span class="token keyword">return</span> s
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lesson <span class="token operator">:=</span> <span class="token function">showLesson</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main: s =&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main: lesson =&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//showLesson: s = 123</span>
<span class="token comment">//main: s = 456</span>
<span class="token comment">//main: lesson = 123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><blockquote><h3 id="go-中-defer-和-return-执行的先后顺序"><a href="#go-中-defer-和-return-执行的先后顺序" class="header-anchor">#</a> Go 中 defer 和 return 执行的先后顺序</h3> <ol><li>多个defer的执行顺序为“后进先出”；</li> <li>defer、return、返回值三者的执行逻辑应该是：return最先执行，return负责将结果写入返回值中；接着defer开始执行一些收尾工作；最后函数携带当前返回值退出。</li></ol> <p>如果函数的返回值是无名的（不带命名返回值），则go语言会在执行return的时候会执行一个类似创建一个临时变量作为保存return值的动作，而有名返回值的函数，由于返回值在函数定义的时候已经将该变量进行定义，在执行return的时候会先执行返回值保存操作，而后续的defer函数会改变这个返回值(虽然defer是在return之后执行的，但是由于使用的函数定义的变量，所以执行defer操作后对该变量的修改会影响到return的值</p></blockquote> <p><strong>defer 可以使代码更简洁</strong></p> <p>如果没有使用 <code>defer</code> ，当在一个操作资源的函数里调用多个 <code>return</code> 时，每次都得释放资源，你可能这样写代码：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">:=</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//0，获取资源</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token operator">...</span> <span class="token punctuation">{</span>
        r<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//1，释放资源</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token operator">...</span> <span class="token punctuation">{</span>
        r<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//2，释放资源</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token operator">...</span> <span class="token punctuation">{</span>
        r<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//3，释放资源</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    r<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">//4，释放资源</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>有了 <code>defer</code> 之后，可以简洁地写成下面这样：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    r <span class="token operator">:=</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//0，获取资源</span>

    <span class="token keyword">defer</span> r<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//1，释放资源</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token operator">...</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token operator">...</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">if</span> <span class="token operator">...</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span><span class="token operator">...</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="goto无条件跳转"><a href="#goto无条件跳转" class="header-anchor">#</a> goto无条件跳转</h3> <p>在 Go 语言中保留 <code>goto</code> 。<code>goto</code> 后面接的是标签，表示下一步要执行哪里的代码。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">goto</span> label
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;456&quot;</span><span class="token punctuation">)</span>
label<span class="token punctuation">:</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;789&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//123</span>
<span class="token comment">//789</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="指针"><a href="#指针" class="header-anchor">#</a> 指针</h2> <p>一个指针变量指向了一个值的内存地址。</p> <p>类似于变量和常量，在使用指针前你需要声明指针。指针声明格式如下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> var_name <span class="token operator">*</span><span class="token keyword">var</span><span class="token operator">-</span><span class="token keyword">type</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>var-type 为指针类型，var_name 为指针变量名，* 号用于指定变量是作为一个指针。以下是有效的指针声明：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> ip <span class="token operator">*</span><span class="token builtin">int</span>        <span class="token comment">/* 指向整型*/</span>
<span class="token keyword">var</span> fp <span class="token operator">*</span><span class="token builtin">float32</span>    <span class="token comment">/* 指向浮点型 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="操作符"><a href="#操作符" class="header-anchor">#</a> 操作符</h3> <ul><li>&amp; 操作符可以从一个变量中取到其内存地址。</li></ul> <ul><li>操作符如果在赋值操作值的左边，指该指针指向的变量；* 操作符如果在赋值操作符的右边，指从一个指针变量中取得变量值，又称指针的解引用。</li></ul> <h3 id="如何使用指针"><a href="#如何使用指针" class="header-anchor">#</a> 如何使用指针</h3> <p>指针使用流程：</p> <ul><li>定义指针变量。</li> <li>为指针变量赋值。</li> <li>访问指针变量中指向地址的值。</li> <li>在指针类型前面加上 * 号（前缀）来获取指针所指向的内容。</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> a <span class="token builtin">int</span><span class="token operator">=</span> <span class="token number">20</span>   <span class="token comment">/* 声明实际变量 */</span>
   <span class="token keyword">var</span> ip <span class="token operator">*</span><span class="token builtin">int</span>        <span class="token comment">/* 声明指针变量 */</span>

   ip <span class="token operator">=</span> <span class="token operator">&amp;</span>a  <span class="token comment">/* 指针变量的存储地址 */</span>

   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;a 变量的地址是: %x\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>a  <span class="token punctuation">)</span>

   <span class="token comment">/* 指针变量的存储地址 */</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;ip 变量储存的指针地址: %x\n&quot;</span><span class="token punctuation">,</span> ip <span class="token punctuation">)</span>

   <span class="token comment">/* 使用指针访问值 */</span>
   fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;*ip 变量的值: %d\n&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>ip <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//a 变量的地址是: 20818a220</span>
<span class="token comment">//ip 变量储存的指针地址: 20818a220</span>
<span class="token comment">//*ip 变量的值: 20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="空指针"><a href="#空指针" class="header-anchor">#</a> 空指针</h3> <p>当一个指针被定义后没有分配到任何变量时，它的值为 nil。</p> <p>nil 指针也称为空指针。</p> <p>nil在概念上和其它语言的null、None、nil、NULL一样，都指代零值或空值。</p> <p>一个指针变量通常缩写为 ptr。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ptr <span class="token operator">*</span><span class="token builtin">int</span>

  fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;ptr 的值为 : %x**\n**&quot;</span><span class="token punctuation">,</span> ptr  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//ptr 的值为 : 0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>空指针判断</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">if</span><span class="token punctuation">(</span>ptr <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>     <span class="token comment">/* ptr 不是空指针 */</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>ptr <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>    <span class="token comment">/* ptr 是空指针 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="函数传递指针函数"><a href="#函数传递指针函数" class="header-anchor">#</a> 函数传递指针函数</h3> <p>在函数中对指针参数所做的修改，在函数返回后会保存相应的修改。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">changeByPointer</span><span class="token punctuation">(</span>value <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>value <span class="token operator">=</span> <span class="token number">200</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x3 <span class="token operator">:=</span> <span class="token number">99</span>
	p3 <span class="token operator">:=</span> <span class="token operator">&amp;</span>x3
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;执行changeByPointer函数之前p3是&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p3<span class="token punctuation">)</span>
	<span class="token function">changeByPointer</span><span class="token punctuation">(</span>p3<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;执行changeByPointer函数之后p3是&quot;</span><span class="token punctuation">,</span> <span class="token operator">*</span>p3<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//执行changeByPointer函数之前p3是 99</span>
<span class="token comment">//执行changeByPointer函数之后p3是 200</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="指针与切片"><a href="#指针与切片" class="header-anchor">#</a> 指针与切片</h3> <p>切片与指针一样是引用类型，如果我们想通过一个函数改变一个数组的值，可以将该数组的切片当作参数传给函数，也可以将这个数组的指针当作参数传给函数。但 Go 中建议使用第一种方法，即将该数组的切片当作参数传给函数，因为这么写更加简洁易读。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// 使用切片</span>
<span class="token keyword">func</span> <span class="token function">changeSlice</span><span class="token punctuation">(</span>value <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用数组指针</span>
<span class="token keyword">func</span> <span class="token function">changeArray</span><span class="token punctuation">(</span>value <span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">(</span><span class="token operator">*</span>value<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	x <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">}</span>
	<span class="token function">changeSlice</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment">// [200 20 30]</span>

	y <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">}</span>
	<span class="token function">changeArray</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>y<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token comment">// [200 200 300]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="结构体"><a href="#结构体" class="header-anchor">#</a> 结构体</h2> <p>Go 语言中数组可以存储同一类型的数据，但在结构体中我们可以为不同项定义不同的数据类型。</p> <p>结构体是由一系列具有相同类型或不同类型的数据构成的数据集合。Go中没有<code>class</code>的概念，只有<code>struct</code>结构体，所以也没有继承。</p> <h3 id="声明-2"><a href="#声明-2" class="header-anchor">#</a> 声明</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> struct_name <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    attribute_name1   attribute_type
    attribute_name2   attribute_type
    <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name   <span class="token builtin">string</span> <span class="token comment">//名称</span>
	target <span class="token builtin">string</span> <span class="token comment">//学习目标</span>
	spend  <span class="token builtin">int</span>    <span class="token comment">//学习花费时间</span>
<span class="token punctuation">}</span>
<span class="token comment">//可以把相同类型的属性声明在同一行，这样可以使结构体变得更加紧凑</span>
<span class="token keyword">type</span> Lesson2 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">,</span> target    <span class="token builtin">string</span>
    spend             <span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>上面的结构体称为命名结构体<code>Named Structure</code>。声明结构体时也可以不用声明新类型，这种结构体类型称为匿名结构体<code>Anonymous Structure</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> Lesson3 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">,</span> target    <span class="token builtin">string</span>
    spend             <span class="token builtin">int</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="创建命名结构体"><a href="#创建命名结构体" class="header-anchor">#</a> 创建命名结构体</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span> target    <span class="token builtin">string</span>
	spend             <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 使用字段名创建结构体</span>
	lesson1 <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;Golang&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;学习Go语言，并完成一个单体服务&quot;</span><span class="token punctuation">,</span>
		spend<span class="token punctuation">:</span>  <span class="token number">5</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// 不使用字段名创建结构体，按字段声明顺序初始化</span>
	lesson2 <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span><span class="token string">&quot;Golang&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;学习Go语言，并完成一个单体服务&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson1 &quot;</span><span class="token punctuation">,</span> lesson1<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson2 &quot;</span><span class="token punctuation">,</span> lesson2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="结构体标签"><a href="#结构体标签" class="header-anchor">#</a> 结构体标签</h3> <p>Tag是结构体的元信息，可以在运行的时候通过反射的机制读取出来。</p> <p>Tag在结构体字段的后方定义，由一对反引号包裹起来，具体的格式如下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>    <span class="token string">`key1:&quot;value1&quot; key2:&quot;value2&quot;`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结构体标签由一个或多个键值对组成。键与值使用冒号分隔，值用双引号括起来。键值对之间使用一个空格分隔。 注意事项： 为结构体编写Tag时，必须严格遵守键值对的规则。结构体标签的解析代码的容错能力很差，一旦格式写错，编译和运行时都不会提示任何错误，通过反射也无法正确取值。例如不要在key和value之间添加空格。</p> <p>例如我们为Student结构体的每个字段定义json序列化时使用的Tag：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">//Student 学生</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    ID     <span class="token builtin">int</span>    <span class="token string">`json:&quot;id&quot;`</span> <span class="token comment">//通过指定tag实现json序列化该字段时的key</span>
    Gender <span class="token builtin">string</span> <span class="token comment">//json序列化是默认使用字段名作为key</span>
    name   <span class="token builtin">string</span> <span class="token comment">//私有不能被json包访问</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s1 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>
        ID<span class="token punctuation">:</span>     <span class="token number">1</span><span class="token punctuation">,</span>
        Gender<span class="token punctuation">:</span> <span class="token string">&quot;女&quot;</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span>   <span class="token string">&quot;pprof&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    data<span class="token punctuation">,</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Marshal</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;json marshal failed!&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;json str:%s\n&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token comment">//json str:{&quot;id&quot;:1,&quot;Gender&quot;:&quot;女&quot;}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="创建匿名结构体"><a href="#创建匿名结构体" class="header-anchor">#</a> 创建匿名结构体</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建匿名结构体变量</span>
	lesson3 <span class="token operator">:=</span> <span class="token keyword">struct</span> <span class="token punctuation">{</span>
		name<span class="token punctuation">,</span> target <span class="token builtin">string</span>
		spend          <span class="token builtin">int</span>
	<span class="token punctuation">}</span><span class="token punctuation">{</span>
		name<span class="token punctuation">:</span>   <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;掌握GO语言&quot;</span><span class="token punctuation">,</span>
		spend<span class="token punctuation">:</span>   <span class="token number">3</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson3 &quot;</span><span class="token punctuation">,</span> lesson3<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="结构体的零值-zero-value"><a href="#结构体的零值-zero-value" class="header-anchor">#</a> 结构体的零值(Zero Value)</h3> <p>当定义好的结构体没有被显式初始化时，结构体的字段将会默认赋为相应类型的零值。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span> target    <span class="token builtin">string</span>
	spend             <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 不初始化结构体</span>
	<span class="token keyword">var</span> lesson4 <span class="token operator">=</span> Lesson<span class="token punctuation">{</span><span class="token punctuation">}</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson4 &quot;</span><span class="token punctuation">,</span> lesson4<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//lesson4  {  0}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="访问结构体字段"><a href="#访问结构体字段" class="header-anchor">#</a> 访问结构体字段</h3> <p>使用<code>.</code>点操作符访问：<code>lesson.name</code></p> <p>使用<code>.</code>也可用与给结构体字段赋值:<code>lesson.name = &quot;test&quot;</code></p> <h3 id="指向结构体的指针"><a href="#指向结构体的指针" class="header-anchor">#</a> 指向结构体的指针</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span> target    <span class="token builtin">string</span>
	spend             <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson8 <span class="token operator">:=</span> <span class="token operator">&amp;</span>Lesson<span class="token punctuation">{</span><span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Go语言微服务&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson8 name: &quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">*</span>lesson8<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson8 name: &quot;</span><span class="token punctuation">,</span> lesson8<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><code>lesson8</code> 是一个指向结构体 <code>Lesson</code> 的指针，用 <code>(*lesson8).name</code> 访问 <code>lesson8</code> 的 <code>name</code> 字段， <code>lesson8.name</code> 代替 <code>(*lesson8).name</code> 的解引用访问。</p> <h3 id="匿名字段"><a href="#匿名字段" class="header-anchor">#</a> 匿名字段</h3> <p>在创建结构体时，字段可以只有类型没有字段名，这种字段称为 <strong>匿名字段(Anonymous Field)</strong> 。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson4 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	<span class="token builtin">string</span>
	<span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson9 <span class="token operator">:=</span> Lesson4<span class="token punctuation">{</span><span class="token string">&quot;Golang&quot;</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson9 &quot;</span><span class="token punctuation">,</span> lesson9<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson9 string: &quot;</span><span class="token punctuation">,</span> lesson9<span class="token punctuation">.</span><span class="token builtin">string</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson9 int: &quot;</span><span class="token punctuation">,</span> lesson9<span class="token punctuation">.</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>上面的程序结构体定义了两个匿名字段，虽然这两个字段没有字段名，但匿名字段的名称默认就是它的类型。所以上面的结构体 <code>Lesoon4</code> 有两个名为 <code>string</code> 和 <code>int</code> 的字段。</p> <h3 id="嵌套结构体"><a href="#嵌套结构体" class="header-anchor">#</a> 嵌套结构体</h3> <p>结构体的字段也可能是另外一个结构体，这样的结构体称为 <strong>嵌套结构体(Nested Structs)</strong></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Author <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
  	wx <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Lesson5 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span>target <span class="token builtin">string</span>
	spend <span class="token builtin">int</span>
	author Author
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson10 <span class="token operator">:=</span> Lesson5<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		spend<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	lesson10<span class="token punctuation">.</span>author <span class="token operator">=</span> Author<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;golang&quot;</span><span class="token punctuation">,</span>
		wx<span class="token punctuation">:</span> <span class="token string">&quot;666&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 name:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 spend:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>spend<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 author name:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 author wx:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>author<span class="token punctuation">.</span>wx<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>上面的程序 <code>Lesson5</code> 结构体有一个字段 <code>author</code> ，而且它的类型也是一个结构体 <code>Author</code> 。</p> <h3 id="提升字段"><a href="#提升字段" class="header-anchor">#</a> 提升字段</h3> <p>结构体中如果有匿名的结构体类型字段，则该匿名结构体里的字段就称为 <strong>提升字段(Promoted Fields)</strong> 。这是因为提升字段就像是属于外部结构体一样，可以用外部结构体直接访问。就像刚刚上面的程序，如果我们把 <code>Lesson</code> 结构体中的字段 <code>author</code> 直接用匿名字段 <code>Author</code> 代替， <code>Author</code> 结构体的字段例如 <code>name</code> 就不用像上面那样使用 <code>lesson10.author.wx</code> 访问，而是使用 <code>lesson10.wx</code> 就能访问 <code>Author</code> 结构体中的 <code>wx</code> 字段。现在结构体 <code>Author</code> 有 <code>name</code> 、 <code>wx</code> 两个字段，访问字段就像在 <code>Lesson</code> 里直接声明的一样，因此我们称之为提升字段。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Author <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
  	wx <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Lesson6 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span>target <span class="token builtin">string</span>
	spend <span class="token builtin">int</span>
	Author
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson10 <span class="token operator">:=</span> Lesson6<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span>   <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	lesson10<span class="token punctuation">.</span>Author <span class="token operator">=</span> Author<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;golang&quot;</span><span class="token punctuation">,</span>
		wx<span class="token punctuation">:</span>   <span class="token string">&quot;666&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 name:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 target:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;lesson10 author wx:&quot;</span><span class="token punctuation">,</span> lesson10<span class="token punctuation">.</span>wx<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//lesson10 name: Go语言</span>
<span class="token comment">//lesson10 target: 掌握Go语言</span>
<span class="token comment">//lesson10 author wx: 666</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="结构体比较"><a href="#结构体比较" class="header-anchor">#</a> 结构体比较</h3> <p>如果结构体的全部成员都是可以比较的，那么结构体也是可以比较的，那样的话两个结构体将可以使用 <code>==</code> 或 <code>!=</code> 运算符进行比较。可以通过==运算符或 DeeplyEqual()函数比较两个结构相同的类型并包含相同的字段值。因此下面两个比较的表达式是等价的：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span>  Lesson  <span class="token keyword">struct</span><span class="token punctuation">{</span>
	name<span class="token punctuation">,</span>target <span class="token builtin">string</span>
	spend <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson11 <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span>   <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	lesson12 <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span>   <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>lesson11<span class="token punctuation">.</span>name <span class="token operator">==</span> lesson12<span class="token punctuation">.</span>name <span class="token operator">&amp;&amp;</span> lesson11<span class="token punctuation">.</span>target <span class="token operator">==</span> lesson12<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token comment">// true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>lesson11 <span class="token operator">==</span> lesson12<span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="给结构体定义方法"><a href="#给结构体定义方法" class="header-anchor">#</a> 给结构体定义方法</h3> <p>在 Go 中无法在结构体内部定义方法</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// Lesson 定义一个名为 Lesson 的结构体</span>
<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span> target <span class="token builtin">string</span>
	spend        <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">// ShowLessonInfo 定义一个与 Lesson 的绑定的方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>l Lesson<span class="token punctuation">)</span> <span class="token function">ShowLessonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;target:&quot;</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson13 <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span>   <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	lesson13<span class="token punctuation">.</span><span class="token function">ShowLessonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>上面的程序中定义了一个与结构体 <code>Lesson</code> 绑定的方法 <code>ShowLessonInfo()</code> ，其中 <code>ShowLessonInfo</code> 是方法名， <code>(l Lesson)</code> 表示将此方法与 <code>Lesson</code> 的实例绑定，这在 Go 语言中称为接收者，而 <code>l</code> 表示实例本身，相当于 Python 中的 <code>self</code> ，在方法内可以使用 <code>实例本身.属性名称</code> 来访问实例属性。</p> <h3 id="方法的参数传递方式"><a href="#方法的参数传递方式" class="header-anchor">#</a> 方法的参数传递方式</h3> <p>如果绑定结构体的方法中要改变实例的属性时，必须使用指针作为方法的接收者。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// Lesson 定义一个名为 Lesson 的结构体</span>
<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span>target <span class="token builtin">string</span>
	spend <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">// ShowLessonInfo 定义一个与 Lesson 的绑定的方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>l Lesson<span class="token punctuation">)</span> <span class="token function">ShowLessonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;target:&quot;</span><span class="token punctuation">,</span> l<span class="token punctuation">.</span>target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// AddTime 定义一个与 Lesson 的绑定的方法，使 spend 值加 n</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>Lesson<span class="token punctuation">)</span> <span class="token function">AddTime</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	l<span class="token punctuation">.</span>spend <span class="token operator">=</span> l<span class="token punctuation">.</span>spend <span class="token operator">+</span> n
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson13 <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span>   <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
        spend<span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;添加add方法前&quot;</span><span class="token punctuation">)</span>
	lesson13<span class="token punctuation">.</span><span class="token function">ShowLessonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	lesson13<span class="token punctuation">.</span><span class="token function">AddTime</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;添加add方法后&quot;</span><span class="token punctuation">)</span>
	lesson13<span class="token punctuation">.</span><span class="token function">ShowLessonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="函数"><a href="#函数" class="header-anchor">#</a> 函数</h2> <p><strong>函数</strong> 是基于功能或逻辑进行封装的可复用的代码结构。将一段功能复杂、很长的一段代码封装成多个代码片段(即函数)，有助于提高代码可读性和可维护性。由于 Go 语言是编译型语言，所以函数编写的顺序是无关紧要的。</p> <h3 id="声明-3"><a href="#声明-3" class="header-anchor">#</a> 声明</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">function_name</span><span class="token punctuation">(</span>parameter_list<span class="token punctuation">)</span> <span class="token punctuation">(</span>result_list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//函数体</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="可变参数"><a href="#可变参数" class="header-anchor">#</a> 可变参数</h3> <h4 id="多个类型一致的参数"><a href="#多个类型一致的参数" class="header-anchor">#</a> 多个类型一致的参数</h4> <p>在参数类型前面加 <code>...</code> 表示一个切片，用来接收调用者传入的参数。注意，如果该函数下有其他类型的参数，这些其他参数必须放在参数列表的前面，切片必须放在最后。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">show</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	sum <span class="token operator">:=</span> <span class="token number">0</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> item <span class="token operator">:=</span> <span class="token keyword">range</span> args <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
		sum <span class="token operator">+=</span> <span class="token number">1</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> sum
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="多个类型不一致的参数"><a href="#多个类型不一致的参数" class="header-anchor">#</a> 多个类型不一致的参数</h4> <p>如果传多个参数的类型都不一样，可以指定类型为 <code>...interface{}</code> ，然后再遍历。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">PrintType</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> arg <span class="token operator">:=</span> <span class="token keyword">range</span> args <span class="token punctuation">{</span>
		<span class="token keyword">switch</span> arg<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">case</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token string">&quot;type is int.&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">case</span> <span class="token builtin">string</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token string">&quot;type is string.&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">case</span> <span class="token builtin">float64</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token string">&quot;type is float64.&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">default</span><span class="token punctuation">:</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token string">&quot;is an unknown type.&quot;</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">PrintType</span><span class="token punctuation">(</span><span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">3.14</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="解序列"><a href="#解序列" class="header-anchor">#</a> 解序列</h3> <p>使用 <code>...</code> 可以用来解序列</p> <h3 id="函数的返回值"><a href="#函数的返回值" class="header-anchor">#</a> 函数的返回值</h3> <p>当函数没有返回值时，函数体可以使用 <code>return</code> 语句返回。在 Go 中一个函数可以返回多个值。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">showBookInfo</span><span class="token punctuation">(</span>bookName<span class="token punctuation">,</span> authorName <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> bookName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;图书名称为空&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> authorName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;作者名称为空&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> bookName <span class="token operator">+</span> <span class="token string">&quot;,作者:&quot;</span> <span class="token operator">+</span> authorName<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	bookInfo<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">showBookInfo</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;45&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;bookInfo = %s, err = %v&quot;</span><span class="token punctuation">,</span> bookInfo<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>返回带有变量名的值</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">showBookInfo2</span><span class="token punctuation">(</span>bookName<span class="token punctuation">,</span> authorName <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>info <span class="token builtin">string</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	info <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
	<span class="token keyword">if</span> bookName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		err <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;图书名称为空&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> authorName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		err <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;作者名称为空&quot;</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
    <span class="token comment">// 不使用 := 因为已经在返回值那里声明了</span>
	info <span class="token operator">=</span> bookName <span class="token operator">+</span> <span class="token string">&quot;,作者:&quot;</span> <span class="token operator">+</span> authorName
  	<span class="token comment">// 直接返回即可</span>
	<span class="token keyword">return</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="匿名函数"><a href="#匿名函数" class="header-anchor">#</a> 匿名函数</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>parameter_list<span class="token punctuation">)</span> <span class="token punctuation">(</span>result_list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	body
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="内部方法与外部方法"><a href="#内部方法与外部方法" class="header-anchor">#</a> 内部方法与外部方法</h3> <p>在 Go 语言中，函数名通过首字母大小写实现控制对方法的访问权限。</p> <ul><li>当方法的首字母为 <strong>大写</strong> 时，这个方法对于 <strong>所有包</strong> 都是 <strong>Public</strong> ，其他包可以随意调用。</li> <li>当方法的首字母为 <strong>小写</strong> 时，这个方法是 <strong>Private</strong> ，其他包是无法访问的。</li></ul> <h2 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h2> <p><strong>方法</strong> 其实就是一个函数，在 <code>func</code> 这个关键字和方法名中间加入了一个特殊的接收器类型。接收器可以是结构体类型或者是非结构体类型。接收器是可以在方法的内部访问的。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>t Type<span class="token punctuation">)</span> <span class="token function">methodName</span><span class="token punctuation">(</span>parameterList<span class="token punctuation">)</span> returnList<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="实例绑定"><a href="#实例绑定" class="header-anchor">#</a> 实例绑定</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// Lesson 定义一个名为 Lesson 的结构体</span>
<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name   <span class="token builtin">string</span>
    Target <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// PrintInfo 定义一个与 Lesson 的绑定的方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;target:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    l <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span> <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
        Target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    l<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>也可以把上面程序的方法改成一个函数</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name   <span class="token builtin">string</span>
    Target <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;target:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lesson <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span> <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
        Target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token function">PrintInfo</span><span class="token punctuation">(</span>lesson<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>运行这个程序，也同样会输出上面一样的答案，那么我们为什么还要用方法呢？因为在 Go 中，相同的名字的方法可以定义在不同的类型上，而相同名字的函数是不被允许的。如果你在上面这个程序添加一个同名函数，就会报错。但是在不同的结构体上面定义同名的方法就是可行的。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name   <span class="token builtin">string</span>
    Target <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Lesson name:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Lesson target:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Target<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Author <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>author Author<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;author name:&quot;</span><span class="token punctuation">,</span> author<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lesson <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
        Name<span class="token punctuation">:</span> <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
        Target<span class="token punctuation">:</span> <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    lesson<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    author <span class="token operator">:=</span> Author<span class="token punctuation">{</span><span class="token string">&quot;Google&quot;</span><span class="token punctuation">}</span>
    author<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="指针接收器与值接收器"><a href="#指针接收器与值接收器" class="header-anchor">#</a> 指针接收器与值接收器</h3> <p>值接收器和指针接收器之间的区别在于，在指针接收器的方法内部的改变对于调用者是可见的，然而值接收器的方法内部的改变对于调用者是不可见的，所以若要改变实例的属性时，必须使用指针作为方法的接收者。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// Lesson 定义一个名为 Lesson 的结构体</span>
<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Name      <span class="token builtin">string</span>
	Target    <span class="token builtin">string</span>
	SpendTime <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">// PrintInfo 定义一个与 Lesson 的绑定的方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;target:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>Target<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;spendTime:&quot;</span><span class="token punctuation">,</span> lesson<span class="token punctuation">.</span>SpendTime<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token function">ChangeLessonName</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson<span class="token punctuation">.</span>Name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>lesson <span class="token operator">*</span>Lesson<span class="token punctuation">)</span> <span class="token function">AddSpendTime</span><span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson<span class="token punctuation">.</span>SpendTime <span class="token operator">=</span> lesson<span class="token punctuation">.</span>SpendTime <span class="token operator">+</span> n
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span>
		Name<span class="token punctuation">:</span>      <span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span>
		Target<span class="token punctuation">:</span>    <span class="token string">&quot;掌握Go语言&quot;</span><span class="token punctuation">,</span>
		SpendTime<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;before change&quot;</span><span class="token punctuation">)</span>
	lesson<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;after change&quot;</span><span class="token punctuation">)</span>
	lesson<span class="token punctuation">.</span><span class="token function">AddSpendTime</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
	lesson<span class="token punctuation">.</span><span class="token function">ChangeLessonName</span><span class="token punctuation">(</span><span class="token string">&quot;Go语言123&quot;</span><span class="token punctuation">)</span>
	lesson<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>在上面的程序中， <code>AddSpendTime</code> 使用指针接收器最终能改变实例的 <code>SpendTime</code> 值，然而使用值接收器的 <code>ChangeLessonName</code> 最终没有改变实例 <code>Name</code> 的值。</p> <h3 id="在方法中使用值接收器-与-在函数中使用值参数"><a href="#在方法中使用值接收器-与-在函数中使用值参数" class="header-anchor">#</a> 在方法中使用值接收器 与 在函数中使用值参数</h3> <p>当一个函数有一个值参数，它只能接受一个值参数。当一个方法有一个值接收器，它可以接受值接收器和指针接收器。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Lesson <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Name <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>lesson<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span>lesson Lesson<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>lesson<span class="token punctuation">.</span>Name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	lesson <span class="token operator">:=</span> Lesson<span class="token punctuation">{</span><span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">}</span>
	<span class="token function">PrintInfo</span><span class="token punctuation">(</span>lesson<span class="token punctuation">)</span>
	lesson<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	bPtr <span class="token operator">:=</span> <span class="token operator">&amp;</span>lesson
	<span class="token comment">//PrintInfo(bPtr) // error</span>
	bPtr<span class="token punctuation">.</span><span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>在上面的程序中，使用值参数 <code>PrintInfo(lesson)</code> 来调用这个函数是合法的，使用值接收器来调用 <code>lesson.PrintInfo()</code> 也是合法的。</p> <p>然后在程序中我们创建了一个指向 <code>Lesson</code> 的指针 <code>bPtr</code> ，通过使用指针接收器来调用 <code>bPtr.PrintInfo()</code> 是合法的，但使用值参数调用 <code>PrintInfo(bPtr)</code> 是非法的。</p> <h3 id="在非结构体上的方法"><a href="#在非结构体上的方法" class="header-anchor">#</a> 在非结构体上的方法</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> myInt <span class="token builtin">int</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>a myInt<span class="token punctuation">)</span> <span class="token function">add</span><span class="token punctuation">(</span>b myInt<span class="token punctuation">)</span> myInt <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x myInt <span class="token operator">=</span> <span class="token number">50</span>
    <span class="token keyword">var</span> y myInt <span class="token operator">=</span> <span class="token number">7</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// 57</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="接口"><a href="#接口" class="header-anchor">#</a> 接口</h2> <p>在 Go 语言中， <strong>接口</strong> 就是方法签名(Method Signature)的集合。在面向对象的领域里，接口定义一个对象的行为，接口只指定了对象应该做什么，至于如何实现这个行为，则由对象本身去确定。当一个类型实现了接口中的所有方法，我们称它实现了该接口。接口指定了一个类型应该具有的方法，并由该类型决定如何实现这些方法。</p> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> interface_name <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="接口实现"><a href="#接口实现" class="header-anchor">#</a> 接口实现</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Study <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    book <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s Student<span class="token punctuation">)</span> <span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 在读 %s&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>book<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    student1 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>
        name<span class="token punctuation">:</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span>
        book<span class="token punctuation">:</span> <span class="token string">&quot;《Go语言》&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    student1<span class="token punctuation">.</span><span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>上面的程序定义了一个名为 <code>Study</code> 的接口，接口中有未实现的方法 <code>learn()</code> ，这里还定义了名为 <code>Student</code> 的结构体，其绑定了方法 <code>learn()</code> ，也就隐式实现了 <code>Study</code> 接口，实现的内容是打印语句。</p> <h3 id="接口实现多态"><a href="#接口实现多态" class="header-anchor">#</a> 接口实现多态</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Study <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span> book <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s Student<span class="token punctuation">)</span> <span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 在读 %s&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>book<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> Worker <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name <span class="token builtin">string</span>
	book <span class="token builtin">string</span>
	by   <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w <span class="token operator">*</span>Worker<span class="token punctuation">)</span> <span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 在读 %s,通过方式 %s&quot;</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>name<span class="token punctuation">,</span> w<span class="token punctuation">.</span>book<span class="token punctuation">,</span> w<span class="token punctuation">.</span>by<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> s1 Study
	<span class="token keyword">var</span> s2 Study

	student2 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span>
		book<span class="token punctuation">:</span> <span class="token string">&quot;《Go语言》&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	s1 <span class="token operator">=</span> student2
	s1<span class="token punctuation">.</span><span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	student3 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;王五&quot;</span><span class="token punctuation">,</span>
		book<span class="token punctuation">:</span> <span class="token string">&quot;Go语言1&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	s1 <span class="token operator">=</span> <span class="token operator">&amp;</span>student3
	s1<span class="token punctuation">.</span><span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	worker1 <span class="token operator">:=</span> Worker<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;老王&quot;</span><span class="token punctuation">,</span>
		book<span class="token punctuation">:</span> <span class="token string">&quot;Go语言2&quot;</span><span class="token punctuation">,</span>
		by<span class="token punctuation">:</span>   <span class="token string">&quot;视频&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	<span class="token comment">// s2 = worker1 // error</span>
	s2 <span class="token operator">=</span> <span class="token operator">&amp;</span>worker1
	s2<span class="token punctuation">.</span><span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><h3 id="接口的内部表示"><a href="#接口的内部表示" class="header-anchor">#</a> 接口的内部表示</h3> <p>可以把接口的内部看做 <code>(type, value)</code>。<code>type</code> 是接口底层的具体类型(Concrete Type)，而 <code>value</code> 是具体类型的值。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">type</span> Study <span class="token keyword">interface</span> <span class="token punctuation">{</span>
	<span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">type</span> Student <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	name<span class="token punctuation">,</span> book <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>s Student<span class="token punctuation">)</span> <span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s 在读 %s&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>name<span class="token punctuation">,</span> s<span class="token punctuation">.</span>book<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">ShowInterface</span><span class="token punctuation">(</span>s Study<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;接口类型: %T\n 接口值: %v\n&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> s Study
	student2 <span class="token operator">:=</span> Student<span class="token punctuation">{</span>
		name<span class="token punctuation">:</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">,</span>
		book<span class="token punctuation">:</span> <span class="token string">&quot;《Go语言》&quot;</span><span class="token punctuation">,</span>
	<span class="token punctuation">}</span>
	s <span class="token operator">=</span> student2
	<span class="token function">ShowInterface</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	s<span class="token punctuation">.</span><span class="token function">learn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//接口类型: main.Student</span>
<span class="token comment">//接口值: {李四 《Go语言》}</span>
<span class="token comment">//李四 在读 《Go语言》</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="空接口"><a href="#空接口" class="header-anchor">#</a> 空接口</h3> <p><strong>空接口</strong> 是特殊形式的接口类型，没有定义任何方法的接口就称为空接口，可以说所有类型都至少实现了空接口，空接口表示为 <code>interface{}</code> 。例如，我们之前的写过的空接口参数函数，可以接受任何类型的参数：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">ShowType</span><span class="token punctuation">(</span>i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;类型: %T, 值: %v\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    str <span class="token operator">:=</span> <span class="token string">&quot;Go语言&quot;</span>
    <span class="token function">ShowType</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    num <span class="token operator">:=</span> <span class="token number">3.14</span>
    <span class="token function">ShowType</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>通过上面的例子不难发现接口都有两个属性，一个是值，而另一个是类型。对于空接口来说，这两个属性都为 <code>nil</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Type: %T, Value: %v&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token comment">// Type: &lt;nil&gt;, Value: &lt;nil&gt;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>除了上面讲到的使用空接口作为函数参数的用法，空接口还有以下两种用法。</p> <p>直接使用 <code>interface{}</code> 作为类型声明一个实例，这个实例就能承载任何类型的值：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

    i <span class="token operator">=</span> <span class="token string">&quot;Go语言&quot;</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// Let's go</span>

    i <span class="token operator">=</span> <span class="token number">3.14</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment">// 3.14</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>我们也可以定义一个接收任何类型的 <code>array</code> 、 <code>slice</code> 、 <code>map</code> 、 <code>strcut</code> 。例如：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    x <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Go&quot;</span>
    x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3.14</span>
    x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> value <span class="token operator">:=</span> <span class="token keyword">range</span> x <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>空接口可以承载任何值，但是空接口类型的对象是不能赋值给另一个固定类型对象的。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> num
    <span class="token keyword">var</span> str <span class="token builtin">string</span> <span class="token operator">=</span> i <span class="token comment">// error</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>当空接口承载数组和切片后，该对象无法再进行切片。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>

    <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> s

    <span class="token keyword">var</span> s2 <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment">// error</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="类型断言"><a href="#类型断言" class="header-anchor">#</a> 类型断言</h3> <p>类型断言用于提取接口的底层值(Underlying Value)。使用 <code>interface.(Type)</code> 可以获取接口的底层值，其中接口 <code>interface</code> 的具体类型是 <code>Type</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">assert</span><span class="token punctuation">(</span>i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> i<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> ok<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token number">3</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">var</span> y <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token string">&quot;Go语言&quot;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>第一次调用 <code>assert(x)</code> 输出 <code>3 true</code>，表示将整数 3 转换为 <code>int</code> 类型成功。</p> <p>第二次调用 <code>assert(y)</code> 输出 <code>0 false</code>，表示将字符串 &quot;Go语言&quot; 转换为 <code>int</code> 类型失败，因为该字符串无法转换为整数。</p> <h3 id="类型选择"><a href="#类型选择" class="header-anchor">#</a> 类型选择</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">getTypeValue</span><span class="token punctuation">(</span>i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span> i<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Type: int, Value: %d\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token builtin">string</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Type: string, Value: %s\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Unknown type\n&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">getTypeValue</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>
    <span class="token function">getTypeValue</span><span class="token punctuation">(</span><span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">)</span>
    <span class="token function">getTypeValue</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="实现多个接口"><a href="#实现多个接口" class="header-anchor">#</a> 实现多个接口</h3> <p>类型或者结构体可以实现多个接口</p> <h3 id="接口的嵌套"><a href="#接口的嵌套" class="header-anchor">#</a> 接口的嵌套</h3> <p>虽然在 Go 中没有继承机制，但可以通过接口的嵌套实现类似功能。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// 定义一个简单的读取器接口</span>
<span class="token keyword">type</span> Reader <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义一个简单的写入器接口</span>
<span class="token keyword">type</span> Writer <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Write</span><span class="token punctuation">(</span>data <span class="token builtin">string</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定义一个复合接口，嵌套了Reader和Writer接口</span>
<span class="token keyword">type</span> ReadWriter <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    Reader
    Writer
<span class="token punctuation">}</span>

<span class="token comment">// 实现Reader接口</span>
<span class="token keyword">type</span> MyReader <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>r MyReader<span class="token punctuation">)</span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Data read from MyReader&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实现Writer接口</span>
<span class="token keyword">type</span> MyWriter <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>w MyWriter<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>data <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Writing data:&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 实现ReadWriter接口</span>
<span class="token keyword">type</span> MyReadWriter <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    MyReader
    MyWriter
<span class="token punctuation">}</span>

<span class="token comment">// 使用ReadWriter接口作为参数进行函数调用</span>
<span class="token keyword">func</span> <span class="token function">ProcessData</span><span class="token punctuation">(</span>rw ReadWriter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">:=</span> rw<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    rw<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>data <span class="token operator">+</span> <span class="token string">&quot; modified&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建MyReadWriter实例</span>
    myRW <span class="token operator">:=</span> MyReadWriter<span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">// 调用ProcessData函数，传入myRW作为参数</span>
    <span class="token function">ProcessData</span><span class="token punctuation">(</span>myRW<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>定义了三个接口：<code>Reader</code>、<code>Writer</code>和<code>ReadWriter</code>。然后，我们实现了这些接口的具体类型：<code>MyReader</code>、<code>MyWriter</code>和<code>MyReadWriter</code>。</p> <p><code>MyReadWriter</code>结构体通过嵌套<code>MyReader</code>和<code>MyWriter</code>，同时实现了<code>Reader</code>和<code>Writer</code>接口。这样，<code>MyReadWriter</code>可以以<code>ReadWriter</code>类型的方式使用。</p> <p>在<code>main</code>函数中，我们创建了一个<code>MyReadWriter</code>实例<code>myRW</code>，然后将其作为参数传递给<code>ProcessData</code>函数。<code>ProcessData</code>函数接收一个<code>ReadWriter</code>类型的参数，并调用其中的方法。</p> <p>通过接口嵌套，我们可以更灵活地组织和复用代码</p> <h2 id="包"><a href="#包" class="header-anchor">#</a> 包</h2> <p><strong>包(package)</strong> 用于组织 Go 源代码，提供了更好的可重用性与可读性.可以用 <code>go list std</code>命令查看标准包,标准库为大多数的程序提供了必要的基础组件。</p> <h3 id="创建包"><a href="#创建包" class="header-anchor">#</a> 创建包</h3> <p>先创建一个 <code>book</code> 文件夹，位于该目录下创建一个 <code>book.go</code> 源文件，里面实现自定义的数学加法函数。函数名的首字母要大写。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Package book</span>
<span class="token keyword">package</span> book

<span class="token keyword">func</span> <span class="token function">ShowBookInfo</span><span class="token punctuation">(</span>bookName<span class="token punctuation">,</span> authorName <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> bookName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;图书名称为空&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> authorName <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;作者名称为空&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> bookName <span class="token operator">+</span> <span class="token string">&quot;,作者:&quot;</span> <span class="token operator">+</span> authorName<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="导入包"><a href="#导入包" class="header-anchor">#</a> 导入包</h3> <p>使用包之前我们需要导入包，在 GoLand 中会帮你自动导入所需要的包。导入包的语法为 <code>import path</code> ，其中 <code>path</code> 可以是相对于工作区文件夹的相对路径，也可以是绝对路径。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;learn/book&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	bookName <span class="token operator">:=</span> <span class="token string">&quot;《Go语言》&quot;</span>
	author <span class="token operator">:=</span> <span class="token string">&quot;Golang&quot;</span>
	bookInfo<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> book<span class="token punctuation">.</span><span class="token function">ShowBookInfo</span><span class="token punctuation">(</span>bookName<span class="token punctuation">,</span> author<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;bookInfo = &quot;</span><span class="token punctuation">,</span> bookInfo<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="使用别名"><a href="#使用别名" class="header-anchor">#</a> 使用别名</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;crypto/rand&quot;</span>
    mrand <span class="token string">&quot;math/rand&quot;</span> <span class="token comment">// 将名称替换为 mrand 避免冲突</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="使用点操作"><a href="#使用点操作" class="header-anchor">#</a> 使用点操作</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">.</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;hello, world&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>对于一些使用高频的包，例如 <code>fmt</code> 包，每次调用打印函数时都要使用 <code>fmt.Println()</code> 进行调用，很不方便。可以在导入包的时，使用 <code>import . package_path</code> 语法。打印就不用加 <code>fmt</code> 了。</p> <h3 id="包的初始化"><a href="#包的初始化" class="header-anchor">#</a> 包的初始化</h3> <p>每个包都允许有一个或多个 <code>init</code> 函数， <code>init</code> 函数不应该有任何返回值类型和参数，在代码中也不能显式调用它，当这个包被导入时，就会执行这个包的 <code>init</code> 函数，做初始化任务， <code>init</code> 函数优先于 <code>main</code> 函数执行。该函数形式如下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>包的初始化顺序：首先初始化 <strong>包级别(Package Level)</strong> 的变量，紧接着调用 <code>init</code> 函数。包可以有多个 <code>init</code> 函数(在一个文件或分布于多个文件中)，它们按照编译器解析它们的顺序进行调用。如果一个包导入了另一个包，会先初始化被导入的包。尽管一个包可能会被导入多次，但是它只会被初始化一次。</p> <h3 id="包的匿名导入"><a href="#包的匿名导入" class="header-anchor">#</a> 包的匿名导入</h3> <p>导入一个没有使用的包编译会报错。但有时候我们只是想执行包里的 <code>init</code> 函数来执行一些初始化任务，可以使用匿名导入的方法，使用 <strong>空白标识符(Blank Identifier)</strong> ：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token boolean">_</span> <span class="token string">&quot;fmt&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="协程"><a href="#协程" class="header-anchor">#</a> 协程</h2> <p><strong>Go 语言的 协程(Groutine)</strong> 是与其他函数或方法一起并发运行的工作方式。协程可以看作是轻量级线程。与线程相比，创建一个协程的成本很小。因此在 Go 应用中，常常会看到会有很多协程并发地运行。</p> <h3 id="启动一个-go-协程"><a href="#启动一个-go-协程" class="header-anchor">#</a> 启动一个 go 协程</h3> <p>调用函数或者方法时，如果在前面加上关键字 <code>go</code> ，就可以让一个新的 Go 协程并发地运行。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 定义一个函数</span>
<span class="token keyword">func</span> <span class="token function">functionName</span><span class="token punctuation">(</span>parameterList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    code
<span class="token punctuation">}</span>

<span class="token comment">// 执行一个函数</span>
<span class="token function">functionName</span><span class="token punctuation">(</span>parameterList<span class="token punctuation">)</span>

<span class="token comment">// 开启一个协程执行这个函数</span>
<span class="token keyword">go</span> <span class="token function">functionName</span><span class="token punctuation">(</span>parameterList<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
 <span class="token string">&quot;fmt&quot;</span>
 <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token comment">// 开启一个协程执行 PrintInfo 函数</span>
 <span class="token keyword">go</span> <span class="token function">PrintInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token comment">// 使主协程休眠 1 秒</span>
 time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
 <span class="token comment">// 打印 main</span>
 fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><code>PrintInfo()</code> 函数与 <code>main()</code> 函数会并发执行，主函数运行在一个特殊的协程上，这个协程称之为 <strong>主协程(Main Goroutine)</strong> 。</p> <p>启动一个新的协程时，协程的调用会立即返回。与函数不同，程序控制不会去等待 Go 协程执行完毕。在调用 Go 协程之后，程序控制会立即返回到代码的下一行，忽略该协程的任何返回值。如果 Go 主协程终止，则程序终止，于是其他 Go 协程也会终止。为了让新的协程能继续运行，在 <code>main()</code> 函数添加了 <code>time.Sleep(1 * time.Second)</code> 使主协程休眠 1 秒</p> <h3 id="启动多个-go-协程"><a href="#启动多个-go-协程" class="header-anchor">#</a> 启动多个 Go 协程</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">PrintNum</span><span class="token punctuation">(</span>num <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
		<span class="token comment">// 避免观察不到并发效果 加个休眠</span>
		time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 开启 1 号协程</span>
	<span class="token keyword">go</span> <span class="token function">PrintNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token comment">// 开启 2 号协程</span>
	<span class="token keyword">go</span> <span class="token function">PrintNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token comment">// 使主协程休眠 1 秒</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="通道"><a href="#通道" class="header-anchor">#</a> 通道</h2> <p><strong>通道(channel)</strong> ，就是一个管道，可以想像成 Go 协程之间通信的管道。它是一种队列式的数据结构，遵循先入先出的规则。</p> <h3 id="通道的声明"><a href="#通道的声明" class="header-anchor">#</a> 通道的声明</h3> <p>每个通道都只能传递一种数据类型的数据，在你声明的时候，我们要指定通道的类型。<code>chan Type</code> 表示 <code>Type</code> 类型的通道。通道的零值为 <code>nil</code> 。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> channel_name <span class="token keyword">chan</span> channel_types

<span class="token keyword">var</span> ch <span class="token keyword">chan</span> <span class="token builtin">string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="通道的初始化"><a href="#通道的初始化" class="header-anchor">#</a> 通道的初始化</h3> <p>声明完通道后，通道的值为 <code>nil</code> ，我们不能直接使用，必须先使用 <code>make</code> 函数对通道进行初始化操作。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>ch <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> channel_type<span class="token punctuation">)</span>

ch <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样，我们就已经定义好了一个 <code>string</code> 类型的通道 <code>nameChan</code> 。当然，也可以使用简短声明语句一次性定义一个通道：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="使用通道发送和接收数据"><a href="#使用通道发送和接收数据" class="header-anchor">#</a> 使用通道发送和接收数据</h3> <p>发送数据：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 把 data 数据发送到 channel_name 通道中</span>
<span class="token comment">// 即把 data 数据写入到 channel_name 通道中</span>
channel_name <span class="token operator">&lt;-</span> data
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>接收数据：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// 从 channel_name 通道中接收数据到 value</span>
<span class="token comment">// 即从 channel_name 通道中读取数据到 value</span>
value <span class="token operator">:=</span> <span class="token operator">&lt;-</span> channel_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>通道旁的箭头方向指定了是发送数据还是接收数据。箭头指向通道，代表数据写入到通道中；箭头往通道指向外，代表从通道读数据出去。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">PrintChan</span><span class="token punctuation">(</span>c <span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 往通道传入数据 </span>
	c <span class="token operator">&lt;-</span> <span class="token string">&quot;学习Go语言&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建一个通道</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
	<span class="token comment">// 打印 &quot;学习课程:&quot;</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;学习课程:&quot;</span><span class="token punctuation">)</span>
	<span class="token comment">// 开启协程</span>
	<span class="token keyword">go</span> <span class="token function">PrintChan</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span>
	<span class="token comment">// 从通道接收数据</span>
	rec <span class="token operator">:=</span> <span class="token operator">&lt;-</span> ch
	<span class="token comment">// 打印从通道接收到的数据</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>Tips</strong>: <strong>发送与接收默认是阻塞的</strong></p> <ul><li>从上面的例子我们知道，如果从通道接收数据没接收完主协程是不会继续执行下去的。当把数据发送到通道时，会在发送数据的语句处发生阻塞，直到有其它协程从通道读取到数据，才会解除阻塞。与此类似，当读取通道的数据时，如果没有其它的协程把数据写入到这个通道，那么读取过程就会一直阻塞着。</li></ul> <h3 id="通道的关闭"><a href="#通道的关闭" class="header-anchor">#</a> 通道的关闭</h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token function">close</span><span class="token punctuation">(</span>channel_name<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里要注意，对于一个已经关闭的通道如果再次关闭会导致报错，我们可以在接收数据时，判断通道是否已经关闭，从通道读取数据返回的第二个值表示通道是否没被关闭，如果已经关闭，返回值为 <code>false</code> ；如果还未关闭，返回值为 <code>true</code> 。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>value<span class="token punctuation">,</span> ok <span class="token operator">:=</span> <span class="token operator">&lt;-</span> channel_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="通道的容量与长度"><a href="#通道的容量与长度" class="header-anchor">#</a> 通道的容量与长度</h3> <p><code>make</code> 函数是可以接收两个参数的，同理，创建通道可以传入第二个参数——容量。</p> <ul><li>当容量为 <code>0</code> 时，说明通道中不能存放数据，在发送数据时，必须要求立马有人接收，否则会报错。此时的通道称之为无缓冲通道。</li> <li>当容量为 <code>1</code> 时，说明通道只能缓存一个数据，若通道中已有一个数据，此时再往里发送数据，会造成程序阻塞。利用这点可以利用通道来做锁。</li> <li>当容量大于 <code>1</code> 时，通道中可以存放多个数据，可以用于多个协程之间的通信管道，共享资源。</li></ul> <p>既然通道有容量和长度，那么我们可以通过 <code>cap</code> 函数和 <code>len</code> 函数获取通道的容量和长度。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建一个通道</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;初始化后：&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;cap =&quot;</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;len =&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
	c <span class="token operator">&lt;-</span> <span class="token number">1</span>
	c <span class="token operator">&lt;-</span> <span class="token number">2</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;传入两个数后：&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;cap =&quot;</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;len =&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token operator">&lt;-</span> c
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;取出一个数后：&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;cap =&quot;</span><span class="token punctuation">,</span> <span class="token function">cap</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;len =&quot;</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="缓冲通道与无缓冲通道"><a href="#缓冲通道与无缓冲通道" class="header-anchor">#</a> 缓冲通道与无缓冲通道</h3> <p>按照是否可缓冲数据可分为：<strong>缓冲通道</strong> 与 <strong>无缓冲通道</strong> 。</p> <p>无缓冲通道在通道里无法存储数据，接收端必须先于发送端准备好，以确保你发送完数据后，有人立马接收数据，否则发送端就会造成阻塞，原因很简单，通道中无法存储数据。也就是说发送端和接收端是同步运行的。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token comment">// 或者</span>
c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>缓冲通道允许通道里存储一个或多个数据，设置缓冲区后，发送端和接收端可以处于异步的状态。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code>c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="双向通道"><a href="#双向通道" class="header-anchor">#</a> 双向通道</h3> <p>到目前为止，上面定义的都是双向通道，既可以发送数据也可以接收数据。例如：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建一个通道</span>
	c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span>

	<span class="token comment">// 发送数据</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;send: 1&quot;</span><span class="token punctuation">)</span>
		c <span class="token operator">&lt;-</span> <span class="token number">1</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// 接收数据</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		n <span class="token operator">:=</span> <span class="token operator">&lt;-</span> c
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;receive:&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// 主协程休眠</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="单向通道"><a href="#单向通道" class="header-anchor">#</a> 单向通道</h3> <p>单向通道只能发送或者接收数据。所以可以具体细分为只读通道和只写通道。</p> <p><code>&lt;-chan</code> 表示只读通道：</p> <p><code>chan&lt;-</code> 表示只写通道：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Sender 只写通道类型</span>
<span class="token keyword">type</span> Sender <span class="token operator">=</span> <span class="token keyword">chan</span><span class="token operator">&lt;-</span> <span class="token builtin">string</span>

<span class="token comment">// Receiver 只读通道类型</span>
<span class="token keyword">type</span> Receiver <span class="token operator">=</span> <span class="token operator">&lt;-</span><span class="token keyword">chan</span> <span class="token builtin">string</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建一个双向通道</span>
	<span class="token keyword">var</span> ch <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>

	<span class="token comment">// 开启一个协程</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 只能写通道</span>
		<span class="token keyword">var</span> sender Sender <span class="token operator">=</span> ch
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;即将学习:&quot;</span><span class="token punctuation">)</span>
		sender <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	<span class="token comment">// 开启一个协程</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 只能读通道</span>
		<span class="token keyword">var</span> receiver Receiver <span class="token operator">=</span> ch
		message <span class="token operator">:=</span> <span class="token operator">&lt;-</span>receiver
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;开始学习: &quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="遍历通道"><a href="#遍历通道" class="header-anchor">#</a> 遍历通道</h3> <p>使用 <code>for range</code> 循环可以遍历通道，但在遍历时要确保通道是处于关闭状态，否则循环会被阻塞。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
   <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">loopPrint</span><span class="token punctuation">(</span>c <span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
      c <span class="token operator">&lt;-</span> i
   <span class="token punctuation">}</span>
   <span class="token comment">// 记得要关闭通道</span>
   <span class="token comment">// 否则主协程遍历完不会结束，而会阻塞</span>
   <span class="token function">close</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// 创建一个通道</span>
   <span class="token keyword">var</span> ch2 <span class="token operator">=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
   <span class="token keyword">go</span> <span class="token function">loopPrint</span><span class="token punctuation">(</span>ch2<span class="token punctuation">)</span>
   <span class="token keyword">for</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> ch2 <span class="token punctuation">{</span>
      fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="用通道做锁"><a href="#用通道做锁" class="header-anchor">#</a> 用通道做锁</h3> <p>上面讲过，当通道容量为 <code>1</code> 时，说明通道只能缓存一个数据，若通道中已有一个数据，此时再往里发送数据，会造成程序阻塞。例如：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// 由于 x = x+1 不是原子操作</span>
<span class="token comment">// 所以应避免多个协程对 x 进行操作</span>
<span class="token comment">// 使用容量为 1 的通道可以达到锁的效果</span>
<span class="token keyword">func</span> <span class="token function">increment</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">,</span> x <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
	<span class="token operator">*</span>x <span class="token operator">=</span> <span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">1</span>
	<span class="token operator">&lt;-</span> ch
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token keyword">var</span> x <span class="token builtin">int</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">go</span> <span class="token function">increment</span><span class="token punctuation">(</span>ch3<span class="token punctuation">,</span> <span class="token operator">&amp;</span>x<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;x =&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="死锁"><a href="#死锁" class="header-anchor">#</a> 死锁</h3> <p>当协程给一个通道发送数据时，照理说会有其他 Go 协程来接收数据。如果没有的话，程序就会在运行时触发 <code>panic</code> ，形成死锁。同理，当有协程等着从一个通道接收数据时，我们期望其他的 Go 协程会向该通道写入数据，要不然程序也会触发 <code>panic</code> 。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	ch <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
<span class="token comment">//fatal error: all goroutines are asleep - deadlock!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	ch <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&lt;-</span>ch<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//fatal error: all goroutines are asleep - deadlock!</span>
<span class="token comment">//使用 make 函数创建通道时默认不传递第二个参数，通道中不能存放数据，在发送数据时，必须要求立马有人接收，即该通道为无缓冲通道。所以在接收者没有准备好前，发送操作会被阻塞。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">funcRecieve</span><span class="token punctuation">(</span>c <span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&lt;-</span>c<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch4 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">funcRecieve</span><span class="token punctuation">(</span>ch4<span class="token punctuation">)</span>
	ch4 <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Millisecond<span class="token punctuation">)</span>
<span class="token punctuation">}</span>


<span class="token comment">// 或</span>

<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	ch6 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
	ch6 <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
	ch6 <span class="token operator">&lt;-</span> <span class="token boolean">false</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">&lt;-</span>ch6<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="waitgroup"><a href="#waitgroup" class="header-anchor">#</a> WaitGroup</h3> <p>在实际开发中我们并不能保证每个协程执行的时间，如果需要等待多个协程，全部结束任务后，再执行某个业务逻辑。下面我们介绍处理这种情况的方式。</p> <p><code>WaitGroup</code> 有几个方法：</p> <ul><li><code>Add</code>：初始值为 <code>0</code> ，这里直接传入子协程的数量，你传入的值会往计数器上加。</li> <li><code>Done</code>：当某个子协程完成后，可调用此方法，会从计数器上减一，即子协程的数量减一，通常使用 <code>defer</code> 来调用。</li> <li><code>Wait</code>：阻塞当前协程，直到实例里的计数器归零。</li></ul> <h4 id="使用信道"><a href="#使用信道" class="header-anchor">#</a> 使用信道</h4> <p>信道可以实现多个协程间的通信，于是乎我们可以定义一个信道，在任务执行完成后，往信道中写入 <code>true</code> ，然后在主协程中获取到 <code>true</code> ，就可以认为子协程已经执行完毕。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	isDone <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">{</span>
			fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		isDone <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token operator">&lt;-</span> isDone
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>运行上面的程序，主协程就会等待创建的协程执行完毕后退出。</p> <h4 id="使用-waitgroup"><a href="#使用-waitgroup" class="header-anchor">#</a> 使用 WaitGroup</h4> <p>使用上面的信道方法，虽然可行，但在你程序中使用很多协程的话，你的代码就会看起来很复杂，这里就要介绍一种更好的方法，那就是使用 <code>sync</code> 包中提供的 <strong>WaitGroup</strong> 类型。<code>WaitGroup</code> 用于等待一批 Go 协程执行结束。程序控制会一直阻塞，直到这些协程全部执行完毕。当然 <code>WaitGroup</code> 也可以用于实现工作池。</p> <p><code>WaitGroup</code> 实例化后就能使用：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> name sync<span class="token punctuation">.</span>WaitGroup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;sync&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">task</span><span class="token punctuation">(</span>taskNum <span class="token builtin">int</span><span class="token punctuation">,</span> wg <span class="token operator">*</span>sync<span class="token punctuation">.</span>WaitGroup<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 延迟调用 执行完子协程计数器减一</span>
	<span class="token keyword">defer</span> wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token comment">// 输出任务号</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;task %d: %d\n&quot;</span><span class="token punctuation">,</span> taskNum<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 实例化 sync.WaitGroup</span>
	<span class="token keyword">var</span> waitGroup sync<span class="token punctuation">.</span>WaitGroup
	<span class="token comment">// 传入子协程的数量</span>
	waitGroup<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
	<span class="token comment">// 开启一个子协程 协程 1 以及 实例 waitGroup</span>
	<span class="token keyword">go</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>waitGroup<span class="token punctuation">)</span>
	<span class="token comment">// 开启一个子协程 协程 2 以及 实例 waitGroup</span>
	<span class="token keyword">go</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>waitGroup<span class="token punctuation">)</span>
	<span class="token comment">// 开启一个子协程 协程 3 以及 实例 waitGroup</span>
	<span class="token keyword">go</span> <span class="token function">task</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>waitGroup<span class="token punctuation">)</span>
	<span class="token comment">// 实例 waitGroup 阻塞当前协程 等待所有子协程执行完</span>
	waitGroup<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h2 id="select"><a href="#select" class="header-anchor">#</a> Select</h2> <p><strong>select</strong> 语句用在多个发送/接收通道操作中进行选择。</p> <ul><li><code>select</code> 语句会一直阻塞，直到发送/接收操作准备就绪。</li> <li>如果有多个通道操作准备完毕， <code>select</code> 会随机地选取其中之一执行。</li></ul> <p><code>select</code> 语法如下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> expression1<span class="token punctuation">:</span>
        code
    <span class="token keyword">case</span> expression2<span class="token punctuation">:</span>
        code
    <span class="token keyword">default</span><span class="token punctuation">:</span>
        code
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建3个通道</span>
    ch1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    ch2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    ch3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">// 往通道 1 发送数据 </span>
    ch1 <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言1&quot;</span>
    <span class="token comment">// 往通道 2 发送数据 </span>
    ch2 <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言2&quot;</span>
    <span class="token comment">// 往通道 3 发送数据 </span>
    ch3 <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言3&quot;</span>

    <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果从通道 1 收到数据</span>
    <span class="token keyword">case</span> message1 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch1<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch1 received:&quot;</span><span class="token punctuation">,</span> message1<span class="token punctuation">)</span>
    <span class="token comment">// 如果从通道 2 收到数据</span>
    <span class="token keyword">case</span> message2 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch2<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch2 received:&quot;</span><span class="token punctuation">,</span> message2<span class="token punctuation">)</span>
    <span class="token comment">// 如果从通道 3 收到数据</span>
    <span class="token keyword">case</span> message3 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch3<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch3 received:&quot;</span><span class="token punctuation">,</span> message3<span class="token punctuation">)</span>
    <span class="token comment">// 默认输出</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;No data received.&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>在执行 <code>select</code> 语句时，如果有机会的话会运行所有表达式，只要其中一个通道接收到数据，那么就会执行对应的 <code>case</code> 代码，然后退出。</p> <h3 id="select-的应用"><a href="#select-的应用" class="header-anchor">#</a> select 的应用</h3> <p>每个任务执行的时间不同，使用 <code>select</code> 语句等待相应的通道发出响应。<code>select</code> 会选择首先响应先完成的 task，而忽略其它的响应。使用这种方法，我们可以做多个 task，并给用户返回最快的 task 结果。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">task1</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	ch <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言1&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">task2</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">7</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	ch <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言2&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">task3</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span>
	ch <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言3&quot;</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 创建三个通道</span>
	ch1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
	ch2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
	ch3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">task1</span><span class="token punctuation">(</span>ch1<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">task2</span><span class="token punctuation">(</span>ch2<span class="token punctuation">)</span>
	<span class="token keyword">go</span> <span class="token function">task3</span><span class="token punctuation">(</span>ch3<span class="token punctuation">)</span>

	<span class="token keyword">select</span> <span class="token punctuation">{</span>
	<span class="token comment">// 如果从通道 1 收到数据</span>
	<span class="token keyword">case</span> message1 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch1<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch1 received:&quot;</span><span class="token punctuation">,</span> message1<span class="token punctuation">)</span>
	<span class="token comment">// 如果从通道 2 收到数据</span>
	<span class="token keyword">case</span> message2 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch2<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch2 received:&quot;</span><span class="token punctuation">,</span> message2<span class="token punctuation">)</span>
	<span class="token comment">// 如果从通道 3 收到数据</span>
	<span class="token keyword">case</span> message3 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch3<span class="token punctuation">:</span>
		fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch3 received:&quot;</span><span class="token punctuation">,</span> message3<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>上面的程序会发现，没有 <code>default</code> 分支，因为如果加了该默认分支，如果还没从通道接收到数据， <code>select</code> 语句就会直接执行 <code>default</code> 分支然后退出，而不是被阻塞。</p> <h3 id="造成死锁"><a href="#造成死锁" class="header-anchor">#</a> 造成死锁</h3> <p>如果没有 <code>default</code> 分支， <code>select</code> 就会阻塞，如果一直没有命中其中的某个 <code>case</code> 最后会造成死锁。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建两个通道</span>
    ch1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    ch2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    ch3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果从通道 1 收到数据</span>
    <span class="token keyword">case</span> message1 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch1<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch1 received:&quot;</span><span class="token punctuation">,</span> message1<span class="token punctuation">)</span>
    <span class="token comment">// 如果从通道 2 收到数据</span>
    <span class="token keyword">case</span> message2 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch2<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch2 received:&quot;</span><span class="token punctuation">,</span> message2<span class="token punctuation">)</span>
	<span class="token comment">// 如果从通道 3 收到数据</span>
    <span class="token keyword">case</span> message3 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>ch3<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ch3 received:&quot;</span><span class="token punctuation">,</span> message3<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//fatal error: all goroutines are asleep - deadlock!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>运行上面的程序会造成死锁。解决该问题的方法是写好 <code>default</code> 分支。</p> <p>还有另一种情况会导致死锁的发生，那就是使用空 <code>select</code> ：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">select</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>运行上面的程序会抛出 <code>panic</code> 。</p> <p><strong>Tips：</strong></p> <ul><li><code>switch-case</code> 里面的 <code>case</code> 是顺序执行的，但在 <code>select</code> 里并不是顺序执行的。在上面的第一个例子就可以看出，当 <code>select</code> 由多个 <code>case</code> 准备就绪时，将会随机地选取其中之一去执行。</li></ul> <h3 id="select超时处理"><a href="#select超时处理" class="header-anchor">#</a> select超时处理</h3> <p>当 <code>case</code> 里的通道始终没有接收到数据时，而且也没有 <code>default</code> 语句时， <code>select</code> 整体就会阻塞，但是有时我们并不希望 <code>select</code> 一直阻塞下去，这时候就可以手动设置一个超时时间。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">makeTimeout</span><span class="token punctuation">(</span>ch <span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">,</span> t <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    time<span class="token punctuation">.</span><span class="token function">Sleep</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>Second <span class="token operator">*</span> time<span class="token punctuation">.</span><span class="token function">Duration</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ch <span class="token operator">&lt;-</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    c1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    c2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    c3 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    timeout <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">bool</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token keyword">go</span> <span class="token function">makeTimeout</span><span class="token punctuation">(</span>timeout<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> msg1 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c1<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;c1 received: &quot;</span><span class="token punctuation">,</span> msg1<span class="token punctuation">)</span>
    <span class="token keyword">case</span> msg2 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c2<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;c2 received: &quot;</span><span class="token punctuation">,</span> msg2<span class="token punctuation">)</span>
    <span class="token keyword">case</span> msg3 <span class="token operator">:=</span> <span class="token operator">&lt;-</span>c3<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;c3 received: &quot;</span><span class="token punctuation">,</span> msg3<span class="token punctuation">)</span>
    <span class="token keyword">case</span> <span class="token operator">&lt;-</span>timeout<span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Timeout, exit.&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="读取-写入数据"><a href="#读取-写入数据" class="header-anchor">#</a> 读取/写入数据</h3> <p><code>select</code> 里的 <code>case</code> 表达式只能对通道进行操作，不管你是往通道写入数据，还是从通道读出数据。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    c1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

    c1 <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言1&quot;</span>
    <span class="token keyword">select</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> c1 <span class="token operator">&lt;-</span> <span class="token string">&quot;Go语言2&quot;</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;c1 received: &quot;</span><span class="token punctuation">,</span> <span class="token operator">&lt;-</span>c1<span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;c1 received: &quot;</span><span class="token punctuation">,</span> <span class="token operator">&lt;-</span>c1<span class="token punctuation">)</span>
    <span class="token keyword">default</span><span class="token punctuation">:</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;channel blocking&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//c1 received:  Go语言1</span>
<span class="token comment">//c1 received:  Go语言2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="线程同步"><a href="#线程同步" class="header-anchor">#</a> 线程同步</h2> <p>Go 语言中，经常会遇到并发的问题，当然我们会优先考虑使用通道，同时 Go 语言也给出了传统的解决方式 <strong>Mutex(互斥锁)</strong> 和 <strong>RWMutex(读写锁)</strong> 来处理竞争条件。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Bank <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    balance <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Bank<span class="token punctuation">)</span> <span class="token function">Deposit</span><span class="token punctuation">(</span>amount <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span>balance <span class="token operator">+=</span> amount
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Bank<span class="token punctuation">)</span> <span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span>balance
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b <span class="token operator">:=</span> <span class="token operator">&amp;</span>Bank<span class="token punctuation">{</span><span class="token punctuation">}</span>

    b<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
    b<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
    b<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>

    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//3000</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="临界区"><a href="#临界区" class="header-anchor">#</a> 临界区</h3> <p>当程序并发地运行时，多个 Go 协程不应该同时访问那些修改共享资源的代码。这些修改共享资源的代码称为<strong>临界区</strong> 。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
	<span class="token string">&quot;sync&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> Bank <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	balance <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Bank<span class="token punctuation">)</span> <span class="token function">Deposit</span><span class="token punctuation">(</span>amount <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	b<span class="token punctuation">.</span>balance <span class="token operator">+=</span> amount
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>Bank<span class="token punctuation">)</span> <span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> b<span class="token punctuation">.</span>balance
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> wg sync<span class="token punctuation">.</span>WaitGroup
	b <span class="token operator">:=</span> <span class="token operator">&amp;</span>Bank<span class="token punctuation">{</span><span class="token punctuation">}</span>

	n <span class="token operator">:=</span> <span class="token number">1000</span>
	wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
		<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			b<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
			wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	wg<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//972000,962000,941000</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>举一个简单的例子，当前变量的值增加 <code>b.balance += amount</code></p> <p>当然，对于只有一个协程的程序来说，上面的代码没有任何问题。但是，如果有多个协程并发运行时，就会发生错误，这种情况就称之为数据竞争(data race)。使用下面的互斥锁 <code>Mutex</code> 就能避免这种情况的发生。</p> <h3 id="互斥锁-mutex"><a href="#互斥锁-mutex" class="header-anchor">#</a> 互斥锁 Mutex</h3> <p><strong>互斥锁(Mutex，mutual exclusion)</strong> 用于提供一种 <strong>加锁机制(Locking Mechanism)</strong> ，可确保在某时刻只有一个协程在临界区运行，以防止出现竞争。也是为了来保护一个资源不会因为并发操作而引起冲突导致数据不准确。</p> <p><code>Mutex</code> 有两个方法，分别是 <code>Lock()</code> 和 <code>Unlock()</code> ，即对应的加锁和解锁。在 <code>Lock()</code> 和 <code>Unlock()</code> 之间的代码，都只能由一个协程执行，就能避免竞争条件。</p> <p>如果有一个协程已经持有了<strong>锁(Lock)</strong>，当其他协程试图获得该锁时，这些协程会被阻塞，直到<code>Mutex</code>解除锁定。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;sync&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> BankV2 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    balance <span class="token builtin">int</span>
    m       sync<span class="token punctuation">.</span>Mutex
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>BankV2<span class="token punctuation">)</span> <span class="token function">Deposit</span><span class="token punctuation">(</span>amount <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    b<span class="token punctuation">.</span>balance <span class="token operator">+=</span> amount
    b<span class="token punctuation">.</span>m<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>BankV2<span class="token punctuation">)</span> <span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> b<span class="token punctuation">.</span>balance
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> wg sync<span class="token punctuation">.</span>WaitGroup
    b <span class="token operator">:=</span> <span class="token operator">&amp;</span>BankV2<span class="token punctuation">{</span><span class="token punctuation">}</span>

    n <span class="token operator">:=</span> <span class="token number">1000</span>
    wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            b<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
            wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    wg<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//1000000</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>要注意同一协程里不要在尚未解锁时再次加锁，也不要对已经解锁的锁再次解锁。</p> <h3 id="读写锁-rwmutex"><a href="#读写锁-rwmutex" class="header-anchor">#</a> 读写锁 RWMutex</h3> <p><code>sync.RWMutex</code> 类型实现读写互斥锁，适用于读多写少的场景，它规定了当有人还在读取数据（即读锁占用）时，不允许有人更新这个数据（即写锁会阻塞）；为了保证程序的效率，多个人（协程）读取数据（拥有读锁）时，互不影响不会造成阻塞，它不会像 <code>Mutex</code> 那样只允许有一个人（协程）读取同一个数据。读锁与读锁兼容，读锁与写锁互斥，写锁与写锁互斥。</p> <ul><li>可以同时申请多个读锁；</li> <li>有读锁时申请写锁将阻塞，有写锁时申请读锁将阻塞；</li> <li>只要有写锁，后续申请读锁和写锁都将阻塞。</li></ul> <p>定义一个 <code>RWMuteux</code> 读写锁：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> rwMutex sync<span class="token punctuation">.</span>RWMutex
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>RWMutex</code> 里提供了两种锁，每种锁分别对应两个方法，为了避免死锁，两个方法应成对出现，必要时请使用 <code>defer</code> 。</p> <ul><li>读锁：调用 <code>RLock</code> 方法开启锁，调用 <code>RUnlock</code> 释放锁；</li> <li>写锁：调用 <code>Lock</code> 方法开启锁，调用 <code>Unlock</code> 释放锁。</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;sync&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> BankV3 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    balance <span class="token builtin">int</span>
    rwMutex sync<span class="token punctuation">.</span>RWMutex <span class="token comment">// read write lock</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>BankV3<span class="token punctuation">)</span> <span class="token function">Deposit</span><span class="token punctuation">(</span>amount <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span>rwMutex<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// write lock</span>
    b<span class="token punctuation">.</span>balance <span class="token operator">+=</span> amount
    b<span class="token punctuation">.</span>rwMutex<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// wirte unlock</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>b <span class="token operator">*</span>BankV3<span class="token punctuation">)</span> <span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>balance <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    b<span class="token punctuation">.</span>rwMutex<span class="token punctuation">.</span><span class="token function">RLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// read lock</span>
    balance <span class="token operator">=</span> b<span class="token punctuation">.</span>balance
    b<span class="token punctuation">.</span>rwMutex<span class="token punctuation">.</span><span class="token function">RUnlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// read unlock</span>
    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> wg sync<span class="token punctuation">.</span>WaitGroup
    b <span class="token operator">:=</span> <span class="token operator">&amp;</span>BankV3<span class="token punctuation">{</span><span class="token punctuation">}</span>

    n <span class="token operator">:=</span> <span class="token number">1000</span>
    wg<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        <span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            b<span class="token punctuation">.</span><span class="token function">Deposit</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
            wg<span class="token punctuation">.</span><span class="token function">Done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    wg<span class="token punctuation">.</span><span class="token function">Wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span><span class="token function">Balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="条件变量-sync-cond"><a href="#条件变量-sync-cond" class="header-anchor">#</a> 条件变量 sync.Cond</h3> <p>Cond 实现了一个条件变量，在 Locker 的基础上增加的一个消息通知的功能，保存了一个通知列表，用来唤醒一个或所有因等待条件变量而阻塞的 Go 程，以此来实现多个 Go 程间的同步。</p> <h2 id="错误与异常"><a href="#错误与异常" class="header-anchor">#</a> 错误与异常</h2> <h3 id="错误"><a href="#错误" class="header-anchor">#</a> 错误</h3> <h4 id="内建错误"><a href="#内建错误" class="header-anchor">#</a> 内建错误</h4> <p>在 Go 中， <strong>错误</strong> 使用内建的 <code>error</code> 类型表示。<code>error</code> 类型是一个接口类型，它的定义如下：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> <span class="token builtin">error</span> <span class="token keyword">interface</span> <span class="token punctuation">{</span>
    <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>error</code> 有了一个签名为 <code>Error() string</code> 的方法。所有实现该接口的类型都可以当作一个错误类型。<code>Error()</code> 方法给出了错误的描述。<code>fmt.Println</code> 在打印错误时，会在内部调用 <code>Error() string</code> 方法来得到该错误的描述。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;os&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 尝试打开文件</span>
    file<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token string">&quot;/a.txt&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// 如果打开文件时发生错误 返回一个不等于 nil 的错误</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 如果打开文件成功 返回一个文件句柄 和 一个值为 nil 的错误</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;opened successfully&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// open /a.txt: no such file or directory</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="自定义错误"><a href="#自定义错误" class="header-anchor">#</a> 自定义错误</h4> <p>使用 <code>errors</code> 包中的 <code>New</code> 函数可以创建自定义错误。下面是 <code>errors</code> 包中 <code>New</code> 函数的实现代码：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> errors

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span>text <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>errorString<span class="token punctuation">{</span>text<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> errorString <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    s <span class="token builtin">string</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>errorString<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> e<span class="token punctuation">.</span>s
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>errorString</code> 是一个结构体类型，只有一个字符串字段 <code>s</code> 。它使用了 <code>errorString</code> 指针接受者，来实现 <code>error</code> 接口的 <code>Error() string</code> 方法。<code>New</code> 函数有一个字符串参数，通过这个参数创建了 <code>errorString</code> 类型的变量，并返回了它的地址。于是它就创建并返回了一个新的错误。</p> <p>下面是一个简单的自定义错误例子，该例子创建了一个计算矩形面积的函数，当矩形的长和宽两者有一个为负数时，就会返回一个错误：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;errors&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">area</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> a <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> b <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;计算错误, 长度或宽度，不能小于0.&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> <span class="token number">100</span>
    b <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">10</span>
    r<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">area</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Area =&quot;</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="给错误添加更多信息"><a href="#给错误添加更多信息" class="header-anchor">#</a> 给错误添加更多信息</h4> <p>上面的程序能报出我们自定义的错误，但是没有具体说明是哪个数据出了问题，所以下面就来改进一下这个程序，我们使用 <code>fmt</code> 包中的 <code>Errorf</code> 函数，规定错误格式，并返回一个符合该错误的字符串。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">area</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> a <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> b <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> fmt<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;计算错误, 长度%d或宽度%d，不能小于0&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> <span class="token number">100</span>
    b <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">10</span>
    area<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">area</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Area =&quot;</span><span class="token punctuation">,</span> area<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>给错误添加更多信息还可以 <strong>使用结构体类型和字段</strong> 实现。下面还是通过改进上面的程序来讲解这种方法的实现：</p> <p>首先创建一个表示错误的结构体类型，一般错误类型名称都是以 <code>Error</code> 结尾，上面的错误是由于面积计算中长度或宽度错误导致的，所以这里把结构体命名为 <code>areaError</code> ：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> areaError <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// 错误信息</span>
    err <span class="token builtin">string</span>
    <span class="token comment">// 错误有关的长度</span>
    length <span class="token builtin">int</span>
    <span class="token comment">// 错误有关的宽度</span>
    width <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用指针接收者 *areaError 实现了 error 接口的 Error() string 方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>areaError<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token comment">// 打印长度和宽度以及错误的描述</span>
    <span class="token keyword">return</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;length %d, width %d : %s&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>length<span class="token punctuation">,</span> e<span class="token punctuation">.</span>width<span class="token punctuation">,</span> e<span class="token punctuation">.</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">rectangleArea</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> a <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> b <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>areaError<span class="token punctuation">{</span><span class="token string">&quot;length or width is negative&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> <span class="token number">100</span>
    b <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">10</span>
    area<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">rectangleArea</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token comment">// 检查了错误是否为 nil</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">// 断言 *areaError 类型</span>
        <span class="token keyword">if</span> err<span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>areaError<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
            <span class="token comment">// 如果错误是 *areaError 类型</span>
            <span class="token comment">// 用 err.length 和 err.width 来获取错误的长度和宽度 打印出自定义错误的消息</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;length %d or width %d is less than zero&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>length<span class="token punctuation">,</span> err<span class="token punctuation">.</span>width<span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Area =&quot;</span><span class="token punctuation">,</span> area<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>还可以使用 <strong>结构体类型的方法</strong> 来给错误添加更多信息。下面我们继续完善上面的程序，让程序更加精确的定位是长度引发的错误还是宽度引发的错误。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">type</span> areaError <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    <span class="token comment">// 错误信息</span>
    err <span class="token builtin">string</span>
    <span class="token comment">// 长度</span>
    length <span class="token builtin">int</span>
    <span class="token comment">// 宽度</span>
    width <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用指针接收者 *areaError 实现了 error 接口的 Error() string 方法</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>areaError<span class="token punctuation">)</span> <span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> e<span class="token punctuation">.</span>err
<span class="token punctuation">}</span>

<span class="token comment">// 长度为负数返回 true</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>areaError<span class="token punctuation">)</span> <span class="token function">lengthNegative</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> e<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token comment">// 宽度为负数返回 true</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>areaError<span class="token punctuation">)</span> <span class="token function">widthNegative</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> e<span class="token punctuation">.</span>width <span class="token operator">&lt;</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">area</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> width <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    err <span class="token operator">:=</span> <span class="token string">&quot;&quot;</span>
    <span class="token keyword">if</span> length <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        err <span class="token operator">+=</span> <span class="token string">&quot;length is less than zero&quot;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> width <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> err <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
            err <span class="token operator">=</span> <span class="token string">&quot;width is less than zero&quot;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            err <span class="token operator">+=</span> <span class="token string">&quot; and width is less than zero&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>areaError<span class="token punctuation">{</span>err<span class="token punctuation">,</span> length<span class="token punctuation">,</span> width<span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> length <span class="token operator">*</span> width<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    length <span class="token operator">:=</span> <span class="token number">100</span>
    width <span class="token operator">:=</span> <span class="token operator">-</span><span class="token number">10</span>
    area<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">area</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> width<span class="token punctuation">)</span>
    <span class="token comment">// 检查了错误是否为 nil</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token comment">// 断言 *areaError 类型</span>
        <span class="token keyword">if</span> err<span class="token punctuation">,</span> ok <span class="token operator">:=</span> err<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>areaError<span class="token punctuation">)</span><span class="token punctuation">;</span> ok <span class="token punctuation">{</span>
            <span class="token comment">// 如果错误是 *areaError 类型</span>
            <span class="token comment">// 如果长度为负数 打印错误长度具体值</span>
            <span class="token keyword">if</span> err<span class="token punctuation">.</span><span class="token function">lengthNegative</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error: 长度 %d 小于0\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 如果宽度为负数 打印错误宽度具体值</span>
            <span class="token keyword">if</span> err<span class="token punctuation">.</span><span class="token function">widthNegative</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;error: 宽度 %d 小于0\n&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>width<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Area =&quot;</span><span class="token punctuation">,</span> area<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><h3 id="异常"><a href="#异常" class="header-anchor">#</a> 异常</h3> <p>错误和异常是两个不同的概念，非常容易混淆。错误指的是可能出现问题的地方出现了问题；而异常指的是不应该出现问题的地方出现了问题。</p> <h3 id="panic"><a href="#panic" class="header-anchor">#</a> panic</h3> <p>在有些情况，当程序发生异常时，无法继续运行。在这种情况下，我们会使用 <code>panic</code> 来终止程序。当函数发生 <code>panic</code> 时，它会终止运行，在执行完所有的延迟函数后，程序返回到该函数的调用方。这样的过程会一直持续下去，直到当前协程的所有函数都返回退出，然后程序会打印出 <code>panic</code> 信息，接着打印出堆栈跟踪，最后程序终止。</p> <p>我们应该尽可能地使用错误，而不是使用 <code>panic</code> 和 <code>recover</code> 。只有当程序不能继续运行的时候，才应该使用 <code>panic</code> 和 <code>recover</code> 机制。</p> <p><code>panic</code> 有两个合理的用例：</p> <ul><li>发生了一个不能恢复的错误，此时程序不能继续运行。一个例子就是 web 服务器无法绑定所要求的端口。在这种情况下，就应该使用 <code>panic</code> ，因为如果不能绑定端口，啥也做不了。</li> <li>发生了一个编程上的错误。假如我们有一个接收指针参数的方法，而其他人使用 <code>nil</code> 作为参数调用了它。在这种情况下，我们可以使用 <code>panic</code> ，因为这是一个编程错误：用 <code>nil</code> 参数调用了一个只能接收合法指针的方法。</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">panic</span><span class="token punctuation">(</span>v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;panic error&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="发生-panic-时的-defer"><a href="#发生-panic-时的-defer" class="header-anchor">#</a> 发生 panic 时的 defer</h4> <p>上面已经提到了，当函数发生 <code>panic</code> 时，它会终止运行，在执行完所有的延迟函数后，程序返回到该函数的调用方。这样的过程会一直持续下去，直到当前协程的所有函数都返回退出，然后程序会打印出 <code>panic</code> 信息，接着打印出堆栈跟踪，最后程序终止。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">myTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;defer myTest&quot;</span><span class="token punctuation">)</span>
    <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;panic myTest&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;defer main&quot;</span><span class="token punctuation">)</span>
    <span class="token function">myTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// defer myTest</span>
<span class="token comment">// defer main</span>
<span class="token comment">// panic: panic myTest</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="recover"><a href="#recover" class="header-anchor">#</a> recover</h4> <p><code>recover</code> 是一个内建函数，用于重新获得 <code>panic</code> 协程的控制。下面是内建函数 <code>recover</code> 的签名：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>recover</code> 必须在 <code>defer</code> 函数中才能生效，在其他作用域下，它是不工作的。在延迟函数内调用 <code>recover</code> ，可以取到 <code>panic</code> 的错误信息，并且停止 <code>panic</code> 续发事件，程序运行恢复正常。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">outOfArray</span><span class="token punctuation">(</span>x <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// recover() 可以将捕获到的 panic 信息打印</span>
        <span class="token keyword">if</span> err <span class="token operator">:=</span> <span class="token function">recover</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token builtin">int</span>
    array<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 故意制造数组越界 触发 panic</span>
    <span class="token function">outOfArray</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
    <span class="token comment">// 如果能执行到这句 说明 panic 被捕获了</span>
    <span class="token comment">// 后续的程序能继续运行</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main...&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// runtime error: index out of range [20] with length 5</span>
<span class="token comment">// main...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>虽然该程序触发了 <code>panic</code> ，但由于我们使用了 <code>recover()</code> 捕获了 <code>panic</code> 异常，并输出 <code>panic</code> 信息，即使 <code>panic</code> 会导致整个程序退出，但在退出前，有 <code>defer</code> 延迟函数，还是得执行完 <code>defer</code> 。然后程序还会继续执行下去</p> <p>只有在相同的协程中调用 <code>recover</code> 才管用， <code>recover</code> 不能恢复一个不同协程的 <code>panic</code>。</p> <h2 id="make-和-new"><a href="#make-和-new" class="header-anchor">#</a> make 和 new</h2> <h3 id="new函数"><a href="#new函数" class="header-anchor">#</a> new函数</h3> <p>内置函数 <code>new</code> 分配内存。该函数只接受一个参数，该参数是一个任意类型(包括自定义类型)，而不是值，返回指向该类型新分配零值的指针。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// The new built-in function allocates memory. The first argument is a type,</span>
<span class="token comment">// not a value, and the value returned is a pointer to a newly</span>
<span class="token comment">// allocated zero value of that type.</span>
<span class="token keyword">func</span> <span class="token function">new</span><span class="token punctuation">(</span>Type<span class="token punctuation">)</span> <span class="token operator">*</span>Type
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>使用 <code>new</code> 函数首先会分配内存，并设置类型零值，最后返回指向该类型新分配零值的指针。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	num <span class="token operator">:=</span> <span class="token function">new</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span>
	<span class="token comment">// 打印出类型的值</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token operator">*</span>num<span class="token punctuation">)</span>  <span class="token comment">// 0</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="make函数"><a href="#make函数" class="header-anchor">#</a> make函数</h3> <p>内置函数 <code>make</code> 只能分配和初始化类型为 <code>slice</code> 、 <code>map</code> 或 <code>chan</code> 的对象。与 <code>new</code> 一样，第一个参数是类型，而不是值。与 <code>new</code> 不同， <code>make</code> 的返回类型与其参数的类型相同，而不是指向它的指针。结果取决于类型：</p> <ul><li><code>slice</code>：size 指定长度。切片的容量等于其长度。可提供第三个参数以指定不同的容量；它不能小于长度。</li> <li><code>map</code>：为空映射分配足够的空间来容纳指定数量的元素。可以省略大小，在这种情况下，分配一个小的起始大小。</li> <li><code>chan</code>：使用指定的缓冲区容量初始化通道的缓冲区。如果为零，或者忽略了大小，则通道是无缓冲的。</li></ul> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">make</span><span class="token punctuation">(</span>t Type<span class="token punctuation">,</span> size <span class="token operator">...</span>IntegerType<span class="token punctuation">)</span> Type
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用make函数必须初始化</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// slice</span>
a <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>

<span class="token comment">// map</span>
b <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>

<span class="token comment">// chan</span>
c <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">chan</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="new-和-make-的区别"><a href="#new-和-make-的区别" class="header-anchor">#</a> new 和 make 的区别</h3> <p><code>new</code>：为所有的类型分配内存，并初始化为零值，返回指针。</p> <p><code>make</code>：只能为 <code>slice</code> 、 <code>map</code> 、 <code>chan</code> 分配内存，并初始化，返回的是类型。</p> <h2 id="反射"><a href="#反射" class="header-anchor">#</a> 反射</h2> <h3 id="reflect-包"><a href="#reflect-包" class="header-anchor">#</a> reflect 包</h3> <p>Go 语言提供了一种机制，能够在运行时更新变量和检查它们的值、调用它们的方法，而不需要在编译时就知道这些变量的具体类型。这种机制被称为 <strong>反射</strong> 。</p> <p>在 Go 中 <code>reflect</code> 包实现了运行时反射。<code>reflect</code> 包会帮助识别 <code>interface{}</code> 变量的底层具体类型和具体值。</p> <h4 id="reflect-type"><a href="#reflect-type" class="header-anchor">#</a> reflect.Type</h4> <p><code>reflect.Type</code> 表示 <code>interface{}</code> 的具体类型。<code>reflect.TypeOf()</code> 方法返回 <code>reflect.Type</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">reflectType</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token builtin">int64</span> <span class="token operator">=</span> <span class="token number">123</span>
    <span class="token function">reflectType</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">var</span> b <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;Go语言&quot;</span>
    <span class="token function">reflectType</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="reflect-value"><a href="#reflect-value" class="header-anchor">#</a> reflect.Value</h4> <p><code>reflect.Value</code> 表示 <code>interface{}</code> 的具体值。<code>reflect.ValueOf()</code> 方法返回 <code>reflect.Value</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">reflectType</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    typeX <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    valueX <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>typeX<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>valueX<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token builtin">int64</span> <span class="token operator">=</span> <span class="token number">123</span>
    <span class="token function">reflectType</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">var</span> b <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;Go语言&quot;</span>
    <span class="token function">reflectType</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="relfect-kind"><a href="#relfect-kind" class="header-anchor">#</a> relfect.Kind</h4> <p><code>relfect.Kind</code> 表示的是种类。在使用反射时，需要理解类型（Type）和种类（Kind）的区别。编程中，使用最多的是类型，但在反射中，当需要区分一个大品种的类型时，就会用到种类（Kind）。</p> <p>Go 语言程序中的类型（Type）指的是系统原生数据类型，如 <code>int</code> 、 <code>string</code> 、 <code>bool</code> 、 <code>float32</code> 等类型，以及使用 <code>type</code> 关键字定义的类型，这些类型的名称就是其类型本身的名称。例如使用 <code>type A struct{}</code> 定义结构体时，<code>A</code> 就是 <code>struct{}</code> 的类型。</p> <p>种类（Kind）指的是对象归属的品种，在 <code>reflect</code> 包中有如下定义：</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// A Kind represents the specific kind of type that a Type represents.</span>
<span class="token comment">// The zero Kind is not a valid kind.</span>
<span class="token keyword">type</span> Kind <span class="token builtin">uint</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
    Invalid Kind <span class="token operator">=</span> <span class="token boolean">iota</span>
    Bool
    Int
    Int8
    Int16
    Int32
    Int64
    Uint
    Uint8
    Uint16
    Uint32
    Uint64
    Uintptr
    Float32
    Float64
    Complex64
    Complex128
    Array
    Chan
    Func
    Interface
    Map
    Ptr
    Slice
    String
    Struct
    UnsafePointer
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">reflectType</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    typeX <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>typeX<span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// struct</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>typeX<span class="token punctuation">)</span>        <span class="token comment">// main.book</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b book
    <span class="token function">reflectType</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="relfect-numfield"><a href="#relfect-numfield" class="header-anchor">#</a> relfect.NumField()</h4> <p><code>relfect.NumField()</code> 方法返回结构体中字段的数量。</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">reflectNumField</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 检查 x 的类别是 struct</span>
    <span class="token keyword">if</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> reflect<span class="token punctuation">.</span>Struct <span class="token punctuation">{</span>
        v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Number of fields&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    spend  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b book
    <span class="token function">reflectNumField</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="relfect-field"><a href="#relfect-field" class="header-anchor">#</a> relfect.Field()</h4> <p><code>relfect.Field(i int)</code> 方法返回字段 <code>i</code> 的 <code>reflect.Value</code></p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">reflectNumField</span><span class="token punctuation">(</span>x <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 检查 x 的类别是 struct</span>
    <span class="token keyword">if</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> reflect<span class="token punctuation">.</span>Struct <span class="token punctuation">{</span>
        v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Number of fields&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v<span class="token punctuation">.</span><span class="token function">NumField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
            fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Field:%d type:%T value:%v\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">Field</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">type</span> book <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    name <span class="token builtin">string</span>
    spend  <span class="token builtin">int</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> book<span class="token punctuation">{</span><span class="token string">&quot;Go语言&quot;</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">}</span>
    <span class="token function">reflectNumField</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// Number of fields 2</span>
<span class="token comment">// Field:0 type:reflect.Value value:Go语言</span>
<span class="token comment">// Field:1 type:reflect.Value value:8</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="反射的三大定律"><a href="#反射的三大定律" class="header-anchor">#</a> 反射的三大定律</h3> <p>一个接口变量，实际上都是由一 <code>pair</code> 对（type 和 data）组合而成，pair 对中记录着实际变量的值和类型。也就是说在真实世界（反射前环境）里，type 和 value 是合并在一起组成接口变量的。</p> <p>而在反射的世界（反射后的环境）里，type 和 data 却是分开的，他们分别由 <code>reflect.Type</code> 和 <code>reflect.Value</code> 来表现。</p> <p>Go语言反射三定律：</p> <ol><li>Reflection goes from interface value to reflection object.</li> <li>Reflection goes from reflection object to interface value.</li> <li>To modify a reflection object, the value must be settable.</li></ol> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token number">3.14</span>

    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;接口变量的类型为 %T ，值为 %v\n&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> a<span class="token punctuation">)</span>

    t <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">TypeOf</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

    <span class="token comment">// 反射第一定律</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;从接口变量到反射对象：Type对象类型为 %T\n&quot;</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;从接口变量到反射对象：Value对象类型为 %T\n&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">)</span>

    <span class="token comment">// 反射第二定律</span>
    i <span class="token operator">:=</span> v<span class="token punctuation">.</span><span class="token function">Interface</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;从反射对象到接口变量：对象类型为 %T，值为 %v\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span>
    <span class="token comment">// 使用类型断言进行转换</span>
    x <span class="token operator">:=</span> v<span class="token punctuation">.</span><span class="token function">Interface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">float64</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;x 类型为 %T，值为 %v\n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">,</span> x<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">3.14</span>
    v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;是否可写:&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">CanSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">3.14</span>
    v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;是否可写:&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">CanSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">--</span><span class="token operator">-</span>
<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;reflect&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token builtin">float64</span> <span class="token operator">=</span> <span class="token number">3.14</span>
    v <span class="token operator">:=</span> reflect<span class="token punctuation">.</span><span class="token function">ValueOf</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Elem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;是否可写:&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">CanSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    v<span class="token punctuation">.</span><span class="token function">SetFloat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/storyxc/edit/main/docs/04.go/01.Go基础/01.golang基础语法.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/07/08, 17:20:28</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/bd697a/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">GoTemplate</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/bd697a/">GoTemplate</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://github.com/storyxc" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:storyxc@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span><a href="https://storyxc.com" target="_blank" style="font-weight:bold">story</a> | <a href="http://beian.miit.gov.cn/" target=_blank>豫ICP备19046036号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c47fcfce.js" defer></script><script src="/assets/js/2.cc49f402.js" defer></script><script src="/assets/js/71.aee400cd.js" defer></script>
  </body>
</html>
