(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{476:function(s,a,t){"use strict";t.r(a);var e=t(27),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"mysql索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql索引"}},[s._v("#")]),s._v(" MySql索引")]),s._v(" "),t("p",[s._v("本篇内容基于MySQL的InnoDB存储引擎。")]),s._v(" "),t("h2",{attrs:{id:"索引的概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引的概念"}},[s._v("#")]),s._v(" 索引的概念")]),s._v(" "),t("p",[s._v("索引是一个单独的、存储在磁盘上的数据库结构，它们包含着对数据表里所有记录的引用指针。使用索引用于快速找出在某个或多个列中有一特定值的行，所有MySQL列类型都可以被索引，==对相关列使用索引是提高查询操作速度的最佳途径==。")]),s._v(" "),t("p",[s._v("InnoDB存储引擎中的索引都是指BTree索引，MySQL中还有Hash索引,详见官网"),t("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/create-index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("存储引擎索引类型"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("img",{attrs:{src:"https://storyxc.com/images/blog//1271254-20201013142145162-80980408.png",alt:"12712542020101314214516280980408.png"}})]),s._v(" "),t("h2",{attrs:{id:"索引的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引的原理"}},[s._v("#")]),s._v(" 索引的原理")]),s._v(" "),t("blockquote",[t("p",[t("strong",[s._v("内容引用自美团技术团队发表的文章")]),t("a",{attrs:{href:"https://tech.meituan.com/2014/06/30/mysql-index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySQL索引原理及慢查询优化"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("索引的目的在于提高查询效率，可以类比字典，如果要查“mysql”这个单词，我们肯定需要定位到m字母，然后从下往下找到y字母，再找到剩下的sql。如果没有索引，那么你可能需要把所有单词看一遍才能找到你想要的，如果我想找到m开头的单词呢？或者ze开头的单词呢？是不是觉得如果没有索引，这个事情根本无法完成？")]),s._v(" "),t("p",[s._v("数据库的索引结构需要做的事:每次查找数据时把磁盘IO次数控制在一个很小的数量级，最好是常数数量级。那么我们就想到如果一个高度可控的多路搜索树是否能满足需求呢？就这样，b+树应运而生。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://storyxc.com/images/blog//d641ac414176455b97a57b6210b9febb.jpg",alt:"b树.jpg"}}),s._v("\n如上图，是一颗b+树，关于b+树的定义可以参见"),t("a",{attrs:{href:"http://zh.wikipedia.org/wiki/B%2B%E6%A0%91",target:"_blank",rel:"noopener noreferrer"}},[s._v("B+树"),t("OutboundLink")],1),s._v("，这里只说一些重点，浅蓝色的块我们称之为一个磁盘块，可以看到每个磁盘块包含几个数据项（深蓝色所示）和指针（黄色所示），如磁盘块1包含数据项17和35，包含指针P1、P2、P3，P1表示小于17的磁盘块，P2表示在17和35之间的磁盘块，P3表示大于35的磁盘块。真实的数据存在于叶子节点即3、5、9、10、13、15、28、29、36、60、75、79、90、99。非叶子节点只不存储真实的数据，只存储指引搜索方向的数据项，如17、35并不真实存在于数据表中。")]),s._v(" "),t("h4",{attrs:{id:"b-树的查找过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-树的查找过程"}},[s._v("#")]),s._v(" b+树的查找过程")]),s._v(" "),t("p",[s._v("如图所示，如果要查找数据项29，那么首先会把磁盘块1由磁盘加载到内存，此时发生一次IO，在内存中用二分查找确定29在17和35之间，锁定磁盘块1的P2指针，内存时间因为非常短（相比磁盘的IO）可以忽略不计，通过磁盘块1的P2指针的磁盘地址把磁盘块3由磁盘加载到内存，发生第二次IO，29在26和30之间，锁定磁盘块3的P2指针，通过指针加载磁盘块8到内存，发生第三次IO，同时内存中做二分查找找到29，结束查询，总计三次IO。真实的情况是，3层的b+树可以表示上百万的数据，如果上百万的数据查找只需要三次IO，性能提高将是巨大的，如果没有索引，每个数据项都要发生一次IO，那么总共需要百万次的IO，显然成本非常非常高。")]),s._v(" "),t("h4",{attrs:{id:"b-树性质"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#b-树性质"}},[s._v("#")]),s._v(" b+树性质")]),s._v(" "),t("p",[s._v("1.通过上面的分析，我们知道IO次数取决于b+数的高度h，假设当前数据表的数据为N，每个磁盘块的数据项的数量是m，则有h=㏒(m+1)N，当数据量N一定的情况下，m越大，h越小；而m = 磁盘块的大小 / 数据项的大小，磁盘块的大小也就是一个数据页的大小，是固定的，如果数据项占的空间越小，数据项的数量越多，树的高度越低。这就是为什么每个数据项，即索引字段要尽量的小，比如int占4字节，要比bigint8字节少一半。这也是为什么b+树要求把真实的数据放到叶子节点而不是内层节点，一旦放到内层节点，磁盘块的数据项会大幅度下降，导致树增高。当数据项等于1时将会退化成线性表。")]),s._v(" "),t("p",[s._v("2.当b+树的数据项是复合的数据结构，比如(name,age,sex)的时候，b+数是按照从左到右的顺序来建立搜索树的，比如当(张三,20,F)这样的数据来检索的时候，b+树会优先比较name来确定下一步的所搜方向，如果name相同再依次比较age和sex，最后得到检索的数据；但当(20,F)这样的没有name的数据来的时候，b+树就不知道下一步该查哪个节点，因为建立搜索树的时候name就是第一个比较因子，必须要先根据name来搜索才能知道下一步去哪里查询。比如当(张三,F)这样的数据来检索时，b+树可以用name来指定搜索方向，但下一个字段age的缺失，所以只能把名字等于张三的数据都找到，然后再匹配性别是F的数据了， 这个是非常重要的性质，即索引的最左匹配特性。")])]),s._v(" "),t("h2",{attrs:{id:"索引的类别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引的类别"}},[s._v("#")]),s._v(" 索引的类别")]),s._v(" "),t("h3",{attrs:{id:"_1-primary-key-主键索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-primary-key-主键索引"}},[s._v("#")]),s._v(" 1.Primary Key(主键索引)")]),s._v(" "),t("p",[s._v("主键索引是一种特殊的唯一索引，这个时候需要一个表只能有一个主键，不允许有空值。一般是在建表的时候同时创建主键索引")]),s._v(" "),t("blockquote",[t("p",[s._v("InnoDB存储引擎的表，如果建表的时候没有指定主键，则会使用第一非空的唯一索引作为聚集索引，如果没有主键也没有合适的唯一索引，那么innodb内部会生成一个隐藏的主键作为聚集索引，这个隐藏的主键是一个6个字节的列，该列的值会随着数据的插入自增。")]),s._v(" "),t("p",[s._v("在其他存储引擎或其他数据库中主键索引不一定就是聚集索引")])]),s._v(" "),t("h3",{attrs:{id:"_2-unique-唯一索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-unique-唯一索引"}},[s._v("#")]),s._v(" 2.Unique（唯一索引）")]),s._v(" "),t("p",[s._v("唯一索引列的值必须是唯一的，但允许有空值,如果是组合索引，则列值的组合必须是唯一的。")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" 索引名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("列名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3-key-普通索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-key-普通索引"}},[s._v("#")]),s._v(" 3.Key（普通索引）")]),s._v(" "),t("p",[s._v("MySQL中的基本索引类型，允许在定义索引的列中插入重复值和空值")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" 索引名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("列名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_4-组合索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-组合索引"}},[s._v("#")]),s._v(" 4.组合索引")]),s._v(" "),t("p",[s._v("指多个字段上创建的索引，只有在查询条件中使用了创建索引时的第一个字段，索引才会被使用。使用组合索引时遵循最左前缀原则")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" 索引名 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("列名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("列名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_5-全文索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-全文索引"}},[s._v("#")]),s._v(" 5.全文索引")]),s._v(" "),t("p",[s._v("全文索引类型为FULLTEXT，在定义索引的列上支持值的全文查找，允许在这些索引列中插入重复值和空值。全文索引可以在CHAR、VARCHAR或者TEXT类型的列上创建")]),s._v(" "),t("h2",{attrs:{id:"索引的基本语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引的基本语法"}},[s._v("#")]),s._v(" 索引的基本语法")]),s._v(" "),t("ul",[t("li",[s._v("创建")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" mytable "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("indexName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("列名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("删除")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("indexName"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" 表名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("查看")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表名\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ul",[t("li",[s._v("alter命令")])]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 有四种方式来添加数据表的索引：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" tbl_name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 该语句添加一个主键，这意味着索引值必须是唯一的，且不能为"),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("。\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" tbl_name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UNIQUE")]),s._v(" index_name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 这条语句创建索引的值必须是唯一的（除了"),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("外，"),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("可能会出现多次）。\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" tbl_name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" index_name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": 添加普通索引，索引值可出现多次。\n \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ALTER")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" tbl_name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" FULLTEXT index_name "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_list"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":该语句指定了索引为 FULLTEXT ，用于全文索引。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"索引的使用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引的使用场景"}},[s._v("#")]),s._v(" 索引的使用场景")]),s._v(" "),t("h3",{attrs:{id:"_1-适合使用索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-适合使用索引"}},[s._v("#")]),s._v(" 1.适合使用索引")]),s._v(" "),t("ul",[t("li",[s._v("频繁作为查询条件的字段")]),s._v(" "),t("li",[s._v("多表查询中与其他表进行关联的字段,外键关系建立索引")]),s._v(" "),t("li",[s._v("单列/组合索引的选择,在高并发的场景下适合建立组合索引")]),s._v(" "),t("li",[s._v("查询中常用于排序的字段")]),s._v(" "),t("li",[s._v("查询中常用于分组或统计的字段")])]),s._v(" "),t("h3",{attrs:{id:"_2-不适合使用索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-不适合使用索引"}},[s._v("#")]),s._v(" 2.不适合使用索引")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("频繁更新的字段")])]),s._v(" "),t("li",[t("p",[s._v("where条件中用不到的字段")])]),s._v(" "),t("li",[t("p",[s._v("表记录很少")])]),s._v(" "),t("li",[t("p",[s._v("重复记录非常多的表")])]),s._v(" "),t("li",[t("p",[s._v("数据区分不明显的字段,例如性别栏位")])])]),s._v(" "),t("h2",{attrs:{id:"索引有效场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引有效场景"}},[s._v("#")]),s._v(" 索引有效场景")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("全值匹配的查询,例如根据订单id查询select * from t_order where order_id = '9999676623'")])]),s._v(" "),t("li",[t("p",[s._v("匹配范围值的查询,例如 where id > '123456'")])]),s._v(" "),t("li",[t("p",[s._v("最左匹配原则,如user表的username pwd创建了组合索引那么以下几种都可以命中索引")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" username"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zhangsan'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" pwd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'axsedf1sd'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" pwd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'axsedf1sd'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" username"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zhangsan'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" username"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zhangsan'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("而")]),s._v(" "),t("div",{staticClass:"language-sql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" username "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" pwd "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'axsedf1sd'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("不能命中索引")])]),s._v(" "),t("li",[t("p",[s._v("非前导模糊查询, 例如 where name like 'xiaoming%'")])])]),s._v(" "),t("h3",{attrs:{id:"索引失效场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引失效场景"}},[s._v("#")]),s._v(" 索引失效场景")]),s._v(" "),t("ul",[t("li",[s._v("负向查询会使索引失效,例如 id not in (1,2,3)")]),s._v(" "),t("li",[s._v("在索引字段进行运算会使索引失效,例如计算,函数,类型转换")]),s._v(" "),t("li",[s._v("!=或者<>会使索引失效")]),s._v(" "),t("li",[s._v("is not null无法使用索引,但是is null可以")]),s._v(" "),t("li",[s._v("前导模糊查询会使索引失效,例如 name like '%xiaoming',但是非前导可以")]),s._v(" "),t("li",[s._v("字符串不加单引号会使索引失效")]),s._v(" "),t("li",[s._v("使用组合索引时不遵循最左匹配原则会使索引失效")])])])}),[],!1,null,null,null);a.default=r.exports}}]);