(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{481:function(e,t,n){"use strict";n.r(t);var o=n(27),i=Object(o.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"linux服务器安装openoffice踩坑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux服务器安装openoffice踩坑"}},[e._v("#")]),e._v(" linux服务器安装OpenOffice踩坑")]),e._v(" "),n("h2",{attrs:{id:"背景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[e._v("#")]),e._v(" 背景")]),e._v(" "),n("p",[e._v("最近公司项目需要做一个在线预览Office文件的功能,尝试了使用OpenOffice把Office文档转化成PDF格式和HTML格式的文件再由前端解析PDF或者直接通过iFrame访问HTML文件的方案,windows系统直接下载安装后cmd运行命令就可以启动openoffice的服务了.服务器就稍微麻烦一点,本文记录了我在自己的阿里云服务器上安装OpenOffice遇到的坑和解决的办法.\n解压安装OpenOffice,这个网上搜一下有很多,不再详细记录.可以参考 "),n("a",{attrs:{href:"https://www.cnblogs.com/Oliver-rebirth/p/Linux_openOffice.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("linux环境下安装 openOffice 并启动服务"),n("OutboundLink")],1)]),e._v(" "),n("h2",{attrs:{id:"遇到的问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[e._v("#")]),e._v(" 遇到的问题")]),e._v(" "),n("ul",[n("li",[e._v("找不到Java运行环境\n这个问题是因为我服务器上的JDK是解压版本的,虽然配置了JAVA_HOME这些但是openoffice识别不到,后来我就删了这个解压版的JDK,然后用yum命令安装了OpenJDK 1.8,命令:"),n("code",[e._v("yum install openjdk 1.8")]),e._v("重新配置了JAVA_HOME后解决了这个报错")]),e._v(" "),n("li",[e._v("找不到libXext.so.6\n/opt/openoffice4/program/下缺少libXext.so.6文件  运行"),n("code",[e._v("yum install libXext.X86_64")]),e._v(". 这个是64位linux的版本,32位的系统需要改成对应的版本")]),e._v(" "),n("li",[e._v("no suitable windowing system found existing\n运行"),n("code",[e._v('yum groupinstall "X Window System"')]),e._v(",我在运行这个命令的时候,又碰到了另一个报错:"),n("strong",[e._v("no packages in any requested group available to install or update")]),e._v(", 这里命令后面要加上一些参数,执行"),n("code",[e._v('yum groupinstall "X Window System" --setoptgroup_package_type=mandatory.default.optional')])])]),e._v(" "),n("p",[e._v("解决报错后,再重新执行启动服务的命令 "),n("code",[e._v('nohup ./soffice -headless -accept="socket,host=127.0.0.1,port=8100;urp;" -nofirststartwizard &')])]),e._v(" "),n("p",[e._v("执行后可以使用netstat命令查看8100端口的占用情况"),n("code",[e._v("net stat -lnp|grep 8100")]),e._v(" 可以看到soffice.bin就说明服务成功启动了")]),e._v(" "),n("p",[e._v("然后启动测试的demo后发现,office文件转换成PDF后中文出现乱码,这是因为服务器上没有中文字体,用ftp工具把windows的中文字体直接传到服务器上的/usr/share/fonts文件夹中,清除缓存后重新启动openoffice服务后就能正确显示中文了.")])])}),[],!1,null,null,null);t.default=i.exports}}]);